CDECK  ID>, GAS37.
      SUBROUTINE GAS37(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(67),YXSEC(67),XATT(3),YATT(3),XION(27),YION(27),
     /XEXC1(27),YEXC1(27),XEXC2(25),YEXC2(25),XEXC3(22),YEXC3(22),
     /XEXC4(20),YEXC4(20),XEXC5(18),YEXC5(18)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.00005,.0001,.00015,.0002,.0003,.0004,.0005,.0006,
     /.0007,
     /.0008,.0009,.001,.00125,.0015,.0017,.00185,.002,.0025,.003,
     /.004,.005,.0056,.006,.007,.008,.009,0.01,.0125,.013,
     /.015,0.02,.025,0.03,0.04,0.05,0.06,0.07,0.08,0.09,
     /0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.20,1.40,1.50,1.60,1.80,2.00,2.20,2.40,2.60,2.80,
     /4.00,10.0,1000.,2000.,10000.,20000.,100000./
      DATA YXSEC/1190.,1188.,1005.,916.,851.,760.,708.,667.,639.,624.,
     /609.,639.,696.,1149.,4745.,10930.,10930.,7038.,2782.,2130.,
     /2354.,4620.,6849.,6300.,4016.,2848.,2520.,2876.,4365.,4745.,
     /4515.,2876.,1775.,1430.,1039.,851.,790.,710.,670.,630.,
     /600.,415.,340.,290.,260.,230.,210.,195.,180.,170.,
     /135.,100.,80.0,65.0,58.5,52.5,47.6,44.4,43.1,41.2,
     /36.0,26.0,0.14,0.07,.012,.006,.0012/
      DATA XION/3.8926,5.00,6.00,7.00,8.00,10.0,12.0,14.0,15.0,17.0,
     /20.0,25.0,30.0,40.0,50.0,60.0,80.0,100.,200.,300.,
     /400.,500.,600.,700.,1000.,10000.,100000./
      DATA YION/0.00,2.70,4.80,6.00,7.20,8.00,8.20,9.80,10.0,9.30,
     /8.40,9.90,10.2,9.92,9.82,9.58,9.08,8.79,7.40,6.25,
     /5.44,5.02,4.88,4.80,4.50,0.45,.045/
      DATA XATT/10.0,100.0,100000./
      DATA YATT/0.00,0.0000001,0.0000000001/
C  P1/2
      DATA XEXC1/1.3859,1.40,1.45,1.50,1.60,1.70,1.90,2.00,2.20,2.50,
     /3.00,3.50,4.00,5.00,6.00,7.00,8.00,10.0,15.0,20.0,
     /40.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC1/0.00,1.47,15.4,23.7,17.8,17.1,14.2,12.7,12.0,11.2,
     /12.2,12.7,13.0,13.8,14.3,15.1,15.1,14.7,13.8,13.3,
     /8.32,6.24,4.94,4.16,0.42,.042,.0042/
C  P3/2
      DATA XEXC2/1.4546,1.50,1.60,1.70,1.90,2.00,2.20,2.50,3.00,3.50,
     /4.00,5.00,6.00,7.00,8.00,10.0,15.0,20.0,40.0,60.0,
     /80.0,100.,1000.,10000.,100000./
      DATA YEXC2/0.00,23.7,34.6,32.3,26.9,24.2,21.5,19.5,20.5,21.5,
     /22.0,23.3,24.2,25.5,25.5,24.9,23.3,22.4,14.1,10.6,
     /8.36,7.04,0.70,0.07,.007/
C  D3/2 + D5/2
      DATA XEXC3/1.7977,1.90,2.00,2.20,2.50,3.00,3.50,4.00,5.00,6.00,
     /7.00,8.00,10.0,15.0,20.0,40.0,60.0,80.0,100.,1000.,
     /10000.,100000./
      DATA YEXC3/0.00,7.50,14.7,19.8,20.3,21.8,23.2,23.5,24.9,25.8,
     /27.3,27.3,26.6,24.9,24.0,15.0,11.3,8.93,7.52,0.75,
     /.075,.0075/
C  S1/2
      DATA XEXC4/2.2981,2.40,2.50,3.00,3.50,4.00,5.00,6.00,7.00,8.00,
     /10.0,15.0,20.0,40.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC4/0.00,3.40,4.90,6.40,7.30,7.50,7.95,8.25,8.70,8.70,
     /8.47,7.95,7.65,4.80,3.60,2.85,2.40,0.24,.024,.0024/
C  SUM OF HIGHER LEVELS
      DATA XEXC5/2.6986,3.00,3.50,4.00,5.00,6.00,7.00,8.00,10.0,15.0,
     /20.0,40.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC5/0.00,1.90,3.30,4.40,4.66,4.84,5.10,5.10,4.97,4.66,
     /4.49,2.82,2.11,1.67,1.41,.141,.0141,.00141/
      NAME='Cs (2001)'
C ---------------------------------------------------------------------
C ---------------------------------------------------------------------
      NIN=5
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=67
      NION=27
      NATT=3
      NEXC1=27
      NEXC2=25
      NEXC3=22
      NEXC4=20
      NEXC5=18
      E(1)=0.0
      E(2)=2.0*EMASS/(132.90545*AMU)
      E(3)=3.8926
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=3.8926
      EIN(1)=1.3859
      EIN(2)=1.4546
      EIN(3)=1.7977
      EIN(4)=2.2981
      EIN(5)=2.6986
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       CESIUM         '
      SCRPT(3)=' IONISATION    ELOSS=  3.8926 '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC P1/2      ELOSS=  1.3859 '
      SCRPT(8)=' EXC P3/2      ELOSS=  1.4546 '
      SCRPT(9)=' EXC D3/2+5/2  ELOSS=  1.7977 '
      SCRPT(10)=' EXC S1/2      ELOSS=  2.2981 '
      SCRPT(11)=' EXC HIGHER    ELOSS=  2.6986 '
      EN=-ESTEP/2.0D0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.D-16
      Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0D0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GE.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C
      QIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 400
      DO 310 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 320
  310 CONTINUE
      J=NEXC1
  320 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(1,I)=(A*EN+B)*1.D-16
  400 CONTINUE
C
      QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 500
      DO 410 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 420
  410 CONTINUE
      J=NEXC2
  420 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(2,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 600
      DO 510 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 520
  510 CONTINUE
      J=NEXC3
  520 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 700
      DO 610 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 620
  610 CONTINUE
      J=NEXC4
  620 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(5,I)=0.0D0
      IF(EN.LE.EIN(5)) GO TO 800
      DO 710 J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GO TO 720
  710 CONTINUE
      J=NEXC5
  720 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      END
