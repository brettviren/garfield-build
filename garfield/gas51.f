CDECK  ID>, GAS51.
      SUBROUTINE GAS51(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEL(30),YEL(30),XVIBH(16),YVIBH(16),
     /XEXC(31),YEXC(31),XION(40),YION(40)
      CHARACTER*15 NAME
      CHARACTER*30 SCRPT(226)
      DATA XEL/1.D-6,.001,0.01,0.10,0.40,0.60,0.80,1.00,1.40,2.00,
     /3.00,5.00,7.50,10.0,14.0,20.0,30.0,50.0,75.0,100.,
     /150.,200.,400.,700.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YEL/2800.,2800.,280.,28.0,7.00,5.50,5.00,5.00,6.00,7.00,
     /9.00,11.5,15.5,18.0,18.0,17.0,14.0,10.0,8.00,6.00,
     /4.00,3.00,1.45,0.90,0.65,0.30,0.15,0.05,0.02,.004/
C  VIBRATION HARMONIC 2(V3)
      DATA XVIBH/0.30,1.00,3.00,3.70,4.70,5.70,6.70,7.70,9.50,15.0,
     /20.0,50.0,100.0,1000.,10000.,100000./
      DATA YVIBH/0.00,.005,.025,0.10,0.25,1.15,1.75,1.50,1.00,.080,
     /.030,.0015,.00005,.000005,.0000005,.00000005/
      DATA XION/11.40,12.0,13.0,14.0,16.0,18.0,20.0,22.0,24.0,26.0,
     /30.0,34.0,38.0,42.0,46.0,50.0,60.0,70.0,80.0,90.0,
     /100.,125.,150.,175.,200.,250.,300.,400.,500.,600.,
     /800.,1000.,1500.,2000.,2500.,3000.,5000.,10000.,20000.,100000./
      DATA YION/0.00,0.04,0.13,0.25,0.40,0.66,1.00,1.30,1.70,2.05,
     /2.45,2.85,3.30,3.80,4.30,4.60,5.35,5.90,6.40,6.60,
     /6.80,7.00,7.05,7.00,6.90,6.45,6.20,5.50,4.75,4.20,
     /3.55,3.05,2.25,1.85,1.60,1.35,0.95,0.60,0.35,0.10/
C  DISOCIATION X-SECTION EXCLUDING DISOCIATIVE IONISATION X-SECTION
      DATA XEXC/8.70,9.00,10.0,11.0,12.0,14.0,16.0,21.0,26.0,31.0,
     /36.0,40.0,50.0,70.0,100.,120.,140.,160.,180.,200.,
     /250.,300.,400.,500.,600.,1000.,2000.,4000.,10000.,20000.,
     /100000./
      DATA YEXC/0.0,0.07,0.32,0.56,0.85,1.35,1.65,2.15,2.30,2.35,
     /2.40,2.45,2.45,2.43,2.41,2.39,2.35,2.30,2.25,2.20,
     /2.05,1.90,1.65,1.40,1.20,0.80,0.46,0.27,0.14,0.07,
     /.020/
C ----------------------------------------------------------------
C SCALED X-SECTIONS FROM SYSTEMATICS AND USED ATTACHMENT X-SECTION
C  FROM ALAJAJIAN ET AL : J.PHYS B21(1988) 4021
C  AND NORMALISED TO MCCORKLE (1987) AND SPYROU ET AL
C ---------------------------------------------------------------
C
      NAME='CF3Br (2002)'
C
      NIN=7
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NEL=30
      NVIBH=16
      NION=40
      NEXC=31
      E(1)=0.0
      E(2)=2.0*EMASS/(148.90991*AMU)
      E(3)=11.40
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
C SET OPAL AND BEATY ENERGY SPLITTING TO EION
      EOBY=E(3)
      EIN(1)=-0.050
      EIN(2)=0.050
      EIN(3)=-0.1345
      EIN(4)=0.1345
      EIN(5)=0.1499
      EIN(6)=0.30
      EIN(7)=8.7
      APOPV1=EXP(EIN(1)/AKT)
      APOPV2=EXP(EIN(3)/AKT)
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC         CF3BR        '
      SCRPT(3)=' IONISATION    ELOSS= 11.40   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB1          ELOSS= -0.050  '
      SCRPT(8)=' VIB1          ELOSS=  0.050  '
      SCRPT(9)=' VIB2          ELOSS= -0.1345 '
      SCRPT(10)=' VIB2          ELOSS=  0.1345 '
      SCRPT(11)=' VIB3          ELOSS=  0.1499 '
      SCRPT(12)=' VIB HAR       ELOSS=  0.30   '
      SCRPT(13)=' EXC           ELOSS=  8.7    '
      EN=-ESTEP/2.0D0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) Q(2,I)=2800.D-16
      IF(EN.EQ.0.0) GO TO 30
      DO 10 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 20
   10 CONTINUE
      J=NEL
C USE LOG INTERPOLATION
   20 Y1=LOG(YEL(J-1))
      Y2=LOG(YEL(J))
      X1=LOG(XEL(J-1))
      X2=LOG(XEL(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      Q(2,I)=EXP((A*LOG(EN)+B))*1.0D-16
C
   30 Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 100
      DO 40 J=2,NION
      IF(EN.LE.XION(J)) GO TO 50
   40 CONTINUE
      J=NION
   50 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  100 Q(4,I)=0.0D0
      IF(EN.EQ.0.0.OR.EN.GT.2.0) GO TO 200
C FUNCTIONAL FORM OF ATTACHMENT FROM J.PHYS.B 21(1988) 4021
      AT1=0.0353/SQRT(EN)
      AT2=EXP(-EN*EN/9.D-6)
      AT3=EXP(-EN/0.0588)
      Q(4,I)=(AT1*AT2+AT3)*27.4D-16
  200 Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C
C SUPERELASTIC VIBRATION V1
C
      QIN(1,I)=0.0D0
      IF(EN.EQ.0.0) GO TO 250
      EFAC=SQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.100*LOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOPV1/(1.0+APOPV1)*1.D-16
C
C  VIBRATION V1
C
  250 CONTINUE
      QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 300
      EFAC=SQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.100*LOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)*1.0/(1.0+APOPV1)*1.D-16
  300 CONTINUE
C
C SUPERELASTIC OF VIBRATION V2
C
      QIN(3,I)=0.0D0
      IF(EN.EQ.0.0) GO TO 350
      EFAC=SQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.110*LOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(3,I)=QIN(3,I)*APOPV2/(1.0+APOPV2)*1.D-16
C
C VIBRATION V2
  350 CONTINUE
      QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 400
      EFAC=SQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.110*LOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=QIN(4,I)*1.0/(1.0+APOPV2)*1.D-16
  400 CONTINUE
C
C VIBRATION V3
      QIN(5,I)=0.0D0
      IF(EN.LE.EIN(5)) GO TO 500
      EFAC=SQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.750*LOG((1.0+EFAC)/(1.0-EFAC))/EN*1.D-16
  500 CONTINUE
C
C  VIBRATION HARMONIC 2V3
      QIN(6,I)=0.0D0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 520
  510 CONTINUE
      J=NVIBH
  520 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(7,I)=0.0D0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 620
  610 CONTINUE
      J=NEXC
  620 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      END
