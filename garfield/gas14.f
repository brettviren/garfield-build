CDECK  ID>, GAS14.
      SUBROUTINE GAS14(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION ELEV(100),AJL(100),PJ(100)
      DIMENSION SALPHA(105),EROT(105),AJIN(210),IMAP(210)
      DIMENSION XEL(24),YEL(24),XVIB1(26),YVIB1(26),XVIB2(27),YVIB2(27),
     /XION(46),YION(46),XATT(20),YATT(20),XEXC(9),YEXC(9),XEXC1(17),
     /YEXC1(17),XEXC2(15),YEXC2(15)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ENERGY LEVELS OF WATER ( UP TO J=9) IN MILLIVOLTS
      DATA ELEV/0.0,2.950,4.604,5.253,8.690,9.856,11.800,16.726,16.882,
     /16.956,17.640,21.946,25.578,26.304,35.363,35.387,27.531,27.876,
     /34.157,37.240,39.152,47.426,47.590,60.518,60.521,40.338,40.496,
     /49.526,51.603,55.360,62.484,63.085,75.645,75.673,92.005,92.006,
     /55.383,55.452,67.312,68.552,74.734,80.463,82.022,93.822,93.953,
     /110.172,110.176,129.571,129.571,72.685,72.714,87.311,87.98,97.006,
     /101.26,104.44,115.03,115.46,131.38,131.40,150.79,150.79,172.94,
     /172.94,92.252,92.264,109.46,109.80,121.87,124.74,130.20,139.20,
     /140.32,155.62,155.71,175.02,175.02,197.22,197.22,221.81,221.81,
     /114.09,114.09,133.79,133.95,149.02,150.79,159.06,166.25,168.65,
     /182.87,183.16,202.25,202.27,224.48,224.48,249.18,249.18,275.92,
     /275.92/
C  J VALUE OF WATER LEVELS
      DATA AJL/0.0,1.0,1.0,1.0,2.0,2.0,2.0,2.0,2.0,
     /3.0,3.0,3.0,3.0,3.0,3.0,3.0,4.0,4.0,
     /4.0,4.0,4.0,4.0,4.0,4.0,4.0,5.0,5.0,
     /5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,
     /6.0,6.0,6.0,6.0,6.0,6.0,6.0,6.0,6.0,
     /6.0,6.0,6.0,6.0,7.0,7.0,7.0,7.0,7.0,
     /7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,
     /7.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,
     /8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,
     /9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,
     /9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,
     /9.0/
C  TRANSITION AMPLITUDES FOR 210 TRANSITIONS
      DATA SALPHA/1.50,1.259,1.092,1.088,1.101,2.074,2.543,2.166,2.066,
     /2.181,
     /3.655,3.446,2.037,4.224,1.899,4.218,5.660,1.841,4.140,1.850,
     /.8333,1.036,1.083,1.297,1.850,2.025,2.085,1.566,2.494,2.881,
     /1.709,2.965,1.778,1.860,1.000,1.500,2.157,3.007,3.977,4.984,
     /5.970,6.980,7.990,1.500,1.667,1.971,2.445,3.131,3.970,4.940,
     /2.395,2.319,2.322,2.449,2.800,3.290,3.393,3.270,3.153,3.090,
     /3.100,4.397,4.267,4.120,4.000,5.400,5.250,5.120,1.244,2.336,
     /3.390,4.397,5.400,6.400,.9225,2.165,3.251,4.265,5.250,.6050,
     /1.840,3.068,4.090,.3804,1.402,2.750,.2494,1.090,0.197,.7557,
     /1.744,2.837,3.918,4.965,5.960,6.980,7.990,.3003,.8347,1.641,
     /2.681,3.710,4.820,5.900,1.550/
C TRANSITION J(INITIAL) VALUES FOR 210 TRANSITIONS
      DATA AJIN/1.0,1.0,2.0,2.0,3.0,3.0,4.0,4.0,5.0,5.0,
     /2.0,2.0,3.0,3.0,4.0,4.0,5.0,5.0,3.0,3.0,
     /4.0,4.0,5.0,5.0,4.0,4.0,5.0,5.0,5.0,5.0,
     /6.0,6.0,7.0,7.0,6.0,6.0,7.0,7.0,7.0,7.0,
     /2.0,2.0,3.0,3.0,4.0,4.0,3.0,3.0,4.0,4.0,
     /5.0,5.0,6.0,6.0,4.0,4.0,5.0,5.0,6.0,6.0,
     /5.0,5.0,6.0,6.0,6.0,6.0,6.0,6.0,0.0,1.0,
     /1.0,2.0,2.0,3.0,3.0,4.0,4.0,5.0,5.0,6.0,
     /6.0,7.0,7.0,8.0,8.0,9.0,1.0,2.0,2.0,3.0,
     /3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,7.0,8.0,
     /2.0,3.0,3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,
     /7.0,8.0,3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,
     /7.0,8.0,4.0,5.0,5.0,6.0,6.0,7.0,7.0,8.0,
     /5.0,6.0,6.0,7.0,7.0,8.0,1.0,2.0,2.0,3.0,
     /3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,2.0,3.0,
     /3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,3.0,4.0,
     /4.0,5.0,5.0,6.0,6.0,7.0,4.0,5.0,5.0,6.0,
     /6.0,7.0,5.0,6.0,6.0,7.0,6.0,7.0,1.0,2.0,
     /2.0,3.0,3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,
     /7.0,8.0,8.0,9.0,2.0,3.0,3.0,4.0,4.0,5.0,
     /5.0,6.0,6.0,7.0,7.0,8.0,8.0,9.0,6.0,7.0/
C TRANSITION ENERGIES FOR 210 TRANSITIONS IN MILIVOLTS
      DATA EROT/2.303,5.082,9.083,12.93,16.33,3.110,4.809,8.439,12.59,
     /4.538,
     /4.994,7.724,6.626,5.834,9.188,7.423,7.433,11.93,9.695,14.63,
     /6.869,9.785,13.09,7.938,10.19,13.16,16.35,9.364,10.88,13.36,
     /11.11,11.91,13.10,17.54,4.604,6.906,8.950,10.92,12.97,15.11,
     /17.33,19.58,21.84,11.47,13.78,15.75,17.45,19.03,20.67,22.49,
     /18.48,21.12,23.33,25.10,26.52,27.74,25.13,28.05,30.74,33.00,
     /34.76,31.48,34.50,37.43,40.16,37.56,40.61,43.62,12.28,18.66,
     /25.16,31.49,37.57,43.36,16.45,22.01,28.25,34.53,40.62,21.51,
     /25.84,31.47,37.58,27.48,30.42,35.00,34.24,35.89,41.55,4.086,
     /7.100,9.891,12.46,14.89,17.23,19.54,21.82,4.769,8.579,12.29,
     /15.71,18.76,21.48,23.99,16.54/
C MAP OF TRANSITION NO TO LEVEL POPULATION
      DATA IMAP/2,4,7,9,14,16,23,25,34,36,5,7,12,14,21,23,32,34,10,12,
     /19,21,30,32,17,19,28,30,26,28,39,41,54,56,37,39,52,54,50,52,
     /6,8,13,15,22,24,11,13,20,22,31,33,44,46,18,20,29,31,42,44,
     /27,29,40,42,38,40,66,68,1,3,2,6,5,11,10,18,17,27,26,38,
     /37,51,50,66,65,83,4,8,7,13,12,20,19,29,28,40,39,53,52,68,
     /9,15,14,22,21,31,30,42,41,55,54,70,16,24,23,33,32,44,43,57,
     /56,72,25,35,34,46,45,59,58,74,36,48,47,61,60,76,3,9,8,16,
     /15,25,24,36,35,49,48,64,6,14,13,23,22,34,33,47,46,62,11,21,
     /20,32,31,45,44,60,18,30,29,43,42,58,27,41,40,56,38,54,3,5,
     /6,10,11,17,18,26,27,37,38,50,51,65,66,82,8,12,13,19,20,28,
     /29,39,40,52,53,67,68,84,42,54/
C ELASTIC MOMENTUM TRANSFER ( NO ROTATION )
      DATA XEL/.0001,.001,0.01,0.02,0.10,0.20,0.40,1.00,2.00,4.00,
     /6.00,8.00,10.0,12.0,16.0,20.0,30.0,60.0,100.,200.,
     /500.0,1000.0,10000.,100000./
      DATA YEL/384000.,37900.,3590.,1747.,179.,56.5,13.1,1.72,.707,1.21,
     /2.22,3.23,4.34,4.34,4.24,3.74,3.03,1.89,1.23,.575,
     /.200,.065,.006,.0006/
C VIBRATION
      DATA XVIB1/.198,.214,.216,.218,.219,0.23,0.25,0.28,0.32,0.35,
     /0.40,0.50,0.60,0.80,1.00,1.60,2.50,4.00,7.00,10.0,
     /15.0,20.0,100.0,1000.0,10000.,100000./
      DATA YVIB1/0.00,.001,0.01,0.10,1.00,1.39,1.62,1.74,1.82,1.78,
     /1.58,1.20,0.74,0.47,0.35,0.24,0.17,0.15,0.18,0.17,
     /0.15,0.12,0.03,0.003,.0003,.00003/
      DATA XVIB2/.453,.463,.470,.473,0.48,0.49,0.55,0.64,0.70,0.75,
     /0.80,0.90,1.00,1.40,2.00,2.50,4.00,6.00,8.00,10.0,
     /15.0,20.0,40.0,100.0,1000.0,10000.,100000./
      DATA YVIB2/0.00,0.01,0.10,1.00,3.14,3.51,3.72,3.26,2.81,2.17,
     /1.00,0.68,0.53,0.36,0.31,0.31,0.36,0.47,0.50,0.39,
     /0.19,0.12,0.10,0.03,0.003,.0003,.00003/
      DATA XION/12.61,13.5,14.0,15.0,16.0,17.0,18.0,20.0,22.5,25.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /110.,125.,150.,175.,200.,250.,300.,400.,500.,600.,
     /700.,800.,900.,1000.,1200.,1500.,2000.,3000.,4000.,7000.,
     /10000.,14000.,20000.,40000.,60000.,100000./
      DATA YION/0.00,.036,.066,.120,.178,.256,.333,.465,.648,.825,
     /1.11,1.35,1.55,1.72,1.84,2.02,2.12,2.21,2.24,2.26,
     /2.26,2.23,2.15,2.08,2.01,1.82,1.65,1.42,1.21,1.06,
     /.933,.848,.777,.708,.620,.523,.417,.300,.236,.147,
     /.108,.080,.059,.032,.022,.0135/
      DATA XATT/4.50,5.50,5.75,6.00,6.25,6.40,6.60,7.00,7.50,8.00,
     /8.50,9.00,9.50,10.0,11.0,13.0,14.0,1000.,10000.,100000./
      DATA YATT/0.00,.0008,.003,.019,.060,.064,.060,.035,.011,.010,
     /.011,.0085,.006,.003,.0058,.001,.0001,.00001,.000001,.0000001/
      DATA XEXC/4.20,4.50,5.00,6.00,10.0,100.,1000.0,10000.,100000./
      DATA YEXC/0.00,.032,.064,.080,.064,0.004,0.0004,.00004,.000004/
      DATA XEXC1/7.40,7.60,8.25,9.10,10.0,12.0,15.0,20.0,30.0,40.0,
     /50.0,80.0,100.0,200.0,1000.,10000.,100000./
      DATA YEXC1/0.00,.027,.158,.264,.394,.607,0.87,1.11,1.24,1.16,
     /1.09,0.87,0.80,0.51,0.16,.0158,.00158/
      DATA XEXC2/13.1,14.1,15.0,17.0,19.0,21.0,25.0,35.0,50.0,70.0,
     /100.0,200.0,1000.0,10000.,100000./
      DATA YEXC2/0.00,.016,.067,0.17,0.22,0.29,0.36,0.50,0.66,0.69,
     /0.66,0.49,0.16,.016,.0016/
      NAME='H2O (2004)'
C --------------------------------------------------------------------
C  EXPERIMENTAL DATA NOT ACCURATE IN WATER VAPOUR. ELECTRON SCATTERING
C  DATA USED IN ANALYSIS REPRODUCES DRIFT VELOCITY AND DIFFUSION
C  COEFFICIENTS TO AN  ACCURACY OF  2%.
C ---------------------------------------------------------------------
      NIN=215
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
      KIN(J)=0
    2 IF(J.LE.210) KIN(J)=1
      NEL=24
      NVIB1=26
      NVIB2=27
      NION=46
      NATT=20
      NEXC=9
      NEXC1=17
      NEXC2=15
      E(1)=0.0
      E(2)=2.0*EMASS/(18.01528*AMU)
      E(3)=12.61
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=12.61
C-----------------------------------------------------------------
C DBA IS DIPOLE MOMENT
C DRAT IS RATIO OF MOMENTUM TRANSFER TO TOTAL X-SECTION FOR DIPOLE
C -----------------------------------------------------------------
      GPARA=1.0
      GORTHO=3.0
      DBA=0.728
      DRAT=0.07
      A0=0.5291772083D-8
      RY=13.60569172
      DBK=8.37758*RY*(DBA*A0)**2
C------------------------------------------------------------------
C CALCULATE POPULATION DENSITIES OF ROTATIONAL LEVELS
      DO 3 J=1,99,2
    3 PJ(J)=GPARA*(2.0*AJL(J)+1.0)*EXP(-ELEV(J)*1.D-3/AKT)
      DO 4 J=2,100,2
    4 PJ(J)=GORTHO*(2.0*AJL(J)+1.0)*EXP(-ELEV(J)*1.D-3/AKT)
      SUM=0.0
      DO 5 J=1,100
    5 SUM=SUM+PJ(J)
      DO 6 J=1,100
    6 PJ(J)=PJ(J)/SUM
      DO 7 J=1,105
      EIN(2*J-1)=EROT(J)*1.D-3
    7 EIN(2*J)=-EROT(J)*1.D-3
C
      EIN(211)=0.198
      EIN(212)=0.453
      EIN(213)=4.20
      EIN(214)=7.40
      EIN(215)=13.1
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       WATER          '
      SCRPT(3)=' IONISATION    ELOSS= 12.61   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 101--110  ELOSS= 0.002303'
      SCRPT(8)=' ROT 110--101  ELOSS=-0.002303'
      SCRPT(9)=' ROT 211--220  ELOSS= 0.005082'
      SCRPT(10)=' ROT 220--211  ELOSS=-0.005082'
      SCRPT(11)=' ROT 321--330  ELOSS= 0.009083'
      SCRPT(12)=' ROT 330--321  ELOSS=-0.009083'
      SCRPT(13)=' ROT 431--440  ELOSS= 0.01293 '
      SCRPT(14)=' ROT 440--431  ELOSS=-0.01293 '
      SCRPT(15)=' ROT 541--550  ELOSS= 0.01633 '
      SCRPT(16)=' ROT 550--541  ELOSS=-0.01633 '
      SCRPT(17)=' ROT 202--211  ELOSS= 0.00311 '
      SCRPT(18)=' ROT 211--202  ELOSS=-0.00311 '
      SCRPT(19)=' ROT 312--321  ELOSS= 0.004809'
      SCRPT(20)=' ROT 321--312  ELOSS=-0.004809'
      SCRPT(21)=' ROT 422--431  ELOSS= 0.008439'
      SCRPT(22)=' ROT 431--422  ELOSS=-0.008439'
      SCRPT(23)=' ROT 532--541  ELOSS= 0.01259 '
      SCRPT(24)=' ROT 541--532  ELOSS=-0.01259 '
      SCRPT(25)=' ROT 303--312  ELOSS= 0.004538'
      SCRPT(26)=' ROT 312--303  ELOSS=-0.004538'
      SCRPT(27)=' ROT 413--422  ELOSS= 0.004994'
      SCRPT(28)=' ROT 422--413  ELOSS=-0.004994'
      SCRPT(29)=' ROT 523--532  ELOSS= 0.007724'
      SCRPT(30)=' ROT 532--523  ELOSS=-0.007724'
      SCRPT(31)=' ROT 404--413  ELOSS= 0.006626'
      SCRPT(32)=' ROT 413--404  ELOSS=-0.006626'
      SCRPT(33)=' ROT 514--523  ELOSS= 0.005834'
      SCRPT(34)=' ROT 523--514  ELOSS=-0.005834'
      SCRPT(35)=' ROT 505--514  ELOSS= 0.009188'
      SCRPT(36)=' ROT 514--505  ELOSS=-0.009188'
      SCRPT(37)=' ROT 615--624  ELOSS= 0.007423'
      SCRPT(38)=' ROT 624--615  ELOSS=-0.007423'
      SCRPT(39)=' ROT 725--734  ELOSS= 0.007433'
      SCRPT(40)=' ROT 734--725  ELOSS=-0.007433'
      SCRPT(41)=' ROT 606--615  ELOSS= 0.01193 '
      SCRPT(42)=' ROT 615--606  ELOSS=-0.01193 '
      SCRPT(43)=' ROT 716--725  ELOSS= 0.009695'
      SCRPT(44)=' ROT 725--716  ELOSS=-0.009695'
      SCRPT(45)=' ROT 707--716  ELOSS= 0.01463 '
      SCRPT(46)=' ROT 716--707  ELOSS=-0.01463 '
      SCRPT(47)=' ROT 212--221  ELOSS= 0.006869'
      SCRPT(48)=' ROT 221--212  ELOSS=-0.006869'
      SCRPT(49)=' ROT 322--331  ELOSS= 0.009785'
      SCRPT(50)=' ROT 331--322  ELOSS=-0.009785'
      SCRPT(51)=' ROT 432--441  ELOSS= 0.01309 '
      SCRPT(52)=' ROT 441--432  ELOSS=-0.01309 '
      SCRPT(53)=' ROT 313--322  ELOSS= 0.007938'
      SCRPT(54)=' ROT 322--313  ELOSS=-0.007938'
      SCRPT(55)=' ROT 423--432  ELOSS= 0.01019 '
      SCRPT(56)=' ROT 432--423  ELOSS=-0.01019 '
      SCRPT(57)=' ROT 533--542  ELOSS= 0.01316 '
      SCRPT(58)=' ROT 542--533  ELOSS=-0.01316 '
      SCRPT(59)=' ROT 643--652  ELOSS= 0.01635 '
      SCRPT(60)=' ROT 652--643  ELOSS=-0.01635 '
      SCRPT(61)=' ROT 414--423  ELOSS= 0.009364'
      SCRPT(62)=' ROT 423--414  ELOSS=-0.009364'
      SCRPT(63)=' ROT 524--533  ELOSS= 0.01088 '
      SCRPT(64)=' ROT 533--524  ELOSS=-0.01088 '
      SCRPT(65)=' ROT 634--643  ELOSS= 0.01336 '
      SCRPT(66)=' ROT 643--634  ELOSS=-0.01336 '
      SCRPT(67)=' ROT 515--524  ELOSS= 0.01111 '
      SCRPT(68)=' ROT 524--515  ELOSS=-0.01111 '
      SCRPT(69)=' ROT 625--634  ELOSS= 0.01191 '
      SCRPT(70)=' ROT 634--625  ELOSS=-0.01191 '
      SCRPT(71)=' ROT 616--625  ELOSS= 0.01310 '
      SCRPT(72)=' ROT 625--616  ELOSS=-0.01310 '
      SCRPT(73)=' ROT 818--827  ELOSS= 0.01754 '
      SCRPT(74)=' ROT 827--818  ELOSS=-0.01754 '
      SCRPT(75)=' ROT 000--111  ELOSS= 0.004604'
      SCRPT(76)=' ROT 111--000  ELOSS=-0.004604'
      SCRPT(77)=' ROT 101--212  ELOSS= 0.006906'
      SCRPT(78)=' ROT 212--101  ELOSS=-0.006906'
      SCRPT(79)=' ROT 202--313  ELOSS= 0.008950'
      SCRPT(80)=' ROT 313--202  ELOSS=-0.008950'
      SCRPT(81)=' ROT 303--414  ELOSS= 0.01092 '
      SCRPT(82)=' ROT 414--303  ELOSS=-0.01092 '
      SCRPT(83)=' ROT 404--515  ELOSS= 0.01297 '
      SCRPT(84)=' ROT 515--404  ELOSS=-0.01297 '
      SCRPT(85)=' ROT 505--616  ELOSS= 0.01511 '
      SCRPT(86)=' ROT 616--505  ELOSS=-0.01511 '
      SCRPT(87)=' ROT 606--717  ELOSS= 0.01733 '
      SCRPT(88)=' ROT 717--606  ELOSS=-0.01733 '
      SCRPT(89)=' ROT 707--818  ELOSS= 0.01958 '
      SCRPT(90)=' ROT 818--707  ELOSS=-0.01958 '
      SCRPT(91)=' ROT 808--919  ELOSS= 0.02184 '
      SCRPT(92)=' ROT 919--808  ELOSS=-0.02184 '
      SCRPT(93)=' ROT 110--221  ELOSS= 0.01147 '
      SCRPT(94)=' ROT 221--110  ELOSS=-0.01147 '
      SCRPT(95)=' ROT 211--322  ELOSS= 0.01378 '
      SCRPT(96)=' ROT 322--211  ELOSS=-0.01378 '
      SCRPT(97)=' ROT 312--423  ELOSS= 0.01575 '
      SCRPT(98)=' ROT 423--312  ELOSS=-0.01575 '
      SCRPT(99)=' ROT 413--524  ELOSS= 0.01745 '
      SCRPT(100)=' ROT 524--413  ELOSS=-0.01745 '
      SCRPT(101)=' ROT 514--625  ELOSS= 0.01903 '
      SCRPT(102)=' ROT 625--514  ELOSS=-0.01903 '
      SCRPT(103)=' ROT 615--726  ELOSS= 0.02067 '
      SCRPT(104)=' ROT 726--615  ELOSS=-0.02067 '
      SCRPT(105)=' ROT 716--827  ELOSS= 0.02249 '
      SCRPT(106)=' ROT 827--716  ELOSS=-0.02249 '
      SCRPT(107)=' ROT 220--331  ELOSS= 0.01848 '
      SCRPT(108)=' ROT 331--220  ELOSS=-0.01848 '
      SCRPT(109)=' ROT 321--432  ELOSS= 0.02112 '
      SCRPT(110)=' ROT 432--321  ELOSS=-0.02112 '
      SCRPT(111)=' ROT 422--533  ELOSS= 0.02333 '
      SCRPT(112)=' ROT 533--422  ELOSS=-0.02333 '
      SCRPT(113)=' ROT 523--634  ELOSS= 0.02510 '
      SCRPT(114)=' ROT 634--523  ELOSS=-0.02510 '
      SCRPT(115)=' ROT 624--735  ELOSS= 0.02652 '
      SCRPT(116)=' ROT 735--624  ELOSS=-0.02652 '
      SCRPT(117)=' ROT 725--836  ELOSS= 0.02774 '
      SCRPT(118)=' ROT 836--725  ELOSS=-0.02774 '
      SCRPT(119)=' ROT 330--441  ELOSS= 0.02513 '
      SCRPT(120)=' ROT 441--330  ELOSS=-0.02513 '
      SCRPT(121)=' ROT 431--542  ELOSS= 0.02805 '
      SCRPT(122)=' ROT 542--431  ELOSS=-0.02805 '
      SCRPT(123)=' ROT 532--643  ELOSS= 0.03074 '
      SCRPT(124)=' ROT 643--532  ELOSS=-0.03074 '
      SCRPT(125)=' ROT 633--744  ELOSS= 0.03300 '
      SCRPT(126)=' ROT 744--633  ELOSS=-0.03300 '
      SCRPT(127)=' ROT 734--845  ELOSS= 0.03476 '
      SCRPT(128)=' ROT 845--734  ELOSS=-0.03476 '
      SCRPT(129)=' ROT 440--551  ELOSS= 0.03148 '
      SCRPT(130)=' ROT 551--440  ELOSS=-0.03148 '
      SCRPT(131)=' ROT 541--652  ELOSS= 0.03450 '
      SCRPT(132)=' ROT 652--541  ELOSS=-0.03450 '
      SCRPT(133)=' ROT 642--753  ELOSS= 0.03743 '
      SCRPT(134)=' ROT 753--642  ELOSS=-0.03743 '
      SCRPT(135)=' ROT 743--854  ELOSS= 0.04016 '
      SCRPT(136)=' ROT 854--743  ELOSS=-0.04016 '
      SCRPT(137)=' ROT 550--661  ELOSS= 0.03757 '
      SCRPT(138)=' ROT 661--550  ELOSS=-0.03757 '
      SCRPT(139)=' ROT 651--762  ELOSS= 0.04061 '
      SCRPT(140)=' ROT 762--651  ELOSS=-0.04061 '
      SCRPT(141)=' ROT 752--863  ELOSS= 0.04361 '
      SCRPT(142)=' ROT 863--752  ELOSS=-0.04361 '
      SCRPT(143)=' ROT 111--220  ELOSS= 0.01228 '
      SCRPT(144)=' ROT 220--111  ELOSS=-0.01228 '
      SCRPT(145)=' ROT 221--330  ELOSS= 0.01866 '
      SCRPT(146)=' ROT 330--221  ELOSS=-0.01866 '
      SCRPT(147)=' ROT 331--440  ELOSS= 0.02516 '
      SCRPT(148)=' ROT 440--331  ELOSS=-0.02516 '
      SCRPT(149)=' ROT 441--550  ELOSS= 0.03149 '
      SCRPT(150)=' ROT 550--441  ELOSS=-0.03149 '
      SCRPT(151)=' ROT 551--660  ELOSS= 0.03757 '
      SCRPT(152)=' ROT 660--551  ELOSS=-0.03757 '
      SCRPT(153)=' ROT 661--770  ELOSS= 0.04336 '
      SCRPT(154)=' ROT 770--661  ELOSS=-0.04336 '
      SCRPT(155)=' ROT 212--321  ELOSS= 0.01645 '
      SCRPT(156)=' ROT 321--212  ELOSS=-0.01645 '
      SCRPT(157)=' ROT 322--431  ELOSS= 0.02201 '
      SCRPT(158)=' ROT 431--322  ELOSS=-0.02201 '
      SCRPT(159)=' ROT 432--541  ELOSS= 0.02825 '
      SCRPT(160)=' ROT 541--432  ELOSS=-0.02825 '
      SCRPT(161)=' ROT 542--651  ELOSS= 0.03453 '
      SCRPT(162)=' ROT 651--542  ELOSS=-0.03453 '
      SCRPT(163)=' ROT 652--761  ELOSS= 0.04062 '
      SCRPT(164)=' ROT 761--652  ELOSS=-0.04062 '
      SCRPT(165)=' ROT 313--422  ELOSS= 0.02151 '
      SCRPT(166)=' ROT 422--313  ELOSS=-0.02151 '
      SCRPT(167)=' ROT 423--532  ELOSS= 0.02584 '
      SCRPT(168)=' ROT 532--423  ELOSS=-0.02584 '
      SCRPT(169)=' ROT 533--642  ELOSS= 0.03147 '
      SCRPT(170)=' ROT 642--533  ELOSS=-0.03147 '
      SCRPT(171)=' ROT 643--752  ELOSS= 0.03758 '
      SCRPT(172)=' ROT 752--643  ELOSS=-0.03758 '
      SCRPT(173)=' ROT 414--523  ELOSS= 0.02748 '
      SCRPT(174)=' ROT 523--414  ELOSS=-0.02748 '
      SCRPT(175)=' ROT 524--633  ELOSS= 0.03042 '
      SCRPT(176)=' ROT 633--524  ELOSS=-0.03042 '
      SCRPT(177)=' ROT 634--743  ELOSS= 0.03500 '
      SCRPT(178)=' ROT 743--634  ELOSS=-0.03500 '
      SCRPT(179)=' ROT 515--624  ELOSS= 0.03424 '
      SCRPT(180)=' ROT 624--515  ELOSS=-0.03424 '
      SCRPT(181)=' ROT 625--734  ELOSS= 0.03589 '
      SCRPT(182)=' ROT 734--625  ELOSS=-0.03589 '
      SCRPT(183)=' ROT 616--725  ELOSS= 0.04155 '
      SCRPT(184)=' ROT 725--616  ELOSS=-0.04155 '
      SCRPT(185)=' ROT 111--202  ELOSS= 0.004086'
      SCRPT(186)=' ROT 202--111  ELOSS=-0.004086'
      SCRPT(187)=' ROT 212--303  ELOSS= 0.007100'
      SCRPT(188)=' ROT 303--212  ELOSS=-0.007100'
      SCRPT(189)=' ROT 313--404  ELOSS= 0.009891'
      SCRPT(190)=' ROT 404--313  ELOSS=-0.009891'
      SCRPT(191)=' ROT 414--505  ELOSS= 0.01246 '
      SCRPT(192)=' ROT 505--414  ELOSS=-0.01246 '
      SCRPT(193)=' ROT 515--606  ELOSS= 0.01489 '
      SCRPT(194)=' ROT 606--515  ELOSS=-0.01489 '
      SCRPT(195)=' ROT 616--707  ELOSS= 0.01723 '
      SCRPT(196)=' ROT 707--616  ELOSS=-0.01723 '
      SCRPT(197)=' ROT 717--808  ELOSS= 0.01954 '
      SCRPT(198)=' ROT 808--717  ELOSS=-0.01954 '
      SCRPT(199)=' ROT 818--909  ELOSS= 0.02182 '
      SCRPT(200)=' ROT 909--818  ELOSS=-0.02182 '
      SCRPT(201)=' ROT 221--312  ELOSS= 0.004769'
      SCRPT(202)=' ROT 312--221  ELOSS=-0.004769'
      SCRPT(203)=' ROT 322--413  ELOSS= 0.008579'
      SCRPT(204)=' ROT 413--322  ELOSS=-0.008579'
      SCRPT(205)=' ROT 423--514  ELOSS= 0.01229 '
      SCRPT(206)=' ROT 514--423  ELOSS=-0.01229 '
      SCRPT(207)=' ROT 524--615  ELOSS= 0.01571 '
      SCRPT(208)=' ROT 615--524  ELOSS=-0.01571 '
      SCRPT(209)=' ROT 625--716  ELOSS= 0.01876 '
      SCRPT(210)=' ROT 716--625  ELOSS=-0.01876 '
      SCRPT(211)=' ROT 726--817  ELOSS= 0.02148 '
      SCRPT(212)=' ROT 817--726  ELOSS=-0.02148 '
      SCRPT(213)=' ROT 827--918  ELOSS= 0.02399 '
      SCRPT(214)=' ROT 918--827  ELOSS=-0.02399 '
      SCRPT(215)=' ROT 634--725  ELOSS= 0.01654 '
      SCRPT(216)=' ROT 725--634  ELOSS=-0.01654 '
      SCRPT(217)=' VIB V2        ELOSS=  0.198  '
      SCRPT(218)=' VIB V1+V3     ELOSS=  0.453  '
      SCRPT(219)=' EXC           ELOSS=  4.20   '
      SCRPT(220)=' EXC           ELOSS=  7.40   '
      SCRPT(221)=' EXC           ELOSS= 13.1    '
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.LE.XEL(1)) THEN
       Q(2,I)=YEL(1)*1.D-16
       GO TO 25
      ENDIF
      DO 10 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 20
   10 CONTINUE
      J=NEL
   20 Y1=LOG(YEL(J))
      Y2=LOG(YEL(J-1))
      X1=LOG(XEL(J))
      X2=LOG(XEL(J-1))
      A=(Y1-Y2)/(X1-X2)
      B=(X2*Y1-X1*Y2)/(X2-X1)
      Q(2,I)=EXP(A*LOG(EN)+B)*1.0D-16
C
   25 Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 50
      DO 30  J=2,NION
      IF(EN.LE.XION(J)) GO TO 40
   30 CONTINUE
      J=NION
   40 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
   50 Q(4,I)=0.0D0
      IF(EN.LT.XATT(1)) GO TO 55
      DO 51  J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 52
   51 CONTINUE
      J=NATT
   52 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
C
   55 Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C ----------------------------------------------------------------
C  DIPOLE BORN ROTATIONAL STATES
C----------------------------------------------------------------
      ENRT=SQRT(EN)
C
C  SUPER ELASTIC ROTATIONAL COLLISIONS
      DO 100 L=2,210,2
      AL=AJIN(L)
      L2=L/2
      QIN(L,I)=DBK*SALPHA(L2)*PJ(IMAP(L))*LOG((ENRT+SQRT(EN-EIN(L)))/
     /(SQRT(EN-EIN(L))-ENRT))/((2.0*AL+1.0)*EN)
  100 PEQIN(L,I)=0.5+(QIN(L,I)-DRAT*QIN(L,I))/QIN(L,I)
C
C ROTATIONAL COLLISIONS
      DO 150 L=1,209,2
      QIN(L,I)=0.0D0
      PEQIN(L,I)=0.5D0
      IF(EN.LE.EIN(L)) GO TO 150
      AL=AJIN(L)
      L2=(L+1)/2
      QIN(L,I)=DBK*SALPHA(L2)*PJ(IMAP(L))*LOG((ENRT+SQRT(EN-EIN(L)))/
     /(ENRT-SQRT(EN-EIN(L))))/((2.0*AL+1.0)*EN)
      PEQIN(L,I)=0.5+(QIN(L,I)-DRAT*QIN(L,I))/QIN(L,I)
  150 CONTINUE
C
C  VIBRATION
      QIN(211,I)=0.0D0
      IF(EN.LE.EIN(211)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(211,I)=(A*EN+B)*1.D-16
  400 CONTINUE
C
      QIN(212,I)=0.0D0
      IF(EN.LE.EIN(212)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(212,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(213,I)=0.0D0
      IF(EN.LE.EIN(213)) GO TO 600
      DO 510 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 520
  510 CONTINUE
      J=NEXC
  520 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(213,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(214,I)=0.0D0
      IF(EN.LE.EIN(214)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(214,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(215,I)=0.0D0
      IF(EN.LE.EIN(215)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(215,I)=(A*EN+B)*1.D-16
  800 CONTINUE
      SUM=0.0
      DO 850 K=1,210
      SUM=SUM+QIN(K,I)
  850 CONTINUE
C---------------------------------------------------------------------
C  SUM OF ELASTIC (MT), ROT (MT) AND INELASTIC
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(211,I)+QIN(212,I)+QIN(213,I)+
     /QIN(214,I)+QIN(215,I)+SUM*DRAT
C
  900 CONTINUE
C  SAVE COMPUTE TIME
      DO 1000 K=1,5
      J=216-K
      IF(EFINAL.LE.EIN(J)) NIN=J-1
 1000 CONTINUE
C
      END
