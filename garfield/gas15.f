CDECK  ID>, GAS15.
      SUBROUTINE GAS15(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(48),YXSEC(48),XVIB1(64),YVIB1(64),YVIB2(64),YVIB3(64
     /),YVIB4(64),XION(60),YION(60),X3ATT(30),Y3ATT(30),XATT(33),YATT(33
     /),XEXC1(21),YEXC1(21),XEXC2(15),YEXC2(15),XEXC3(18),YEXC3(18),
     /XEXC4(13),YEXC4(13),XEXC5(25),YEXC5(25),XEXC6(22),YEXC6(22),
     /XROT(53),YROT(53)
      DIMENSION PJ(30)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC + ROTATIONAL MOMENTUM TRANSFER
      DATA XEN/0.00,.001,.003,.005,.007,.0085,0.01,.015,0.02,0.03,
     /0.04,0.06,0.08,0.10,0.12,0.15,0.20,0.30,0.40,0.50,
     /0.60,0.80,1.00,1.20,1.50,2.00,2.50,3.00,4.00,5.00,
     /6.00,8.00,10.0,12.0,15.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,80.0,100.,200.,300.,500.,1000.,100000./
      DATA YXSEC/0.35,0.35,0.40,0.50,0.58,0.64,0.70,0.87,0.99,1.25,
     /1.50,1.85,2.65,3.85,4.80,5.60,5.70,5.80,5.90,5.95,
     /6.00,6.80,7.40,7.80,7.70,6.80,6.55,6.30,6.10,6.00,
     /5.90,5.85,5.80,5.70,5.60,5.45,5.10,4.70,3.75,3.12,
     /2.67,2.07,1.71,0.93,0.67,0.33,0.10,.001/
C VIB V1
      DATA XVIB1/.193,0.20,0.21,0.23,0.32,0.33,0.35,0.44,0.45,0.47,
     /0.56,0.57,0.59,0.68,0.69,0.71,0.79,0.80,0.82,0.90,
     /0.91,0.93,1.02,1.03,1.05,1.13,1.14,1.16,1.23,1.24,
     /1.26,1.34,1.35,1.37,1.44,1.45,1.47,1.54,1.55,1.57,
     /1.63,1.65,1.67,4.00,5.00,6.00,7.00,8.00,8.50,9.00,
     /9.50,10.0,11.0,12.0,13.0,14.0,15.0,17.0,20.0,45.0,
     /100.,1000.,10000.,100000./
      DATA YVIB1/0.00,0.11,0.11,0.00,0.00,0.94,0.00,0.00,1.10,0.00,
     /0.00,1.40,0.00,0.00,1.30,0.00,0.00,1.00,0.00,0.00,
     /0.60,0.00,0.00,.285,0.00,0.00,.113,0.00,0.00,.048,
     /0.00,0.00,.017,0.00,0.00,.0055,0.00,0.00,.0019,0.00,
     /0.00,.0006,0.00,.001,.042,.100,.176,.231,.245,.247,
     /.245,.234,.186,.143,.102,.071,.040,.020,.010,.001,
     /0.00,0.00,0.00,0.00/
C VIB 2V1
      DATA YVIB2/0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,
     /0.00,0.14,0.00,0.00,.415,0.00,0.00,.535,0.00,0.00,
     /.465,0.00,0.00,.315,0.00,0.00,0.20,0.00,0.00,.095,
     /0.00,0.00,0.04,0.00,0.00,.018,0.00,0.00,.008,0.00,
     /0.00,.003,0.00,.001,.028,.040,.073,.094,.105,.110,
     /.109,.109,.093,.073,.051,.028,.013,.008,.005,.001,
     /0.00,0.00,0.00,0.00/
C VIB 3V1
      DATA YVIB3/0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,
     /0.00,0.00,0.00,0.00,.0037,0.00,0.00,.0215,0.0,0.0,
     /0.09,0.00,0.00,0.12,0.00,0.00,.115,0.00,0.00,.095,
     /0.00,0.00,.055,0.00,0.00,.030,0.00,0.00,.0165,0.00,
     /0.00,.008,0.00,0.00,0.00,.012,.036,.059,.067,.075,
     /.072,.068,.056,.048,.030,.017,.009,.002,.001,0.00,
     /0.00,0.00,0.00,0.00/
C VIB 4V1
      DATA YVIB4/0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,
     /0.00,0.00,0.00,0.00,0.00,0.00,0.00,.0015,0.00,0.0,
     /.0055,0.00,0.0,.0095,0.00,0.0,.0165,0.00,0.0,.0315,
     /0.00,0.00,.0335,0.0,0.00,.0285,0.00,0.0,.0215,0.00,
     /0.00,.0165,0.00,0.0,0.00,.001,.027,.035,.038,.041,
     /.043,.046,.031,.025,.018,.009,.001,0.00,0.00,0.00,
     /0.00,0.00,0.00,0.00/
C IONISATION
      DATA XION/12.072,12.5,13.0,13.5,14.0,14.5,15.0,15.5,16.0,16.5,
     /17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,
     /22.0,24.0,26.0,28.0,30.0,32.0,34.0,36.0,40.0,45.0,
     /50.0,55.0,60.0,70.0,80.0,90.0,100.,110.,120.,130.,
     /140.,150.,160.,180.,200.,250.,300.,400.,500.,600.,
     /700.,800.,900.,1000.,2000.,4000.,6000.,10000.,20000.,100000./
      DATA YION/0.00,.0105,.023,.041,.054,.069,.085,.098,.114,.136,
     /.158,.180,.203,.229,.253,.279,.307,.333,.360,.387,
     /.416,.535,.654,.770,.897,1.03,1.15,1.27,1.47,1.70,
     /1.88,2.03,2.17,2.38,2.52,2.62,2.67,2.71,2.72,2.72,
     /2.71,2.69,2.67,2.62,2.53,2.36,2.18,1.88,1.67,1.49,
     /1.35,1.23,1.13,1.06,0.60,0.34,0.24,.155,.084,.020/
C  THREE BODY ATTACHMENT
      DATA X3ATT/0.035,0.04,.045,0.05,.055,.056,.058,0.06,.065,0.07,
     /.075,0.08,.081,.085,0.09,.095,0.10,.101,.105,0.11,
     /.115,0.20,0.30,0.40,0.50,0.80,1.00,2.00,1000.,100000./
      DATA Y3ATT/0.00,.00063,.00137,.00281,.00562,.00624,.00781,.01062,
     /.0206,.0375,
     /.0718,.137,.140,.0718,.0312,.0562,.112,.122,.0624,.0125,
     /0.016,.024,.017,.013,.010,.004,.002,.0001,.0000001,0.0/
C  DISSOCIATIVE ATTACHMENT
      DATA XATT/4.20,4.40,4.60,4.80,5.00,5.20,5.40,5.60,5.80,6.00,
     /6.20,6.30,6.40,6.50,6.60,6.70,6.80,7.00,7.20,7.40,
     /7.60,7.80,8.00,8.20,8.40,8.60,8.80,9.00,9.40,10.0,
     /12.0,100.,100000./
      DATA YATT/0.00,.00026,.00070,.00132,.00220,.00360,.00536,.00747,
     /.00958,.0114,
     /.0131,.0136,.0140,.0141,.0140,.0137,.0134,.0120,.0106,.00897,
     /.00738,.00571,.00448,.00334,.00237,.00167,.00123,.00088,.00053,
     /.00028,.0001,.000001,.000000001/
C  EXCITATION TO A1 DELTA G
      DATA XEXC1/.977,.982,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,15.0,20.0,30.0,40.0,50.0,60.0,80.0,100.,1000.,100000./
      DATA YEXC1/0.00,.001,.0165,.037,.055,.068,.075,.0782,.079,.0773,
     /.075,.0575,.0435,.026,.0182,.0137,.0108,.0073,.0054,.0001,.000001/
C  EXCITATION TO B1 SIGMA G+
      DATA XEXC2/1.627,1.64,2.00,3.00,4.00,5.00,6.00,8.00,10.0,15.0,
     /20.0,40.0,100.,1000.,100000./
      DATA YEXC2/0.00,.001,.003,.010,.015,.018,.020,.020,.016,.014,
     /.013,.005,.002,.0002,.00002/
C  EXCITATION SUM OF C1 SIGMA U- AND C3 DELTA U
      DATA XEXC3/4.50,4.80,5.00,5.50,6.00,6.50,7.00,7.50,8.00,9.00,
     /10.0,12.0,15.0,20.0,50.0,100.,1000.,100000./
      DATA YEXC3/0.00,.003,.009,.030,.065,.085,.095,.100,.100,.085,
     /.070,.045,.020,.010,.005,.002,.001,.00001/
C  EXCITATION TO A3 SIGMA U+     (MOLECULAR DISSOCIATION)
      DATA XEXC4/6.10,7.00,7.80,9.00,10.0,12.0,15.0,17.0,20.0,45.0,
     /100.,1000.,100000./
      DATA YEXC4/0.00,.150,.250,.232,.210,.165,.105,.065,.048,.019,
     /.0096,.001,.00001/
C  EXCITATION TO B3 SIGMA U-     (MOLECULAR DISSOCIATION)
      DATA XEXC5/8.40,9.00,10.0,12.0,15.0,18.0,20.0,22.0,25.0,30.0,
     /40.0,50.0,60.0,80.0,100.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,10000.,100000./
      DATA YEXC5/0.00,.129,.329,.772,1.15,1.31,1.34,1.35,1.34,1.27,
     /1.11,1.00,0.90,0.74,0.64,0.45,0.35,0.24,0.19,0.15,
     /0.13,.102,.086,.013,.0011/
C  EXCITATION TO HIGHER STATES SUMMED CROSS SECTION
      DATA XEXC6/9.30,10.0,12.0,15.0,18.0,20.0,25.0,30.0,35.0,40.0,
     /50.0,60.0,80.0,100.,150.,200.,300.,400.,500.,600.,
     /1000.,100000./
      DATA YEXC6/0.00,.014,.079,.133,.162,.171,.176,.173,.166,.155,
     /.138,.123,.102,.084,.055,.041,.025,.019,.014,.012,
     /.0055,.000055/
C LAWTON AND PHELPS RESONANT ROTATION
      DATA XROT/.020,.021,.025,0.07,0.08,0.10,0.20,0.21,0.22,0.32,
     /0.33,0.35,0.44,0.45,0.47,0.56,0.57,0.59,0.68,0.69,
     /0.71,0.79,0.80,0.81,0.90,0.91,0.93,1.02,1.03,1.05,
     /1.13,1.14,1.16,1.23,1.24,1.26,1.34,1.35,1.37,1.44,
     /1.45,1.47,1.54,1.55,1.57,1.64,1.65,1.67,10.,100.,
     /1000.,10000.,100000./
      DATA YROT/.00,.0001,.0001,.0001,.0054,.0001,.0001,.0216,.0001,
     /.0001,
     /.0384,.0001,.0001,.054,.0001,.0001,.067,.0001,.0001,0.08,
     /.0001,.0001,.093,.0001,.0001,.084,.0001,.0001,.072,.0001,
     /.0001,.047,.0001,.0001,.060,.0001,.0001,.036,.0001,.0001,
     /.024,.0001,.0001,.012,.0001,.0001,.0048,.0001,.000001,.0000001,
     /.00000001,.00000001,.00000000001/
C ----------------------------------------------------------------------
C  X-SECTIONS DERIVED FROM LAWTON AND PHELPS : J.CHEM.PHYS. 69(1978)1055
C  VIBRATIONAL X-SECTION ADJUSTED TO FIT ARGON MIXTURE DATA OF:
C  JEON AND NAKAMURA  J.APPL.PHYS D 31(1998) 2145-2150
C  ELASTIC X-SECTION DERIVED FROM FIT TO PURE OXYGEN DATA OF:
C  JEON AND NAKAMURA  (AS ABOVE)  AT HIGH FIELD ,
C  AND THE DATA AT LOW FIELD OF :
C  CROMPTON AND ELFORD AUST. J. PHYS. 26(1973)771-782
C  REID AND CROMPTON   AUST. J. PHYS. 33(1980)215-216
C  N.B THE 3-BODY ATTACHMENT X-SECTION IS INCLUDED IN THE SUBROUTINE.
C  THE FIT TO THE DRIFT VELOCITY AND DIFFUSION MEASURED BY THE ABOVE
C  REFERENCES IS WITHIN THE EXPERIMENTAL ERRORS .
C-----------------------------------------------------------------------
C  2004 : INCLUDED FULL SET OF POPULATED ROTATIONAL LEVELS AND
C         TRANSITIONS FOR LINEAR ROTOR USING EFFECTIVE QUADRUPOLE
C         MOMENT OF - 0.26 ea0**2 and B0=0.1783mev.
C         LESS THAN 1% CHANGE ON TRANSPORT COEFICIENTS WITH RESPECT TO
C         2003 ANALYSIS USING SINGLE LUMPED EFFECTIVE ROTATIONAL LEVEL
C ----------------------------------------------------------------------
C
      NAME='O2 (2004)'
C
      NIN=40
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NROT=53
      NDATA=48
      NVIB1=64
      NVIB2=64
      NVIB3=64
      NVIB4=64
      NION=60
      NATT=33
      N3ATT=30
      NEXC1=21
      NEXC2=15
      NEXC3=18
      NEXC4=13
      NEXC5=25
      NEXC6=22
      E(1)=0.0
      E(2)=2.0*EMASS/(31.9988*AMU)
      E(3)=12.072
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=17.4
C--------------------------------------------------------
      B0=0.0001783
      A0=0.5291772083D-8
      QBQA=0.26
      QBK=1.67552*(QBQA*A0)**2
C--------------------------------------------------------
C CALC FRACTIONAL POPULATION DENSITY OF ROTATIONAL STATES
      PJ(1)=3.0
      DO 3 L=2,15
      J=(2*L)-1
    3 PJ(L)=(2*J+1)*EXP(-(J*(J+1)-2)*B0/AKT)
      SUM=0.0
      DO 5 L=1,15
    5 SUM=SUM+PJ(L)
      DO 6 L=1,15
    6 PJ(L)=PJ(L)/SUM
C---------------------------------------------------------
C CALCULATE ROTATIONAL TRANSITION ENERGIES
      DO 7 K=1,27,2
      EIN(K)=B0*(4*K+6)
    7 EIN(K+1)=-EIN(K)
C
      EIN(29)=-0.020
      EIN(30)=0.020
      EIN(31)=0.193
      EIN(32)=0.386
      EIN(33)=0.579
      EIN(34)=0.772
      EIN(35)=0.977
      EIN(36)=1.627
      EIN(37)=4.50
      EIN(38)=6.10
      EIN(39)=8.40
      EIN(40)=9.30
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       OXYGEN         '
      SCRPT(3)=' IONISATION    ELOSS= 12.072  '
      SCRPT(4)=' ATTACHMENT 2+3 BODY          '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT  1-3      ELOSS= 0.001783'
      SCRPT(8)=' ROT  3-1      ELOSS=-0.001783'
      SCRPT(9)=' ROT  3-5      ELOSS= 0.003209'
      SCRPT(10)=' ROT  5-3      ELOSS=-0.003209'
      SCRPT(11)=' ROT  5-7      ELOSS= 0.004636'
      SCRPT(12)=' ROT  7-5      ELOSS=-0.004636'
      SCRPT(13)=' ROT  7-9      ELOSS= 0.006062'
      SCRPT(14)=' ROT  9-7      ELOSS=-0.006062'
      SCRPT(15)=' ROT  9-11     ELOSS= 0.007489'
      SCRPT(16)=' ROT 11-9      ELOSS=-0.007489'
      SCRPT(17)=' ROT 11-13     ELOSS= 0.008915'
      SCRPT(18)=' ROT 13-11     ELOSS=-0.008915'
      SCRPT(19)=' ROT 13-15     ELOSS= 0.01034 '
      SCRPT(20)=' ROT 15-13     ELOSS=-0.01034 '
      SCRPT(21)=' ROT 15-17     ELOSS= 0.01177 '
      SCRPT(22)=' ROT 17-15     ELOSS=-0.01177 '
      SCRPT(23)=' ROT 17-19     ELOSS= 0.01319 '
      SCRPT(24)=' ROT 19-17     ELOSS=-0.01319 '
      SCRPT(25)=' ROT 19-21     ELOSS= 0.01462 '
      SCRPT(26)=' ROT 21-19     ELOSS=-0.01462 '
      SCRPT(27)=' ROT 21-23     ELOSS= 0.01605 '
      SCRPT(28)=' ROT 23-21     ELOSS=-0.01605 '
      SCRPT(29)=' ROT 23-25     ELOSS= 0.01747 '
      SCRPT(30)=' ROT 25-23     ELOSS=-0.01747 '
      SCRPT(31)=' ROT 25-27     ELOSS= 0.01890 '
      SCRPT(32)=' ROT 27-25     ELOSS=-0.01890 '
      SCRPT(33)=' ROT 27-29     ELOSS= 0.02033 '
      SCRPT(34)=' ROT 29-27     ELOSS=-0.02033 '
      SCRPT(35)=' ROT RESONANCE ELOSS= -0.020  '
      SCRPT(36)=' ROT RESONANCE ELOSS=  0.020  '
      SCRPT(37)=' VIB V1        ELOSS=  0.193  '
      SCRPT(38)=' VIB 2V1       ELOSS=  0.386  '
      SCRPT(39)=' VIB 3V1       ELOSS=  0.579  '
      SCRPT(40)=' VIB 4V1       ELOSS=  0.772  '
      SCRPT(41)=' EXC A1(DEL)G  ELOSS=  0.977  '
      SCRPT(42)=' EXC B1(SIG)G  ELOSS=  1.627  '
      SCRPT(43)=' EXC C1+C3     ELOSS=  4.50   '
      SCRPT(44)=' EXC A3 DISOC  ELOSS=  6.10   '
      SCRPT(45)=' EXC B3 DISOC  ELOSS=  8.40   '
      SCRPT(46)=' EXC           ELOSS=  9.30   '
C CALCULATE DENSITY CORRECTION FOR THREE BODY ATTACHMENT CROSS-SECTION
      FAC=273.15D0*TORR/((TEMPC+273.15D0)*760.0D0)
C
      APOP1=EXP(EIN(29)/AKT)
      EN=-ESTEP/2.0D0
      DO 9900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 50
      DO 30 J=2,NION
      IF(EN.LE.XION(J)) GO TO 40
   30 CONTINUE
      J=NION
   40 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
   50 SINGLE=0.0D0
      IF(EN.LT.XATT(1)) GO TO 80
      IF(EN.GT.XATT(NATT)) GO TO 80
      DO 60 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 70
   60 CONTINUE
      J=NATT
   70 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      SINGLE=(A*EN+B)*1.D-16
C
   80 THREEB=0.0D0
      IF(EN.LT.X3ATT(1)) GO TO 100
      IF(EN.GT.X3ATT(N3ATT)) GO TO 100
      DO 90 J=2,N3ATT
      IF(EN.LE.X3ATT(J)) GO TO 95
   90 CONTINUE
      J=N3ATT
   95 A=(Y3ATT(J)-Y3ATT(J-1))/(X3ATT(J)-X3ATT(J-1))
      B=(X3ATT(J-1)*Y3ATT(J)-X3ATT(J)*Y3ATT(J-1))/(X3ATT(J-1)-X3ATT(J))
      THREEB=FAC*(A*EN+B)*1.D-16
  100 Q(4,I)=SINGLE+THREEB
      Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C------------------------------------------------------------
C QUADRUPOLE BORN ROTATIONAL STATES
C-------------------------------------------------------------
C  SUPERELASTIC ROTATION
      DO 200 K=2,28,2
      AJ=DBLE(K+1)
      L=1+(K/2)
  200 QIN(K,I)=PJ(L)*QBK*SQRT(1.0-EIN(K)/EN)*AJ*(AJ-1.0)/((2.0*AJ+1.0)*
     /(2.0*AJ-1.0))
C   ROTATION
      DO 250 K=1,27,2
      QIN(K,I)=0.0D0
      IF(EN.LE.EIN(K)) GO TO 250
      AJ=DBLE(K)
      L=(K+1)/2
      QIN(K,I)=PJ(L)*QBK*SQRT(1.0-EIN(K)/EN)*(AJ+2.0)*(AJ+1.0)/((2.0*AJ
     /+3.0)*(2.0*AJ+1.0))
  250 CONTINUE
C  MOD :  USE BORN 1/E  FALL OFF OF ROTATIONAL X-SECTION ABOVE 6.0 EV
      IF(EN.LT.6.0) GO TO 300
      DO 270 K=1,28
  270 QIN(K,I)=QIN(K,I)*6.0/EN
C
C SUPERELASTIC RESONANT ROTATION
  300 QIN(29,I)=0.0D0
      IF(EN.EQ.0.0) GO TO 350
      DO 330 J=2,NROT
      IF((EN+EIN(30)).LE.XROT(J)) GO TO 340
  330 CONTINUE
      J=NROT
  340 A=(YROT(J)-YROT(J-1))/(XROT(J)-XROT(J-1))
      B=(XROT(J-1)*YROT(J)-XROT(J)*YROT(J-1))/(XROT(J-1)-XROT(J))
      QIN(29,I)=(A*(EN+EIN(30))+B)*(EN+EIN(30))/EN
      QIN(29,I)=QIN(29,I)*APOP1/(1.0+APOP1)*1.D-16
  350 CONTINUE
C
C   RESONANT ROTATION
      QIN(30,I)=0.0D0
      IF(EN.LE.EIN(30)) GO TO 400
      DO 360 J=2,NROT
      IF(EN.LE.XROT(J)) GO TO 370
  360 CONTINUE
      J=NROT
  370 A=(YROT(J)-YROT(J-1))/(XROT(J)-XROT(J-1))
      B=(XROT(J-1)*YROT(J)-XROT(J)*YROT(J-1))/(XROT(J-1)-XROT(J))
      QIN(30,I)=(A*EN+B)/(1.0+APOP1)*1.D-16
  400 CONTINUE
C   VIB V1
      QIN(31,I)=0.0D0
      IF(EN.LE.EIN(31)) GO TO 500
      DO 410 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 420
  410 CONTINUE
      J=NVIB1
  420 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(31,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C     VIB 2V1
      QIN(32,I)=0.0D0
      IF(EN.LE.EIN(32)) GO TO 600
      DO 510 J=2,NVIB2
      IF(EN.LE.XVIB1(J)) GO TO 520
  510 CONTINUE
      J=NVIB2
  520 A=(YVIB2(J)-YVIB2(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB2(J)-XVIB1(J)*YVIB2(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(32,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C   VIB 3V1
      QIN(33,I)=0.0D0
      IF(EN.LE.EIN(33)) GO TO 700
      DO 610 J=2,NVIB3
      IF(EN.LE.XVIB1(J)) GO TO 620
  610 CONTINUE
      J=NVIB3
  620 A=(YVIB3(J)-YVIB3(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB3(J)-XVIB1(J)*YVIB3(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(33,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C   VIB 4V1
      QIN(34,I)=0.0D0
      IF(EN.LE.EIN(34)) GO TO 800
      DO 710 J=2,NVIB4
      IF(EN.LE.XVIB1(J)) GO TO 720
  710 CONTINUE
      J=NVIB4
  720 A=(YVIB4(J)-YVIB4(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB4(J)-XVIB1(J)*YVIB4(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(34,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(35,I)=0.0D0
      IF(EN.LE.EIN(35)) GO TO 900
      DO 810 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 820
  810 CONTINUE
      J=NEXC1
  820 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(35,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      QIN(36,I)=0.0D0
      IF(EN.LE.EIN(36)) GO TO 1000
      DO 910 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 920
  910 CONTINUE
      J=NEXC2
  920 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(36,I)=(A*EN+B)*1.D-16
 1000 CONTINUE
C
      QIN(37,I)=0.0D0
      IF(EN.LE.EIN(37)) GO TO 1100
      DO 1010 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 1020
 1010 CONTINUE
      J=NEXC3
 1020 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(37,I)=(A*EN+B)*1.D-16
 1100 CONTINUE
C
      QIN(38,I)=0.0D0
      IF(EN.LE.EIN(38)) GO TO 1200
      DO 1110 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 1120
 1110 CONTINUE
      J=NEXC4
 1120 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(38,I)=(A*EN+B)*1.D-16
 1200 CONTINUE
C
      QIN(39,I)=0.0D0
      IF(EN.LE.EIN(39)) GO TO 1300
      DO 1210 J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GO TO 1220
 1210 CONTINUE
      J=NEXC5
 1220 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(39,I)=(A*EN+B)*1.D-16
 1300 CONTINUE
C
      QIN(40,I)=0.0D0
      IF(EN.LE.EIN(40)) GO TO 1400
      DO 1310 J=2,NEXC6
      IF(EN.LE.XEXC6(J)) GO TO 1320
 1310 CONTINUE
      J=NEXC6
 1320 A=(YEXC6(J)-YEXC6(J-1))/(XEXC6(J)-XEXC6(J-1))
      B=(XEXC6(J-1)*YEXC6(J)-XEXC6(J)*YEXC6(J-1))/(XEXC6(J-1)-XEXC6(J))
      QIN(40,I)=(A*EN+B)*1.D-16
 1400 CONTINUE
      SUMROT=0.0D0
      DO 1500 K=1,30
 1500 SUMROT=SUMROT+QIN(K,I)
C-------------------------------------------------------------------
C GET CORRECT ELASTIC
      Q(2,I)=Q(2,I)-SUMROT
C-------------------------------------------------------------------
C TOTAL X-SECTION Q(1,I) USED FOR INFORMATION ONLY
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(31,I)+QIN(32,I)+QIN(33,I)+
     /QIN(34,I)+QIN(35,I)+QIN(36,I)+QIN(37,I)+QIN(38,I)+QIN(39,I)+
     /QIN(40,I)+SUMROT
 9900 CONTINUE
C  SAVE COMPUTE TIME
      DO 9990 K=1,10
      J=41-K
      IF(EFINAL.LE.EIN(J)) NIN=J-1
 9990 CONTINUE
C
      END
