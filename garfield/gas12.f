CDECK  ID>, GAS12.
      SUBROUTINE GAS12(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220),PJ(220)
      DIMENSION XEN(65),YMOM(65),XV2(21),YV2(21),X2V2(23),Y2V2(23),
     /XV1(30),YV1(30),X3V2(15),Y3V2(15),XV3(15),YV3(15),
     /XVPD3(20),YVPD3(20),XV130(17),YV130(17),XVPD4(18),YVPD4(18),
     /XVPD5(15),YVPD5(15),XVPD6(15),YVPD6(15),XVPD7(15),YVPD7(15),
     /XVPD8(15),YVPD8(15),XVPD9(15),YVPD9(15),XVPDH(13),YVPDH(13),
     /XEXC1(40),YEXC1(40),XEXC2(40),YEXC2(40),XEXC3(38),YEXC3(38),
     /XEXC4(38),YEXC4(38),XEXC5(38),YEXC5(38),XEXC6(38),YEXC6(38),
     /XATT(29),YATT(29),XION(68),YION(68),YEL(65),YVBMOM(65),YVBEL(65)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC +ROTATIONAL
      DATA XEN/1.D-6,.001,.002,.004,.007,.010,.014,.020,.030,.040,
     /0.05,0.06,0.08,0.10,.125,.150,.175,0.20,0.25,0.30,
     /0.35,0.40,0.50,0.60,0.70,0.85,1.00,1.25,1.50,1.70,
     /1.90,2.10,2.30,2.50,2.80,3.00,3.30,3.60,3.80,4.00,
     /4.50,5.00,5.50,6.00,7.00,8.00,10.0,12.0,15.0,17.0,
     /20.0,25.0,30.0,50.0,75.0,100.,200.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
C GROUND STATE AND BEND MODE ELASTIC + ROTATION.  MOMENTUM TRANSFER
C  AT 293.15 KELVIN
      DATA YMOM/148.,148.,146.,141.,134.,128.,119.,109.,95.0,85.0,
     /76.5,69.5,59.0,52.5,47.5,41.0,36.0,30.0,22.0,16.2,
     /12.8,10.6,8.20,6.45,5.35,4.30,3.90,3.65,3.60,3.65,
     /3.75,3.85,4.00,4.20,4.60,4.90,5.30,5.80,6.00,6.00,
     /5.50,5.10,5.00,5.20,6.10,7.30,8.80,10.0,11.0,11.0,
     /10.8,10.2,9.50,6.50,4.25,3.15,1.16,0.42,0.23,0.12,
     /.046,.021,.0081,.0040,.001/
C GROUND STATE AND BEND MODE ELASTIC + ROTATION  AT 293.15 KELVIN
      DATA YEL/148.,148.,146.,141.,135.,129.,120.,110.,96.0,86.0,
     /77.5,70.5,60.0,53.5,48.5,42.0,37.0,31.5,24.8,20.4,
     /17.4,15.5,13.0,10.7,9.20,7.50,6.30,5.30,4.65,4.46,
     /4.45,4.45,4.60,4.75,5.10,5.55,6.80,7.90,8.50,7.80,
     /6.25,6.15,6.60,7.05,8.10,9.50,11.5,13.1,13.3,13.7,
     /13.8,14.0,13.7,10.4,8.25,7.00,4.55,2.85,2.10,1.40,
     /0.80,0.44,0.20,.105,.018/
C ELASTIC FOR BEND MODE VIBRATIONS.   MOMENTUM TRANSFER
      DATA YVBMOM/148.,148.,146.,141.,134.,128.,119.,109.,95.0,85.0,
     /76.5,69.5,59.0,53.5,50.0,46.5,45.5,45.0,43.0,37.0,
     /28.5,22.5,16.0,11.5,8.95,6.80,5.80,5.05,4.80,4.65,
     /4.65,4.70,4.80,5.00,5.35,5.65,6.00,6.20,6.20,6.10,
     /5.50,5.10,5.00,5.20,6.10,7.30,8.80,10.0,11.0,11.0,
     /10.8,10.2,9.50,6.50,4.25,3.15,1.16,0.42,0.23,0.12,
     /.046,.021,.0081,.0040,.001/
C ELASTIC FOR BEND MODE VIBRATIONS.
      DATA YVBEL/165.,165.,163.,158.,152.,146.,137.,127.,113.,103.,
     /94.5,87.5,77.0,70.5,65.5,59.0,52.5,47.0,43.3,37.0,
     /28.5,24.0,19.0,16.2,14.2,12.5,11.4,9.50,8.10,7.66,
     /7.65,7.75,7.90,8.80,9.10,9.55,10.8,11.9,12.0,10.8,
     /9.25,8.15,7.60,7.55,8.10,9.50,11.5,13.1,13.3,13.7,
     /13.8,14.0,13.7,10.4,8.25,7.00,4.55,2.85,2.10,1.40,
     /0.80,0.44,0.20,.105,.018/
C
C V(010)  BEND MODE  ( ANALYTICAL DIPOLE FUNCTION AT THRESHOLD)
      DATA XV2/.08275,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /8.00,10.0,15.0,20.0,30.0,50.0,70.0,100.,1000.,10000.,
     /100000./
      DATA YV2/0.00,0.00,0.24,0.48,1.29,1.70,1.70,1.17,0.74,0.42,
     /0.01,0.08,0.05,0.08,0.12,0.07,.001,.0001,.00001,.000001,
     /.0000001/
C V(020)  BEND MODE HARMONIC  RESONANCE
      DATA X2V2/.15937,0.18,0.50,1.00,2.00,3.00,3.50,3.80,4.00,4.50,
     /5.00,6.00,8.00,10.0,15.0,20.0,30.0,50.0,70.0,100.,
     /1000.,10000.,100000./
      DATA Y2V2/0.00,0.02,0.01,.003,.025,0.09,0.31,0.44,0.56,0.49,
     /0.35,0.17,0.08,0.10,0.02,.008,.015,.008,.001,.0001,
     /.00001,.000001,.0000001/
C V(100) SYMMETRIC STRETCH
      DATA XV1/.17211,0.18,0.20,0.23,0.25,0.30,0.40,0.50,0.60,1.00,
     /2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,8.00,
     /10.0,15.0,20.0,30.0,50.0,70.0,100.,1000.,10000.,100000./
      DATA YV1/0.00,.475,.790,0.91,0.91,0.82,0.58,0.43,0.34,0.32,
     /0.38,0.66,0.89,1.27,1.32,1.04,0.53,0.18,.084,.075,
     /.077,.030,.009,.030,.008,.001,.0001,.00001,.000001,.0000001/
C V(030) + V(110)
      DATA X3V2/.251,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA Y3V2/0.00,0.00,0.01,0.17,0.36,0.58,0.58,0.36,0.17,0.01,
     /.001,.0001,.00001,.000001,.0000001/
C V(001) ASYMMETRIC STRETCH  (ANALYTICAL DIPOLE FUNCTION AT THRESHOLD)
      DATA XV3/.29126,2.00,3.00,3.50,3.80,4.00,4.50,5.00,6.00,8.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YV3/0.00,0.00,.002,.005,.010,.005,.002,.001,.001,.001,
     /.001,.0001,.00001,.000001,.0000001/
C V(040) + V(120) + V(200)  POLYAD 3
      DATA XVPD3/.335,0.35,0.50,0.80,2.00,2.50,3.00,3.50,3.80,4.00,
     /4.50,5.00,6.00,10.0,20.0,40.0,100.,1000.,10000.,100000./
      DATA YVPD3/0.00,0.09,.035,0.02,0.02,0.02,0.21,0.43,0.70,0.70,
     /0.43,0.21,0.05,.020,0.01,.005,.0001,.00001,.000001,.0000001/
C  V(130) + V(210)
      DATA XV130/0.422,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,20.0,40.0,100.,1000.,10000.,100000./
      DATA YV130/0.00,0.00,.005,0.10,0.22,0.35,0.35,0.22,0.10,.025,
     /.005,.002,.001,.0001,.00001,.000001,.0000001/
C  POLYAD 4
      DATA XVPD4/0.505,0.55,0.65,1.00,2.00,2.50,3.00,3.50,3.80,4.00,
     /4.50,5.00,6.00,10.0,100.,1000.,10000.,100000./
      DATA YVPD4/0.00,.0017,.0005,.0001,.0001,.005,0.12,0.24,0.40,0.40,
     /0.24,0.13,0.01,.001,.0001,.00001,.000001,.0000001/
C  POLYAD 5
      DATA XVPD5/0.685,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD5/0.00,0.00,.003,0.07,0.14,0.24,0.24,0.14,0.08,.006,
     /.001,.0001,.00001,.000001,.0000001/
C  POLYAD 6
      DATA XVPD6/0.825,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD6/0.00,0.00,.001,0.05,0.10,0.16,0.16,0.10,0.05,.004,
     /.001,.0001,.00001,.000001,.0000001/
C  POLYAD 7
      DATA XVPD7/0.995,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD7/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,.0000001/
C  POLYAD 8
      DATA XVPD8/1.160,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD8/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,.0000001/
C  POLYAD 9
      DATA XVPD9/1.320,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD9/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,.0000001/
C  SUM HIGHER POLYADS
      DATA XVPDH/2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,10.0,100.,
     /1000.,10000.,100000./
      DATA YVPDH/0.00,0.01,0.36,0.58,0.58,0.36,0.16,.045,.001,.0001,
     /.00001,.000001,.0000001/
C DATA FROM RAP AND BRIGLIA WITH CORRECTED ONSET
      DATA XATT/3.85,4.00,4.20,4.40,4.60,4.80,5.00,5.20,5.40,6.30,
     /6.60,6.90,7.20,7.40,7.60,7.80,8.00,8.20,8.40,8.60,
     /8.80,9.00,9.20,9.50,9.80,10.0,100.,1000.,100000./
      DATA YATT/.0,.0005,.0014,.0014,.001,.0006,.0003,.0001,.0001,.0001,
     /.0001,.0002,.0008,.0018,.0027,.0036,.0042,.0041,.0034,.0020,
     /.0012,.0004,.0003,.0002,.0001,.0001,.00001,.000001,.0000001/
C
      DATA XEXC1/7.90,9.00,10.0,11.0,12.0,13.0,14.0,16.0,18.0,20.0,
     /25.0,30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,150.,
     /200.,250.,300.,400.,500.,600.,750.,1000.,1500.,2000.,
     /2500.,3000.,4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC1/0.00,.007,.030,.069,.078,.069,.063,.060,.058,.057,
     /.053,.051,.049,.047,.046,.043,.038,.034,.031,.027,
     /.022,.019,.016,.013,.0110,.0095,.0079,.0062,.0044,.0034,
     /.0028,.0024,.0018,.0013,.00098,.00080,.00042,.00023,.00016,.00009/
C
      DATA XEXC2/8.90,9.50,10.0,11.0,12.0,13.0,14.0,16.0,18.0,20.0,
     /25.0,30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,150.,
     /200.,250.,300.,400.,500.,600.,750.,1000.,1500.,2000.,
     /2500.,3000.,4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC2/0.00,.004,.009,.040,.065,.062,.060,.058,.057,.056,
     /.055,.054,.052,.050,.048,.046,.041,.037,.034,.029,
     /.024,.021,.018,.015,.0123,.0106,.0089,.0070,.0050,.0039,
     /.0032,.0027,.0021,.0015,.00116,.00095,.00046,.00027,.00019,.00012/
C
      DATA XEXC3/10.5,12.0,13.0,14.0,15.0,17.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC3/0.00,0.56,0.43,0.34,0.31,0.30,0.30,0.31,0.32,0.33,
     /0.34,0.35,0.36,0.36,0.35,0.34,0.32,0.29,0.26,0.23,
     /.206,.171,.147,.129,.109,.088,.063,.049,.041,.035,
     /.027,.019,.0142,.0114,.0058,.0029,.0020,.0011/
C
      DATA XEXC4/12.2,13.0,14.0,15.0,16.0,17.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC4/0.00,0.23,0.31,0.34,0.38,0.40,0.46,0.54,0.60,0.63,
     /0.65,0.67,0.68,0.67,0.66,0.63,0.60,0.54,0.47,0.41,
     /0.37,0.30,0.26,0.23,.186,.147,.104,.081,.066,.057,
     /.043,.030,.023,.0180,.0093,.0047,.0031,.00182/
C
      DATA XEXC5/13.2,14.0,15.0,16.0,17.0,18.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC5/0.00,0.37,0.48,0.61,0.69,0.76,0.89,1.11,1.24,1.33,
     /1.39,1.45,1.48,1.49,1.48,1.45,1.37,1.27,1.11,1.00,
     /0.91,0.76,0.66,0.58,0.49,0.40,0.30,0.24,0.21,0.17,
     /0.13,.099,.077,.064,.036,.021,.014,.0094/
C
      DATA XEXC6/15.0,16.0,17.0,18.0,19.0,20.0,21.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC6/0.0,.0005,.003,.006,.009,.013,.016,.025,.031,.034,
     /.037,.038,.039,.039,.038,.037,.035,.032,.028,.025,
     /.022,.019,.016,.014,.012,.010,.007,.006,.0049,.0043,
     /.0034,.0025,.0020,.0018,.00098,.0006,.0004,.00027/
C
C DATA FROM RAPP, LINDSAY AND RIEKE ALSO BB THEORY
      DATA XION/13.773,14.5,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,
     /19.0,19.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,26.0,
     /28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,50.0,55.0,
     /60.0,65.0,70.0,75.0,80.0,85.0,90.0,100.,110.,130.,
     /140.,160.,180.,200.,250.,300.,400.,500.,600.,700.,
     /800.,900.,1000.,1400.,2000.,3000.,4000.,5000.,6000.,7000.,
     /8000.,10000.,14000.,20000.,30000.,40000.,60000.,100000./
      DATA YION/0.00,.055,.097,.135,.174,.215,.255,.293,.333,.373,
     /.427,.452,.577,.623,.676,.727,.777,.828,.880,1.12,
     /1.34,1.51,1.65,1.78,1.89,1.99,2.11,2.37,2.59,2.76,
     /2.93,3.07,3.18,3.27,3.35,3.41,3.46,3.52,3.55,3.55,
     /3.52,3.44,3.36,3.26,3.02,2.81,2.42,2.10,1.86,1.69,
     /1.54,1.42,1.32,1.03,.795,.575,.454,.376,.322,.282,
     /.252,.208,.158,.115,.082,.063,.046,.032/
C ---------------------------------------------------------------------
C ---------------------------------------------------------------------
C
      NAME='CO2 (2004 iso.)'
C ---------------------------------------------------------------------
C----------------------------------------------------------------------
C  TEMPERATURE DEPENDENCE OF VIBRATIONAL SCATTERING NOW INCLUDED USING
C  EXTRA ELASTIC X-SECTION FOR ELASTIC SCATTERING FROM VIBRATIONAL BEND
C  MODES.. CF:  FERCH ET AL  PHYS REV. A40 (1989) 5407
C  REPRODUCES DRIFT DIFFUSION DATA OF:
C    ELFORD AND HADDAD   AUST.J.PHYS. 33 (1980) 517
C    HASEGAWA ET AL      J.PHYS. D 29(1996) 2664
C    NAKAMURA            AUST.J.PHYS. 48 (1995) 357
C    ZHAO ET AL          NUCL.INSTR.METH. A340(1994) 485
C----------------------------------------------------------------------
C  ISOTROPIC SCATTERING ONLY IN THIS VERSION
C  IMPROVED EXCITATION X-SECTIONS ALLOW EASIER CALCULATION OF PENNING
C  EFFECTS IN ARGON KRYPTON OR XENON MIXTURES.
C ---------------------------------------------------------------------
      NIN=85
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NEL=65
      NV2=21
      N2V2=23
      NV1=30
      N3V2=15
      NV3=15
      NPD3=20
      NV130=17
      NPD4=18
      NPD5=15
      NPD6=15
      NPD7=15
      NPD8=15
      NPD9=15
      NPDH=13
      NATT=29
      NEXC1=40
      NEXC2=40
      NEXC3=38
      NEXC4=38
      NEXC5=38
      NEXC6=38
      NION=68
      E(1)=0.0
      E(2)=2.0*EMASS/(44.0095*AMU)
      E(3)=13.773
      E(4)=3.85
      E(5)=0.0
      E(6)=0.0
C OPAL AND BEATY IONISATION ENERGY SPLITTING
      EOBY=13.773
C DIPOLE TRANSITION STRENGTH FOR VIBRATIONS V010 AND V001
      AMPV2=0.1703
      AMPV3=0.3922
C-----------------------------------------------------------------------
C  B0 IS ROTATIONAL CONSTANT
C  QBQA IS QUADRUPOLE MOMENT
      B0=4.838D-5
      A0=0.5291772083D-8
      QBQA=3.24
      QBK=1.67552*(QBQA*A0)**2
C-----------------------------------------------------------------------
C CALC FRACTIONAL POPULATION DENSITY OF ROTATIONAL STATES
      PJ(1)=1.0
      DO 3 L=2,31
      J=(2*L)-2
    3 PJ(L)=(2*J+1)*EXP(-J*(J+1)*B0/AKT)
      SUM=0.0
      DO 4 L=1,31
    4 SUM=SUM+PJ(L)
      DO 5 L=1,31
    5 PJ(L)=PJ(L)/SUM
C----------------------------------------------------------------------
C CALC ROTATIONAL TRANSITION ENERGIES
      DO 7 K=1,59,2
      EIN(K)=B0*(4*K+2)
    7 EIN(K+1)=-EIN(K)
      EIN(61)  = -0.08275
      EIN(62)  =  0.08275
      EIN(63)  = -0.15937
      EIN(64)  =  0.15937
      EIN(65)  = -0.17211
      EIN(66)  =  0.17211
      EIN(67)  = -0.251
      EIN(68)  =  0.251
      EIN(69)  = -0.29126
      EIN(70)  =  0.29126
      EIN(71)  =  0.335
      EIN(72)  =  0.422
      EIN(73)  =  0.505
      EIN(74)  =  0.685
      EIN(75)  =  0.825
      EIN(76)  =  0.995
      EIN(77)  =  1.160
      EIN(78)  =  1.320
      EIN(79)  =  2.500
      EIN(80)  =  7.90
      EIN(81)  =  8.90
      EIN(82)  = 10.5
      EIN(83)  = 12.2
      EIN(84)  = 13.2
      EIN(85)  = 15.0
C---------------------------------------------------
C DEGENERACY OF VIBRATIONAL STATES
      DEGV1=1.0
      DEGV2=2.0
      DEGV3=1.0
      DEG2V2=3.0
C 3V2 === SUM (3V2 + V12) =   4+2
      DEG3V2=6.0
C----------------------------------------------------
C CALC POPULATION OF VIBRATIONAL STATES
      SUM=0.0
      APOPV2=DEGV2*EXP(EIN(61)/AKT)
      APOP2V2=DEG2V2*EXP(EIN(63)/AKT)
      APOPV1=DEGV1*EXP(EIN(65)/AKT)
      APOP3V2=DEG3V2*EXP(EIN(67)/AKT)
      APOPV3=DEGV3*EXP(EIN(69)/AKT)
      SUM=1.0+APOPV2+APOP2V2+APOPV1+APOP3V2+APOPV3
      APOPGS=1.0/SUM
      APOPV2=APOPV2/SUM
      APOP2V2=APOP2V2/SUM
      APOPV1=APOPV1/SUM
      APOP3V2=APOP3V2/SUM
      APOPV3=APOPV3/SUM
      APBEND=APOPV2+APOP2V2+APOP3V2
C
C RENORMALISE VIBRATIONAL GROUND STATE POPULATION IN ORDER TO ACCOUNT
C FOR EXCITATION FROM VIBRATIONALLY EXCITED STATES
      APOPGS=1.0
C BEND MODE AND EFFECTIVE GROUND STATE POPULATION AT 293.15 KELVIN
      AEXT20=7.51373753D-2
      AGST20=1.0-AEXT20
C------------------------------------------------------
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ISOTROPIC     CO2   '
      SCRPT(3)=' IONISATION    ELOSS= 13.773  '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT  0-2      ELOSS=  0.00029'
      SCRPT(8)=' ROT  2-0      ELOSS= -0.00029'
      SCRPT(9)=' ROT  2-4      ELOSS=  0.00068'
      SCRPT(10)=' ROT  4-2      ELOSS= -0.00068'
      SCRPT(11)=' ROT  4-6      ELOSS=  0.00106'
      SCRPT(12)=' ROT  6-4      ELOSS= -0.00106'
      SCRPT(13)=' ROT  6-8      ELOSS=  0.00145'
      SCRPT(14)=' ROT  8-6      ELOSS= -0.00145'
      SCRPT(15)=' ROT  8-10     ELOSS=  0.00184'
      SCRPT(16)=' ROT 10-8      ELOSS= -0.00184'
      SCRPT(17)=' ROT 10-12     ELOSS=  0.00223'
      SCRPT(18)=' ROT 12-10     ELOSS= -0.00223'
      SCRPT(19)=' ROT 12-14     ELOSS=  0.00261'
      SCRPT(20)=' ROT 14-12     ELOSS= -0.00261'
      SCRPT(21)=' ROT 14-16     ELOSS=  0.00300'
      SCRPT(22)=' ROT 16-14     ELOSS= -0.00300'
      SCRPT(23)=' ROT 16-18     ELOSS=  0.00339'
      SCRPT(24)=' ROT 18-16     ELOSS= -0.00339'
      SCRPT(25)=' ROT 18-20     ELOSS=  0.00377'
      SCRPT(26)=' ROT 20-18     ELOSS= -0.00377'
      SCRPT(27)=' ROT 20-22     ELOSS=  0.00416'
      SCRPT(28)=' ROT 22-20     ELOSS= -0.00416'
      SCRPT(29)=' ROT 22-24     ELOSS=  0.00455'
      SCRPT(30)=' ROT 24-22     ELOSS= -0.00455'
      SCRPT(31)=' ROT 24-26     ELOSS=  0.00493'
      SCRPT(32)=' ROT 26-24     ELOSS= -0.00493'
      SCRPT(33)=' ROT 26-28     ELOSS=  0.00532'
      SCRPT(34)=' ROT 28-26     ELOSS= -0.00532'
      SCRPT(35)=' ROT 28-30     ELOSS=  0.00571'
      SCRPT(36)=' ROT 30-28     ELOSS= -0.00571'
      SCRPT(37)=' ROT 30-32     ELOSS=  0.00610'
      SCRPT(38)=' ROT 32-30     ELOSS= -0.00610'
      SCRPT(39)=' ROT 32-34     ELOSS=  0.00648'
      SCRPT(40)=' ROT 34-32     ELOSS= -0.00648'
      SCRPT(41)=' ROT 34-36     ELOSS=  0.00687'
      SCRPT(42)=' ROT 36-34     ELOSS= -0.00687'
      SCRPT(43)=' ROT 36-38     ELOSS=  0.00726'
      SCRPT(44)=' ROT 38-36     ELOSS= -0.00726'
      SCRPT(45)=' ROT 38-40     ELOSS=  0.00764'
      SCRPT(46)=' ROT 40-38     ELOSS= -0.00764'
      SCRPT(47)=' ROT 40-42     ELOSS=  0.00803'
      SCRPT(48)=' ROT 42-40     ELOSS= -0.00803'
      SCRPT(49)=' ROT 42-44     ELOSS=  0.00842'
      SCRPT(50)=' ROT 44-42     ELOSS= -0.00842'
      SCRPT(51)=' ROT 44-46     ELOSS=  0.00881'
      SCRPT(52)=' ROT 46-44     ELOSS= -0.00881'
      SCRPT(53)=' ROT 46-48     ELOSS=  0.00919'
      SCRPT(54)=' ROT 48-46     ELOSS= -0.00919'
      SCRPT(55)=' ROT 48-50     ELOSS=  0.00958'
      SCRPT(56)=' ROT 50-48     ELOSS= -0.00958'
      SCRPT(57)=' ROT 50-52     ELOSS=  0.00997'
      SCRPT(58)=' ROT 52-50     ELOSS= -0.00997'
      SCRPT(59)=' ROT 52-54     ELOSS=  0.01035'
      SCRPT(60)=' ROT 54-52     ELOSS= -0.01035'
      SCRPT(61)=' ROT 54-56     ELOSS=  0.01074'
      SCRPT(62)=' ROT 56-54     ELOSS= -0.01074'
      SCRPT(63)=' ROT 56-58     ELOSS=  0.01113'
      SCRPT(64)=' ROT 58-56     ELOSS= -0.01113'
      SCRPT(65)=' ROT 58-60     ELOSS=  0.01151'
      SCRPT(66)=' ROT 60-58     ELOSS= -0.01151'
      SCRPT(67)=' V (010)       ELOSS= -0.08275'
      SCRPT(68)=' V (010)       ELOSS=  0.08275'
      SCRPT(69)=' V (020)       ELOSS= -0.15937'
      SCRPT(70)=' V (020)       ELOSS=  0.15937'
      SCRPT(71)=' V (100)       ELOSS= -0.17211'
      SCRPT(72)=' V (100)       ELOSS=  0.17211'
      SCRPT(73)=' V (030)+(110) ELOSS= -0.251  '
      SCRPT(74)=' V (030)+(110) ELOSS=  0.251  '
      SCRPT(75)=' V (001)       ELOSS= -0.29126'
      SCRPT(76)=' V (001)       ELOSS=  0.29126'
      SCRPT(77)=' V POLYAD 3    ELOSS=  0.335  '
      SCRPT(78)=' V (130)+(210) ELOSS=  0.422  '
      SCRPT(79)=' V POLYAD 4    ELOSS=  0.505  '
      SCRPT(80)=' V POLYAD 5    ELOSS=  0.685  '
      SCRPT(81)=' V POLYAD 6    ELOSS=  0.825  '
      SCRPT(82)=' V POLYAD 7    ELOSS=  0.995  '
      SCRPT(83)=' V POLYAD 8    ELOSS=  1.160  '
      SCRPT(84)=' V POLYAD 9    ELOSS=  1.320  '
      SCRPT(85)=' V POLYAD SUM  ELOSS=  2.500  '
      SCRPT(86)=' EXC           ELOSS=  7.900  '
      SCRPT(87)=' EXC           ELOSS=  8.900  '
      SCRPT(88)=' EXC           ELOSS= 10.500  '
      SCRPT(89)=' EXC           ELOSS= 12.200  '
      SCRPT(90)=' EXC           ELOSS= 13.200  '
      SCRPT(91)=' EXC           ELOSS= 15.000  '
      EN=-ESTEP/2.0D0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
C ELASTIC USE LOG INTERPOLATION
      IF(EN.LE.XEN(1)) THEN
       QMOM=YMOM(1)*1.D-16
       QELA=YEL(1)*1.D-16
       QBMOM=QMOM
       QBELA=QELA
       GO TO 20
      ENDIF
      DO 10 J=2,NEL
      IF(EN.LE.XEN(J)) GO TO 15
   10 CONTINUE
      J=NEL
   15 YXJ=LOG(YMOM(J))
      YXJ1=LOG(YMOM(J-1))
      XNJ=LOG(XEN(J))
      XNJ1=LOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QMOM=EXP(A*LOG(EN)+B)*1.D-16
      YXJ=LOG(YEL(J))
      YXJ1=LOG(YEL(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QELA=EXP(A*LOG(EN)+B)*1.D-16
      YXJ=LOG(YVBMOM(J))
      YXJ1=LOG(YVBMOM(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QBMOM=EXP(A*LOG(EN)+B)*1.D-16
      YXJ=LOG(YVBEL(J))
      YXJ1=LOG(YVBEL(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QBELA=EXP(A*LOG(EN)+B)*1.D-16
   20 CONTINUE
C CALC CHANGE IN ELASTIC CROSS SECTION DUE TO CHANGE IN ELASTIC
C SCATTERING FROM BEND MODES ( CHANGE RELATIVE TO X-SECTION AT 293.15K)
C BEND MODE POPULATION AT 293.15K == AEXT20,GROUND STATE POP. == AGST20
C
      QMOM=(1.0-APBEND)*(QMOM-AEXT20*QBMOM)/AGST20+APBEND*QBMOM
      QELA=(1.0-APBEND)*(QELA-AEXT20*QBELA)/AGST20+APBEND*QBELA
C ISOTROPIC
      Q(2,I)=QMOM
      PEQEL(2,I)=0.5D0
C
C ANISOTROPIC
C     Q(2,I)=QELA
C     PEQEL(2,I)=0.5+(QELA-QMOM)/QELA
C
C IONISATION
      Q(3,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 40
      DO 25 J=2,NION
      IF(EN.LE.XION(J)) GO TO 30
   25 CONTINUE
      J=NION
   30 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=1.0D-16*(A*EN+B)
C ATTACHMENT
   40 Q(4,I)=0.0D0
      IF(EN.LE.E(4)) GO TO 50
      DO 45  J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 46
   45 CONTINUE
      J=NATT
   46 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=1.0D-16*(A*EN+B)
C
   50 Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C ----------------------------------------------------------------------
C  QUADRUPOLE BORN ROTATIONAL STATES (GERJUOY AND STEIN)
C ----------------------------------------------------------------------
C SUPERELASTIC ROTATION
      DO 51 K=2,60,2
      AJ=DBLE(K)
      L=(K/2)+1
   51 QIN(K,I)=PJ(L)*QBK*SQRT(1.0-EIN(K)/EN)*AJ*(AJ-1.0)/((2.0*AJ+1.0)*
     /(2.0*AJ-1.0))
C ROTATION
      DO 52 K=1,59,2
      QIN(K,I)=0.0D0
      IF(EN.LE.EIN(K)) GO TO 52
      AJ=DBLE(K-1)
      L=(K+1)/2
      QIN(K,I)=PJ(L)*QBK*SQRT(1.0-EIN(K)/EN)*(AJ+2.0)*(AJ+1.0)/((2.0*AJ
     /+3.0)*(2.0*AJ+1.0))
   52 CONTINUE
C BORN (1/E) FALL OFF IN ROTATONAL X-SEC ABOVE 6.0 EV
      IF(EN.LT.6.0) GO TO 80
      DO 70 K=1,60
   70 QIN(K,I)=QIN(K,I)*6.0/EN
   80 CONTINUE
C
C  SUPERELASTIC V2  BEND MODE
      QIN(61,I)=0.0D0
      IF(EN.LE.0.0) GO TO 150
      EFAC=SQRT(1.0-(EIN(61)/EN))
      QIN(61,I)=AMPV2*LOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 110 J=2,NV2
      IF((EN+EIN(62)).LE.XV2(J)) GOTO 120
  110 CONTINUE
      J=NV2
  120 A=(YV2(J)-YV2(J-1))/(XV2(J)-XV2(J-1))
      B=(XV2(J-1)*YV2(J)-XV2(J)*YV2(J-1))/(XV2(J-1)-XV2(J))
      QIN(61,I)=QIN(61,I)+(EN+EIN(62))*(A*(EN+EIN(62))+B)/EN
      QIN(61,I)=QIN(61,I)*APOPV2/DEGV2*1.D-16
C V2  BEND MODE
  150 QIN(62,I)=0.0D0
      IF(EN.LE.EIN(62)) GO TO 200
      EFAC=SQRT(1.0-(EIN(62)/EN))
      QIN(62,I)=AMPV2*LOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 160 J=2,NV2
      IF(EN.LE.XV2(J)) GO TO 170
  160 CONTINUE
      J=NV2
  170 A=(YV2(J)-YV2(J-1))/(XV2(J)-XV2(J-1))
      B=(XV2(J-1)*YV2(J)-XV2(J)*YV2(J-1))/(XV2(J-1)-XV2(J))
      QIN(62,I)=QIN(62,I)+(A*EN+B)
      QIN(62,I)=QIN(62,I)*APOPGS*1.D-16
C
C  SUPERELASTIC 2V2 BEND MODE HARMONIC
  200 CONTINUE
      QIN(63,I)=0.0D0
      IF(EN.LE.0.0) GO TO 250
      DO 210 J=2,N2V2
      IF((EN+EIN(64)).LE.X2V2(J)) GOTO 220
  210 CONTINUE
      J=N2V2
  220 A=(Y2V2(J)-Y2V2(J-1))/(X2V2(J)-X2V2(J-1))
      B=(X2V2(J-1)*Y2V2(J)-X2V2(J)*Y2V2(J-1))/(X2V2(J-1)-X2V2(J))
      QIN(63,I)=(EN+EIN(64))*(A*(EN+EIN(64))+B)/EN
      QIN(63,I)=QIN(63,I)*APOP2V2/DEG2V2*1.D-16
C  2V2 BEND MODE HARMONIC
  250 CONTINUE
      QIN(64,I)=0.0D0
      IF(EN.LE.EIN(64)) GO TO 300
      DO 260 J=2,N2V2
      IF(EN.LE.X2V2(J)) GOTO 270
  260 CONTINUE
      J=N2V2
  270 A=(Y2V2(J)-Y2V2(J-1))/(X2V2(J)-X2V2(J-1))
      B=(X2V2(J-1)*Y2V2(J)-X2V2(J)*Y2V2(J-1))/(X2V2(J-1)-X2V2(J))
      QIN(64,I)=(A*EN+B)*APOPGS*1.D-16
C
C SUPERELASTIC V1 SYMMETRIC STRETCH
  300 CONTINUE
      QIN(65,I)=0.0D0
      IF(EN.LE.0.0) GO TO 350
      DO 310 J=2,NV1
      IF((EN+EIN(66)).LE.XV1(J)) GOTO 320
  310 CONTINUE
      J=NV1
  320 A=(YV1(J)-YV1(J-1))/(XV1(J)-XV1(J-1))
      B=(XV1(J-1)*YV1(J)-XV1(J)*YV1(J-1))/(XV1(J-1)-XV1(J))
      QIN(65,I)=(EN+EIN(66))*(A*(EN+EIN(66))+B)/EN
      QIN(65,I)=QIN(65,I)*APOPV1/DEGV1*1.D-16
C V1 SYMMETRIC STRETCH
  350 CONTINUE
      QIN(66,I)=0.0D0
      IF(EN.LE.EIN(66)) GO TO 400
      DO 360 J=2,NV1
      IF(EN.LE.XV1(J)) GOTO 370
  360 CONTINUE
      J=NV1
  370 A=(YV1(J)-YV1(J-1))/(XV1(J)-XV1(J-1))
      B=(XV1(J-1)*YV1(J)-XV1(J)*YV1(J-1))/(XV1(J-1)-XV1(J))
      QIN(66,I)=(A*EN+B)*APOPGS*1.D-16
C
C SUPERELASTIC 3V2 + V12
  400 CONTINUE
      QIN(67,I)=0.0D0
      IF(EN.LE.0.0) GO TO 450
      DO 410 J=2,N3V2
      IF((EN+EIN(68)).LE.X3V2(J)) GOTO 420
  410 CONTINUE
      J=N3V2
  420 A=(Y3V2(J)-Y3V2(J-1))/(X3V2(J)-X3V2(J-1))
      B=(X3V2(J-1)*Y3V2(J)-X3V2(J)*Y3V2(J-1))/(X3V2(J-1)-X3V2(J))
      QIN(67,I)=(EN+EIN(68))*(A*(EN+EIN(68))+B)/EN
      QIN(67,I)=QIN(67,I)*APOP3V2/DEG3V2*1.D-16
C 3V2 + V12
  450 CONTINUE
      QIN(68,I)=0.0D0
      IF(EN.LE.EIN(68)) GO TO 500
      DO 460 J=2,N3V2
      IF(EN.LE.X3V2(J)) GOTO 470
  460 CONTINUE
      J=N3V2
  470 A=(Y3V2(J)-Y3V2(J-1))/(X3V2(J)-X3V2(J-1))
      B=(X3V2(J-1)*Y3V2(J)-X3V2(J)*Y3V2(J-1))/(X3V2(J-1)-X3V2(J))
      QIN(68,I)=(A*EN+B)*APOPGS*1.D-16
C
C  SUPERELASTIC V3 ASYMMETRIC STRETCH
  500 QIN(69,I)=0.0D0
      IF(EN.LE.0.0) GO TO 550
      EFAC=SQRT(1.0-(EIN(69)/EN))
      QIN(69,I)=AMPV3*LOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 510 J=2,NV3
      IF((EN+EIN(70)).LE.XV3(J)) GOTO 520
  510 CONTINUE
      J=NV3
  520 A=(YV3(J)-YV3(J-1))/(XV3(J)-XV3(J-1))
      B=(XV3(J-1)*YV3(J)-XV3(J)*YV3(J-1))/(XV3(J-1)-XV3(J))
      QIN(69,I)=QIN(69,I)+(EN+EIN(70))*(A*(EN+EIN(70))+B)/EN
      QIN(69,I)=QIN(69,I)*APOPV3/DEGV3*1.D-16
C V3  ASYMMETRIC STRETCH
  550 QIN(70,I)=0.0D0
      IF(EN.LE.EIN(70)) GO TO 600
      EFAC=SQRT(1.0-(EIN(70)/EN))
      QIN(70,I)=AMPV3*LOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 560 J=2,NV3
      IF(EN.LE.XV3(J)) GO TO 570
  560 CONTINUE
      J=NV3
  570 A=(YV3(J)-YV3(J-1))/(XV3(J)-XV3(J-1))
      B=(XV3(J-1)*YV3(J)-XV3(J)*YV3(J-1))/(XV3(J-1)-XV3(J))
      QIN(70,I)=QIN(70,I)+(A*EN+B)
      QIN(70,I)=QIN(70,I)*APOPGS*1.D-16
C
C  4V2 + 2V1 + V12V2  POLYAD 3
  600 CONTINUE
      QIN(71,I)=0.0D0
      IF(EN.LE.EIN(71)) GO TO 650
      DO 610 J=2,NPD3
      IF(EN.LE.XVPD3(J)) GOTO 620
  610 CONTINUE
      J=NPD3
  620 A=(YVPD3(J)-YVPD3(J-1))/(XVPD3(J)-XVPD3(J-1))
      B=(XVPD3(J-1)*YVPD3(J)-XVPD3(J)*YVPD3(J-1))/(XVPD3(J-1)-XVPD3(J))
      QIN(71,I)=(A*EN+B)*1.D-16
C
C       3V2V1  + 2V1V2
  650 CONTINUE
      QIN(72,I)=0.0D0
      IF(EN.LE.EIN(72)) GO TO 700
      DO 660 J=2,NV130
      IF(EN.LE.XV130(J)) GOTO 670
  660 CONTINUE
      J=NV130
  670 A=(YV130(J)-YV130(J-1))/(XV130(J)-XV130(J-1))
      B=(XV130(J-1)*YV130(J)-XV130(J)*YV130(J-1))/(XV130(J-1)-XV130(J))
      QIN(72,I)=(A*EN+B)*1.D-16
C
C   POLYAD 4
  700 CONTINUE
      QIN(73,I)=0.0D0
      IF(EN.LE.EIN(73)) GO TO 750
      DO 710 J=2,NPD4
      IF(EN.LE.XVPD4(J)) GOTO 720
  710 CONTINUE
      J=NPD4
  720 A=(YVPD4(J)-YVPD4(J-1))/(XVPD4(J)-XVPD4(J-1))
      B=(XVPD4(J-1)*YVPD4(J)-XVPD4(J)*YVPD4(J-1))/(XVPD4(J-1)-XVPD4(J))
      QIN(73,I)=(A*EN+B)*1.D-16
C
C  PLOYAD 5
  750 CONTINUE
      QIN(74,I)=0.0D0
      IF(EN.LE.EIN(74)) GO TO 800
      DO 760 J=2,NPD5
      IF(EN.LE.XVPD5(J)) GOTO 770
  760 CONTINUE
      J=NPD5
  770 A=(YVPD5(J)-YVPD5(J-1))/(XVPD5(J)-XVPD5(J-1))
      B=(XVPD5(J-1)*YVPD5(J)-XVPD5(J)*YVPD5(J-1))/(XVPD5(J-1)-XVPD5(J))
      QIN(74,I)=(A*EN+B)*1.D-16
C
C   POLYAD 6
  800 CONTINUE
      QIN(75,I)=0.0D0
      IF(EN.LE.EIN(75)) GO TO 850
      DO 810 J=2,NPD6
      IF(EN.LE.XVPD6(J)) GOTO 820
  810 CONTINUE
      J=NPD6
  820 A=(YVPD6(J)-YVPD6(J-1))/(XVPD6(J)-XVPD6(J-1))
      B=(XVPD6(J-1)*YVPD6(J)-XVPD6(J)*YVPD6(J-1))/(XVPD6(J-1)-XVPD6(J))
      QIN(75,I)=(A*EN+B)*1.D-16
C
C   POLYAD 7
  850 CONTINUE
      QIN(76,I)=0.0D0
      IF(EN.LE.EIN(76)) GO TO 900
      DO 860 J=2,NPD7
      IF(EN.LE.XVPD7(J)) GOTO 870
  860 CONTINUE
      J=NPD7
  870 A=(YVPD7(J)-YVPD7(J-1))/(XVPD7(J)-XVPD7(J-1))
      B=(XVPD7(J-1)*YVPD7(J)-XVPD7(J)*YVPD7(J-1))/(XVPD7(J-1)-XVPD7(J))
      QIN(76,I)=(A*EN+B)*1.D-16
C
C   POLYAD 8
  900 CONTINUE
      QIN(77,I)=0.0D0
      IF(EN.LE.EIN(77)) GO TO 950
      DO 910 J=2,NPD8
      IF(EN.LE.XVPD8(J)) GOTO 920
  910 CONTINUE
      J=NPD8
  920 A=(YVPD8(J)-YVPD8(J-1))/(XVPD8(J)-XVPD8(J-1))
      B=(XVPD8(J-1)*YVPD8(J)-XVPD8(J)*YVPD8(J-1))/(XVPD8(J-1)-XVPD8(J))
      QIN(77,I)=(A*EN+B)*1.D-16
C
C   POLYAD 9
  950 CONTINUE
      QIN(78,I)=0.0D0
      IF(EN.LE.EIN(78)) GO TO 1000
      DO 960 J=2,NPD9
      IF(EN.LE.XVPD9(J)) GOTO 970
  960 CONTINUE
      J=NPD9
  970 A=(YVPD9(J)-YVPD9(J-1))/(XVPD9(J)-XVPD9(J-1))
      B=(XVPD9(J-1)*YVPD9(J)-XVPD9(J)*YVPD9(J-1))/(XVPD9(J-1)-XVPD9(J))
      QIN(78,I)=(A*EN+B)*1.D-16
C
C   SUM OF HIGHER POLYADS
 1000 CONTINUE
      QIN(79,I)=0.0D0
      IF(EN.LE.EIN(79)) GO TO 1050
      DO 1010 J=2,NPDH
      IF(EN.LE.XVPDH(J)) GOTO 1020
 1010 CONTINUE
      J=NPDH
 1020 A=(YVPDH(J)-YVPDH(J-1))/(XVPDH(J)-XVPDH(J-1))
      B=(XVPDH(J-1)*YVPDH(J)-XVPDH(J)*YVPDH(J-1))/(XVPDH(J-1)-XVPDH(J))
      QIN(79,I)=(A*EN+B)*1.D-16
C
 1050 CONTINUE
      QIN(80,I)=0.0D0
      IF(EN.LE.EIN(80)) GO TO 1100
      DO 1060 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GOTO 1070
 1060 CONTINUE
      J=NEXC1
 1070 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(80,I)=(A*EN+B)*1.D-16

 1100 CONTINUE
      QIN(81,I)=0.0D0
      IF(EN.LE.EIN(81)) GO TO 1150
      DO 1110 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GOTO 1120
 1110 CONTINUE
      J=NEXC2
 1120 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(81,I)=(A*EN+B)*1.D-16
C
 1150 CONTINUE
      QIN(82,I)=0.0D0
      IF(EN.LE.EIN(82)) GO TO 1200
      DO 1160  J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GOTO 1170
 1160 CONTINUE
      J=NEXC3
 1170 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(82,I)=(A*EN+B)*1.D-16
C
 1200 CONTINUE
      QIN(83,I)=0.0D0
      IF(EN.LE.EIN(83)) GO TO 1250
      DO 1210 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GOTO 1220
 1210 CONTINUE
      J=NEXC4
 1220 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(83,I)=(A*EN+B)*1.D-16
C
 1250 CONTINUE
      QIN(84,I)=0.0D0
      IF(EN.LE.EIN(84)) GO TO 1300
      DO 1260  J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GOTO 1270
 1260 CONTINUE
      J=NEXC5
 1270 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(84,I)=(A*EN+B)*1.D-16
C
 1300 CONTINUE
      QIN(85,I)=0.0D0
      IF(EN.LE.EIN(85)) GO TO 1400
      DO 1310  J=2,NEXC6
      IF(EN.LE.XEXC6(J)) GOTO 1320
 1310 CONTINUE
      J=NEXC6
 1320 A=(YEXC6(J)-YEXC6(J-1))/(XEXC6(J)-XEXC6(J-1))
      B=(XEXC6(J-1)*YEXC6(J)-XEXC6(J)*YEXC6(J-1))/(XEXC6(J-1)-XEXC6(J))
      QIN(85,I)=(A*EN+B)*1.D-16
C
 1400 CONTINUE
C SUM ROTATION
      SUMR=0.0
      DO 1450 K=1,60
      SUMR=SUMR+QIN(K,I)
 1450 CONTINUE
C SUM VIBRATION
      SUMV=0.0
      DO 1455 K=61,79
      SUMV=SUMV+QIN(K,I)
 1455 CONTINUE
C SUM EXCITATION
      SUME=0.0
      DO 1460 K=80,85
      SUME=SUME+QIN(K,I)
 1460 CONTINUE
C GET CORRECT ELASTIC X-SECTION
      Q(2,I)=Q(2,I)-SUMR
C Q(1,I) TOTAL USED FOR INFORMATION ONLY
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+SUMR+SUMV+SUME
 9000 CONTINUE
C
C     SAVE ON COMPUTING TIME
C
      DO 2000 K=1,15
      J=86-K
      IF(EFINAL.LE.EIN(J)) NIN=J-1
 2000 CONTINUE
C
      END
