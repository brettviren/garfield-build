CDECK  ID>, GAS57.
      SUBROUTINE GAS57(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(61),YXSEC(61),XION(46),YION(46),XATT(16),YATT(16),
     /XVIB1(34),YVIB1(34),XVIB2(28),YVIB2(28),XVIB3(28),YVIB3(28),
     /XVIB4(25),YVIB4(25),XVIB5(19),YVIB5(19),XEXC1(25),YEXC1(25),
     /XEXC2(23),YEXC2(23),XEXC3(19),YEXC3(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,.002,.003,.004,.005,.007,0.01,.015,0.02,
     /0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.11,0.12,
     /0.14,0.16,0.18,0.20,0.23,0.26,0.30,0.35,0.40,0.50,
     /0.60,0.80,1.00,1.40,2.00,3.00,4.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,15.0,20.0,30.0,40.0,70.0,100.,140.,
     /200.,250.,300.,500.,1000.,1500.,3000.,6000.,10000.,20000.,
     /100000./
      DATA YXSEC/77.0,75.0,70.0,66.0,62.0,57.0,51.0,45.0,37.0,31.0,
     /24.0,18.5,15.5,13.0,11.0,9.45,8.25,7.35,6.75,6.75,
     /8.20,10.6,13.7,17.2,20.5,23.0,25.0,26.5,27.0,28.0,
     /29.0,30.0,31.0,32.5,34.0,36.0,38.0,40.0,43.0,44.0,
     /44.0,42.0,39.0,28.0,22.0,15.0,11.5,6.80,4.90,2.90,
     /1.78,1.28,1.06,0.60,0.26,0.17,0.08,.034,.021,.0085,
     /.0017/
      DATA XION/10.35,11.0,12.5,13.5,14.5,17.0,20.0,25.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,
     /175.,200.,250.,300.,350.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,
     /7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.33,0.75,1.22,1.82,3.69,5.29,8.33,10.3,11.8,
     /12.8,13.7,14.8,15.6,16.1,16.4,16.4,16.4,15.9,15.0,
     /14.1,13.4,12.4,10.9,9.99,9.24,8.41,7.88,6.92,6.38,
     /5.87,5.23,4.88,4.22,3.63,3.30,3.00,2.60,2.23,1.48,
     /1.11,0.81,0.58,0.31,.167,.106/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,1.41,2.36,3.57,6.03,9.50,14.3,22.3,31.6,26.6,
     /20.9,13.4,7.55,2.83,1.07,0.00/
      DATA XVIB1/.052,.055,.060,.065,.070,.075,0.08,0.10,0.12,0.14,
     /0.20,0.25,0.30,0.40,0.50,0.70,1.00,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,40.0,
     /100.,1000.,10000.,100000./
      DATA YVIB1/0.00,.017,.026,.030,.032,.033,.034,.034,.033,.031,
     /.026,.022,.020,.017,.015,.011,.010,.015,.018,.030,
     /.044,.058,.074,.097,.097,.080,.055,.031,.017,.010,
     /.003,.0003,.00003,.00003/
      DATA XVIB2/.108,.125,0.15,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,0.33,0.64,0.87,0.90,0.90,0.81,0.69,0.60,0.50,
     /0.39,0.39,0.48,0.77,1.14,1.50,1.93,2.53,2.53,2.08,
     /1.44,0.81,0.43,0.27,0.06,.006,.0006,.00006/
      DATA XVIB3/.173,0.18,0.19,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,0.16,0.33,0.47,0.60,0.65,0.69,0.65,0.60,0.52,
     /0.42,0.38,0.41,0.59,0.89,1.16,1.49,1.96,1.96,1.60,
     /1.11,0.63,0.33,0.21,0.05,.005,.0005,.00005/
      DATA XVIB4/.363,0.40,0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,
     /3.00,4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,
     /40.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,0.58,0.77,0.86,0.91,0.91,0.86,0.81,0.77,0.85,
     /1.23,1.76,2.29,2.95,3.26,2.82,2.08,1.19,0.53,0.30,
     /0.17,0.04,.004,.0004,.00004/
      DATA XVIB5/.519,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB5/0.00,.001,0.01,.041,.105,0.20,0.25,0.33,0.37,0.31,
     /.237,.138,.058,.033,.021,.004,.0004,.00004,.000004/
      DATA XEXC1/7.20,8.50,9.50,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,1.60,2.32,2.48,2.56,2.64,2.64,2.64,2.64,2.64,
     /2.72,2.72,2.64,2.48,2.08,1.92,1.60,1.50,1.28,0.84,
     /0.41,0.21,0.07,.042,.009/
      DATA XEXC2/9.50,10.5,11.5,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.23,0.49,0.92,1.43,1.92,2.24,2.44,
     /2.65,2.72,2.65,2.48,2.08,1.92,1.60,1.50,1.28,0.84,
     /0.39,0.21,0.07,.042,.007/
      DATA XEXC3/17.0,20.0,25.0,30.0,40.0,60.0,80.0,100.,150.,200.,
     /300.,400.,600.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YEXC3/0.00,0.53,1.16,1.60,2.24,2.64,2.64,2.48,2.08,1.92,
     /1.60,1.50,1.28,0.84,0.41,0.21,0.09,.042,.007/
C ----------------------------------------------------------------------
C  NO DIFFUSION EXPERIMENTAL DATA AVAILABLE,USED INELASTICS FROM SCALING
C  ISOBUTANE INELASTIC X-SECT. ELASTIC DETERMINED FROM DRIFT VELOCITY.
C HENCE DIFFUSION ACCURATE TO ONLY 10% , DRIFT VELOCITY TO 3% BELOW
C 10KV/CM.
C MODIFICATION OF NEO-PENTANE (1995) TO INCLUDE SUPERELASTIC SCATTERING
C FIT TO DRIFT VELOCITY OF FLORIANO GEE AND FREEMAN
C ----------------------------------------------------------------------
C
      NAME='n-C5H12 (2003)'
C
      NIN=11
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=61
      NION=46
      NATT=16
      NVIB1=34
      NVIB2=28
      NVIB3=28
      NVIB4=25
      NVIB5=19
      NEXC1=25
      NEXC2=23
      NEXC3=19
      E(1)=0.0
      E(2)=2.0*EMASS/(72.1503*AMU)
      E(3)=10.35
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.35
      EIN(1)=-.052
      EIN(2)=0.052
      EIN(3)=-.108
      EIN(4)=0.108
      EIN(5)=-.173
      EIN(6)=0.173
      EIN(7)=0.363
      EIN(8)=0.519
      EIN(9)=7.2
      EIN(10)=9.50
      EIN(11)=17.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       N-PENTANE      '
      SCRPT(3)=' IONISATION    ELOSS= 10.35   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS= -0.052  '
      SCRPT(8)=' VIB           ELOSS=  0.052  '
      SCRPT(9)=' VIB           ELOSS= -0.108  '
      SCRPT(10)=' VIB           ELOSS=  0.108  '
      SCRPT(11)=' VIB           ELOSS= -0.173  '
      SCRPT(12)=' VIB           ELOSS=  0.173  '
      SCRPT(13)=' VIB           ELOSS=  0.363  '
      SCRPT(14)=' VIB           ELOSS=  0.519  '
      SCRPT(15)=' EXC           ELOSS=  7.20   '
      SCRPT(16)=' EXC           ELOSS=  9.50   '
      SCRPT(17)=' EXC           ELOSS= 17.0    '
      APOP1=EXP(EIN(1)/AKT)
      APOP2=EXP(EIN(3)/AKT)
      APOP3=EXP(EIN(5)/AKT)
      EN=-ESTEP/2.0D0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.LE.XEN(2)) THEN
       Q(2,I)=YXSEC(2)*1.D-16
       GO TO 21
      ENDIF
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 YXJ=LOG(YXSEC(J))
      YXJ1=LOG(YXSEC(J-1))
      XNJ=LOG(XEN(J))
      XNJ1=LOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      Q(2,I)=EXP(A*LOG(EN)+B)*1.D-16
   21 CONTINUE
      Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 30
      DO 22 J=2,NION
      IF(EN.LE.XION(J)) GO TO 23
   22 CONTINUE
      J=NION
   23 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
   30 Q(4,I)=0.0D0
      IF(EN.LT.XATT(1)) GO TO 40
      IF(EN.GT.XATT(NATT)) GO TO 40
      DO 31 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 32
   31 CONTINUE
      J=NATT
   32 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
   40 Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C
C SUPERELASTIC VIB1
      QIN(1,I)=0.0D0
      IF(EN.LE.0.0) GO TO 150
      DO 110 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 120
  110 CONTINUE
      J=NVIB1
  120 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  VIB1
  150 QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 200
      DO 160  J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 170
  160 CONTINUE
      J=NVIB1
  170 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)/(1.0+APOP1)*1.D-16
  200 CONTINUE
C
C SUPERELASTIC VIB2
      QIN(3,I)=0.0D0
      IF(EN.LE.0.0) GO TO 250
      DO 210 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 220
  210 CONTINUE
      J=NVIB2
  220 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP2/(1.0+APOP2)*1.D-16
C  VIB2
  250 QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 300
      DO 260 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 270
  260 CONTINUE
      J=NVIB2
  270 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=(A*EN+B)/(1.0+APOP2)*1.D-16
  300 CONTINUE
C
C SUPERELASTIC VIB3
      QIN(5,I)=0.0D0
      IF(EN.LE.0.0) GO TO 350
      DO 310 J=2,NVIB3
      IF((EN+EIN(6)).LE.XVIB3(J)) GO TO 320
  310 CONTINUE
      J=NVIB3
  320 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(5,I)=(EN+EIN(6))*(A*(EN+EIN(6))+B)/EN
      QIN(5,I)=QIN(5,I)*APOP3/(1.0+APOP3)*1.D-16
C  VIB3
  350 QIN(6,I)=0.0D0
      IF(EN.LE.EIN(6)) GO TO 400
      DO 360 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 370
  360 CONTINUE
      J=NVIB3
  370 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(6,I)=(A*EN+B)/(1.0+APOP3)*1.D-16
  400 CONTINUE
C VIB4
      QIN(7,I)=0.0D0
      IF(EN.LE.EIN(7)) GO TO 500
      DO 410 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 420
  410 CONTINUE
      J=NVIB4
  420 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C VIB5
      QIN(8,I)=0.0D0
      IF(EN.LE.EIN(8)) GO TO 600
      DO 510 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 520
  510 CONTINUE
      J=NVIB5
  520 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C EXC1
      QIN(9,I)=0.0D0
      IF(EN.LE.EIN(9)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C EXC2
      QIN(10,I)=0.0D0
      IF(EN.LE.EIN(10)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C EXC3
      QIN(11,I)=0.0D0
      IF(EN.LE.EIN(11)) GO TO 900
      DO 810 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 820
  810 CONTINUE
      J=NEXC3
  820 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(11,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      END
