CDECK  ID>, GAS1.
      SUBROUTINE GAS1(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(72),YXSEC(72),XVIB2(14),YVIB2(14),
     /XVIB3(14),YVIB3(14),XVIB4(14),YVIB4(14),XVIB5(16),YVIB5(16),
     /XVIB6(16),YVIB6(16),XEXC(33),YEXC(33),XION(52),YION(52),
     /XATT(11),YATT(11)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.0,.001,.002,.003,.004,.005,.006,.007,.008,.009,
     /0.01,.012,.014,.016,.018,0.02,.025,0.03,.035,0.04,
     /.045,0.05,.055,0.06,.065,0.07,.075,0.08,.085,0.09,
     /0.10,0.12,0.14,0.17,0.20,0.24,0.30,0.40,0.50,0.60,
     /0.80,1.00,1.20,1.40,1.70,2.00,3.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,15.0,20.0,30.0,35.0,50.0,60.0,75.0,
     /100.,150.,200.,300.,500.,700.,1000.,2000.,4000.,10000.,
     /20000.,100000./
C
      DATA YXSEC/13.5,9.50,7.80,6.90,6.20,5.80,5.45,5.20,4.85,4.65,
     /4.40,4.00,3.70,3.50,3.30,3.10,2.60,2.25,1.90,1.65,
     /1.45,1.27,1.10,0.98,0.87,0.75,0.66,0.55,0.49,0.41,
     /0.29,0.17,0.14,0.16,0.20,0.30,0.48,0.90,1.40,2.00,
     /3.70,4.70,5.60,6.00,6.30,6.50,6.80,6.90,7.00,7.20,
     /7.30,7.50,7.85,9.20,9.20,8.80,8.40,6.72,5.90,5.28,
     /4.16,2.99,1.92,1.13,0.63,0.42,0.27,0.12,0.06,0.02,
     /0.01,.002/
C  VIBRATION V4 (RESONANCE ONLY)
      DATA XVIB2/0.0784,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,50.0,
     /100.,1000.,10000.,100000./
      DATA YVIB2/0.0,0.0,0.11,0.93,1.40,1.20,0.80,0.07,.022,.0001,
     /.00001,.000001,.0000001,.00000001/
C  VIBRATION V1 (RESONANCE ONLY)
      DATA XVIB3/0.1126,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,50.0,
     /100.,1000.,10000.,100000./
      DATA YVIB3/0.0,0.0,.037,0.31,0.47,0.40,0.27,.023,.007,.00003,
     /.000003,.0000003,.00000003,.000000003/
C  VIBRATION V3 (RESONANCE ONLY)
      DATA XVIB4/0.1589,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,50.0,
     /100.,1000.,10000.,100000./
      DATA YVIB4/0.0,0.0,0.33,2.80,4.20,3.60,2.33,0.20,.067,.0001,
     /.00001,.000001,.0000001,.00000001/
C  VIBRATION HARMONIC 2(V3)
      DATA XVIB5/0.3178,1.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,
     /20.0,50.0,100.0,1000.,10000.,100000./
      DATA YVIB5/0.0,.001,0.01,0.04,0.06,0.47,0.70,0.60,0.40,.033,
     /.011,.0005,.00001,.000001,.0000001,.00000001/
C VIBRATION HARMONIC (3(V3) + ALL OTHER HARMONICS)
      DATA XVIB6/0.4767,1.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,
     /20.0,50.0,100.,1000.,10000.,100000./
      DATA YVIB6/0.0,.001,0.08,0.16,0.24,1.84,2.80,2.40,1.60,.128,
     /.040,.0008,.00008,.000008,.0000008,.00000008/
      DATA XION/15.9,16.0,17.0,18.0,19.0,20.0,22.0,24.0,26.0,28.0,
     /30.0,32.0,34.0,36.0,38.0,40.0,42.0,44.0,46.0,48.0,
     /50.0,60.0,70.0,80.0,90.0,100.,125.,150.,175.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,10000.,20000.,
     /40000.,100000./
      DATA YION/0.0,.034,.080,.137,.204,.295,.479,.656,.937,1.19,
     /1.41,1.62,1.83,2.03,2.18,2.38,2.60,2.78,2.98,3.25,
     /3.41,3.97,4.39,4.76,4.91,5.12,5.31,5.28,5.31,5.10,
     /4.78,4.59,4.31,4.05,3.83,3.51,3.11,2.83,2.61,2.38,
     /2.23,1.89,1.64,1.50,1.34,1.15,0.99,0.70,0.44,.256,
     /.141,.072/
      DATA XATT/4.00,4.10,5.00,6.00,7.00,8.00,9.00,10.0,11.0,
     /12.0,100./
      DATA YATT/.0,.00001,.00092,.0066,.0135,.0142,.0051,.0010,.0004,
     /.00001,.0000001/
C  DISOCIATION X-SECTION EXCLUDING DISOCIATIVE IONISATION X-SECTION
      DATA XEXC/12.5,13.0,14.0,15.0,16.0,18.0,20.0,25.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,100.,120.,140.,160.,
     /180.,200.,250.,300.,400.,500.,600.,1000.,2000.,4000.,
     /10000.,20000.,100000./
      DATA YEXC/0.0,.036,.156,.288,0.43,0.67,0.84,1.15,1.32,1.44,
     /1.53,1.56,1.60,1.62,1.63,1.63,1.62,1.60,1.58,1.55,
     /1.52,1.48,1.40,1.30,1.12,0.94,0.82,0.54,0.32,0.18,
     /0.09,0.05,.013/
C ----------------------------------------------------------------
C    NEW ANALYSIS UPDATED TO MARCH  2001
C    ALLOWS SUPERELASTIC SCATTERING TO V4 VIBRATIONAL LEVEL
C    BORN ANGULAR DISTRIBUTION FOR  V4 LEVEL
C    INCLUDED NEW IONISATION X-SECTIONS BY NISHIMURA AND READJUSTED
C    DISOCIATION X-SECTION TO FIT TOWNSEND MEASUREMENTS.
C ---------------------------------------------------------------
      NAME='CF4 (2001)'
      FAC1=1.00
      FAC2=0.71
      NIN=7
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C ANGULAR DISTRIBUTION FOR LEVEL 2 AND 4
      KIN(2)=1
      KIN(4)=1
C
      NDATA=72
      NVIB2=14
      NVIB3=14
      NVIB4=14
      NVIB5=16
      NVIB6=16
      NION=52
      NATT=11
      NEXC=33
      E(1)=0.0
      E(2)=2.0*EMASS/(88.0046*AMU)
      E(3)=15.90
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
C SET OPAL BEATY ENERGY SPLITTING TO EION
      EOBY=E(3)
      EIN(1)=-0.0784
      EIN(2)=0.0784
      EIN(3)=0.1126
      EIN(4)=0.1589
      EIN(5)=0.3178
      EIN(6)=0.4767
      EIN(7)=12.5
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       CF4            '
      SCRPT(3)=' IONISATION    ELOSS= 15.90   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB  V4       ELOSS= -0.0784 '
      SCRPT(8)=' VIB  V4 ANIS  ELOSS=  0.0784 '
      SCRPT(9)=' VIB  V1       ELOSS=  0.1126 '
      SCRPT(10)=' VIB  V3 ANIS  ELOSS=  0.1589 '
      SCRPT(11)=' VIB 2V3       ELOSS=  0.3178 '
      SCRPT(12)=' VIB HARMONIC  ELOSS=  0.4767 '
      SCRPT(13)=' EXC DISOCIATN ELOSS= 12.5    '
      APOP=EXP(EIN(1)/AKT)
      EN=-ESTEP/2.0D0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
      Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0D0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C
C SUPERELASTIC OF VIBRATION V4
C
      QIN(1,I)=0.0D0
      IF(EN.EQ.0.0D0) GO TO 305
      EFAC=SQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.0768*LOG((EFAC+1.0D0)/(EFAC-1.0D0))/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0D0+APOP)*1.D-16
C
  305 CONTINUE
      QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 400
      DO 310 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 320
  310 CONTINUE
      J=NVIB2
  320 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      EFAC=SQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.0768*LOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=((A*EN+B)+QIN(2,I))*1.0/(1.0+APOP)*1.D-16
      PEQIN(2,I)=0.5+(QIN(2,I)-FAC1*QIN(2,I))/QIN(2,I)
  400 CONTINUE
C
      QIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 500
      DO 410 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 420
  410 CONTINUE
      J=NVIB3
  420 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      EFAC=SQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.0224*LOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(3,I)=((A*EN+B)+QIN(3,I))*1.D-16
  500 CONTINUE
C
      QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 600
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      EFAC=SQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=1.584*LOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(4)
      FWD=LOG((EN+ELF)/(EN+ELF-2.0*SQRT(EN*ELF)))
      BCK=LOG((EN+ELF+2.0*SQRT(EN*ELF))/(EN+ELF))
C   ASSUME RATIO MOM T./ TOT X-SECT FOR RESONANCE PART = RAT4
      RAT4=0.58
      XMT=((1.5-FWD/(FWD+BCK))*QIN(4,I)+RAT4*(A*EN+B))*1.0D-16
      QIN(4,I)=((A*EN+B)+QIN(4,I))*1.D-16
      PEQIN(4,I)=0.5+(QIN(4,I)-XMT)/QIN(4,I)
  600 CONTINUE
C
      QIN(5,I)=0.0D0
      IF(EN.LE.EIN(5)) GO TO 700
      DO 610 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 620
  610 CONTINUE
      J=NVIB5
  620 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(6,I)=0.0D0
      IF(EN.LE.EIN(6)) GO TO 800
      DO 710 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 720
  710 CONTINUE
      J=NVIB6
  720 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(7,I)=0.0D0
      IF(EN.LE.EIN(7)) GO TO 900
      DO 810 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 820
  810 CONTINUE
      J=NEXC
  820 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      END
