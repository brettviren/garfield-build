CDECK  ID>, GAS25.
      SUBROUTINE GAS25(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(54),YXSEC(54),XION(29),YION(29),XATT(16),YATT(16),
     /XVIB3(19),YVIB3(19),XVIB4(28),YVIB4(28),XVIB5(25),YVIB5(25),
     /XVIB6(19),YVIB6(19),XEXC(27),YEXC(27),XEXC1(35),YEXC1(35)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.004,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.11,0.12,0.13,0.14,0.16,0.18,0.20,0.24,
     /0.30,0.40,0.50,0.60,0.80,1.00,1.40,2.00,3.00,4.00,
     /5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,30.0,40.0,
     /70.0,100.,140.,200.,250.,300.,500.,1000.,1500.,3000.,
     /6000.,10000.,20000.,100000./
      DATA YXSEC/235.,235.,235.,233.,225.,215.,205.,190.,175.,160.,
     /140.,125.,110.,95.0,80.0,74.0,62.0,51.0,43.0,34.0,
     /25.0,20.0,18.0,16.5,15.7,15.0,14.5,15.0,17.5,20.0,
     /22.0,23.5,24.0,24.5,24.0,22.0,15.0,11.5,8.00,6.20,
     /3.50,2.60,1.50,0.95,0.70,0.55,0.30,0.14,0.09,0.04,
     /0.02,.012,.005,.001/
      DATA XION/10.04,10.9,13.4,18.4,19.4,20.4,23.4,28.4,33.4,38.4,
     /43.4,48.4,53.4,58.4,68.4,78.4,88.4,98.4,120.,140.,
     /200.,300.,500.,700.,1000.,2000.,4000.,10000.,100000./
      DATA YION/0.00,0.12,1.12,2.92,3.37,3.70,4.44,5.48,6.17,6.68,
     /7.13,7.41,7.52,7.66,7.84,7.89,7.84,7.75,7.53,7.20,
     /6.17,4.76,3.30,2.45,1.95,1.15,0.70,0.36,.06/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,0.67,1.10,1.65,2.80,4.40,6.60,10.3,14.7,12.3,
     /9.70,6.20,3.50,1.30,0.50,0.00/
C V2 AND V3 DIPOLE PARTS GIVEN ANALYTICALLY
C NB V3 TABLE CONTAINS ONLY RESONANCE PART OF X-SECT.
      DATA XVIB3/.137,1.00,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,14.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,0.01,0.45,0.75,1.00,1.15,1.20,1.15,1.00,0.90,
     /0.80,0.50,0.35,0.21,0.16,0.05,.005,.0005,.00005/
      DATA XVIB4/.180,0.19,0.20,0.23,0.25,0.30,0.35,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,0.17,0.22,0.30,0.32,0.34,0.34,0.32,0.31,0.25,
     /0.21,0.19,0.19,0.32,0.47,0.61,0.79,1.03,1.03,0.85,
     /0.58,0.33,0.18,0.11,0.03,.003,.0003,.00003/
      DATA XVIB5/.349,0.40,0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,
     /3.00,4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,
     /40.0,100.,1000.,10000.,100000./
      DATA YVIB5/0.00,0.35,0.43,0.47,0.48,0.48,0.46,0.43,0.43,0.47,
     /0.69,1.00,1.30,1.75,1.90,1.60,1.20,0.72,0.30,0.17,
     /0.10,0.02,.002,.0002,.00002/
      DATA XVIB6/.529,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB6/0.00,.001,0.01,.016,.035,0.06,0.09,0.12,0.13,0.11,
     /0.08,.045,0.02,0.01,.007,.0016,.00016,.000016,.0000016/
      DATA XEXC/7.70,8.50,9.00,9.50,10.5,11.5,13.0,15.0,20.0,25.0,
     /30.0,40.0,50.0,60.0,70.0,80.0,100.,150.,200.,300.,
     /400.,600.,1000.,2000.,4000.,10000.,100000./
      DATA YEXC/0.00,0.11,0.38,0.71,1.26,1.76,2.03,2.36,2.80,3.03,
     /3.08,3.19,3.25,3.25,3.20,3.10,2.81,1.93,1.49,1.10,
     /0.88,0.66,0.44,0.28,.160,.083,.0150/
      DATA XEXC1/8.50,8.70,9.30,9.85,10.3,10.8,11.3,12.3,13.3,14.3,
     /15.3,17.3,20.0,22.0,25.0,30.0,35.0,40.0,45.0,50.0,
     /60.0,70.0,80.0,100.,150.,200.,300.,400.,500.,600.,
     /1000.,2000.,4000.,10000.,100000./
      DATA YEXC1/0.00,0.077,0.16,0.23,0.29,0.34,0.42,0.64,0.97,1.43,
     /1.99,2.91,3.79,4.07,4.73,5.50,5.94,6.16,6.44,6.60,
     /6.82,6.82,6.77,6.44,4.79,3.91,2.86,2.20,1.87,1.65,
     /1.16,0.68,0.40,0.20,.038/
      NAME='DME (1998)'
C ---------------------------------------------------------------------
C UPDATES DME97 WITH MONTE CARLO SIMULATION OF STEADY STATE TOWNSEND
C  VALUE FOR ALPHA.
C UPDATES DME94 WITH CORRECT VIBRATIONAL ANALYSIS FROM SVERDLOV.
C UPDATES DME92 WITH BETTER FIT TO FANO AND EV/ION PAIR
C ---------------------------------------------------------------------
      AVIB1=0.06
      AVIB2=0.35
      NIN=8
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=54
      NVIB3=19
      NVIB4=28
      NVIB5=25
      NVIB6=19
      NION=29
      NATT=16
      NEXC=27
      NEXC1=35
      E(1)=0.0
      E(2)=2.0*EMASS/(46.06904*AMU)
      E(3)=10.04
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.04
      EIN(1)=-0.051
      EIN(2)=0.051
      EIN(3)=0.137
      EIN(4)=0.180
      EIN(5)=0.349
      EIN(6)=0.529
      EIN(7)=7.70
      EIN(8)=8.5
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DME            '
      SCRPT(3)=' IONISATION    ELOSS= 10.04   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS= -0.051  '
      SCRPT(8)=' VIB           ELOSS=  0.051  '
      SCRPT(9)=' VIB           ELOSS=  0.137  '
      SCRPT(10)=' VIB           ELOSS=  0.180  '
      SCRPT(11)=' VIB           ELOSS=  0.349  '
      SCRPT(12)=' VIB           ELOSS=  0.529  '
      SCRPT(13)=' EXC           ELOSS=  7.70   '
      SCRPT(14)=' EXC           ELOSS=  8.50   '
      APOP=EXP(EIN(1)/AKT)
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
      Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0D0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
  300 Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C
C SUPERELASTIC OF VIBRATION
C
      QIN(1,I)=0.0D0
      IF(EN.EQ.0.0) GO TO 390
      EFAC=SQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=AVIB1*LOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0+APOP)*1.D-16
C
  390 QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 400
      EFAC=SQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=AVIB1*LOG((1.0+EFAC)/(1.0-EFAC))/(EN*(1.0+APOP))*1.D-16
  400 CONTINUE
      QIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 430
      DO 410 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 420
  410 CONTINUE
      J=NVIB3
  420 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(3,I)=(A*EN+B)
      EFAC=SQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=(QIN(3,I)+AVIB2*LOG((1.0+EFAC)/(1.0-EFAC))/EN)*1.D-16
  430 CONTINUE
      QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 500
      DO 440 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 450
  440 CONTINUE
      J=NVIB4
  450 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  500 CONTINUE
      QIN(5,I)=0.0D0
      IF(EN.LE.EIN(5)) GO TO 600
      DO 540 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 550
  540 CONTINUE
      J=NVIB5
  550 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  600 CONTINUE
      QIN(6,I)=0.0D0
      IF(EN.LE.EIN(6)) GO TO 700
      DO 640 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 650
  640 CONTINUE
      J=NVIB6
  650 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  700 CONTINUE
      QIN(7,I)=0.0D0
      IF(EN.LE.EIN(7)) GO TO 800
      DO 710 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 720
  710 CONTINUE
      J=NEXC
  720 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  800 CONTINUE
      QIN(8,I)=0.0D0
      IF(EN.LE.EIN(8)) GO TO 899
      DO 810 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 820
  810 CONTINUE
      J=NEXC1
  820 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  899 CONTINUE
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      END
