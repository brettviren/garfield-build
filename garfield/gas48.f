CDECK  ID>, GAS48.
      SUBROUTINE GAS48(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(83),YXSEC(83),XION(71),YION(71),
     /XEXC1(95),YEXC1(95),XEXC2(76),YEXC2(76),
     /XEXC3(71),YEXC3(71),XEXC4(63),YEXC4(63),XEL(95),YEL(95)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC MOMENTUM TRANSFER
      DATA XEN/1.D-6,.001,.003,.005,.007,0.01,.015,0.02,0.03,0.04,
     /0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.14,0.17,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.52,0.54,0.56,0.60,
     /0.70,0.80,0.90,1.00,1.20,1.40,1.70,2.00,2.50,3.00,
     /3.30,3.60,4.00,4.40,4.80,5.20,5.60,6.00,6.50,7.00,
     /7.50,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /20.0,30.0,40.0,50.0,60.0,75.0,100.,150.,200.,300.,
     /400.,500.,700.,1000.,1500.,2000.,3000.,4000.,6000.,8000.,
     /10000.,20000.,100000./
      DATA YXSEC/37.4,33.1,30.0,27.9,26.2,24.2,21.6,19.5,16.3,13.9,
     /12.1,10.6,9.30,8.35,7.38,6.65,5.45,4.40,3.25,2.45,
     /1.55,0.92,0.52,0.26,.145,.103,.100,.104,.110,.133,
     /.235,.375,.535,0.74,1.26,1.74,2.55,3.40,4.75,6.35,
     /7.32,8.28,9.51,10.7,11.9,13.2,14.2,15.2,16.2,17.2,
     /17.9,18.4,18.7,18.1,17.2,16.0,14.8,13.6,12.5,11.4,
     /8.18,4.08,2.47,1.71,1.43,1.35,1.30,0.90,0.80,0.64,
     /0.54,0.45,0.40,0.30,0.21,0.16,0.12,0.09,.065,.052,
     /.044,.025,.005/
C ELASTIC
      DATA XEL/1.D-6,.001,.003,.005,.007,0.01,.015,0.02,0.03,0.04,
     /0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.14,0.17,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.55,0.60,0.65,0.70,
     /0.72,0.74,0.76,0.80,0.85,0.90,0.95,1.00,1.10,1.20,
     /1.30,1.40,1.50,1.75,2.00,2.25,2.50,3.00,3.50,4.00,
     /5.00,6.00,7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,
     /15.0,16.0,18.0,20.0,22.5,25.0,27.5,30.0,35.0,40.0,
     /45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,175.,
     /200.,250.,300.,400.,500.,600.,700.,800.,1000.,2000.,
     /4000.,6000.,10000.,20000.,100000./
      DATA YEL/37.4,34.6,31.8,29.9,28.4,26.6,24.1,22.2,19.1,16.8,
     /14.9,13.4,12.1,11.0,10.0,9.15,7.71,6.56,5.21,4.38,
     /3.22,2.31,1.75,1.30,1.04,0.83,0.65,0.57,0.50,0.46,
     /0.45,0.44,0.45,0.46,0.48,0.53,0.60,0.67,0.85,1.07,
     /1.32,1.54,1.84,2.23,3.02,3.83,4.68,6.36,8.24,10.1,
     /14.1,18.5,22.0,25.0,26.2,27.2,27.6,27.5,26.8,26.3,
     /24.9,23.7,22.3,21.0,19.3,17.3,15.8,14.9,13.2,11.5,
     /10.7,9.68,8.80,8.00,7.15,6.35,5.69,4.98,4.30,3.97,
     /3.73,3.43,3.06,2.71,2.45,2.33,2.15,1.99,1.81,1.36,
     /.974,.738,0.55,0.32,0.10/
C IONISATION
      DATA XION/13.996,14.5,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,
     /19.0,19.5,20.0,21.0,22.0,23.0,24.0,26.0,28.0,30.0,
     /32.0,34.0,36.0,38.0,40.0,45.0,50.0,55.0,60.0,65.0,
     /70.0,80.0,90.0,100.,120.,140.,160.,180.,200.,250.,
     /300.,400.,500.,600.,700.,800.,900.,1000.,1200.,1400.,
     /1600.,1800.,2000.,2500.,3000.,3500.,4000.,4500.,5000.,5500.,
     /6000.,7000.,8000.,9000.,10000.,12000.,14000.,16000.,18000.,20000.,
     /100000./
      DATA YION/0.00,.078,.160,.255,.358,.465,.576,.684,.799,.906,
     /1.01,1.12,1.22,1.41,1.58,1.76,1.93,2.24,2.52,2.77,
     /2.96,3.13,3.26,3.39,3.49,3.67,3.84,3.97,4.09,4.17,
     /4.21,4.26,4.23,4.20,4.08,3.91,3.75,3.61,3.46,3.13,
     /2.87,2.46,2.16,1.94,1.76,1.60,1.49,1.39,1.20,1.07,
     /.975,.895,.818,.699,.606,.534,.480,.435,.405,.373,
     /.348,.307,.277,.251,.230,.199,.176,.157,.145,.132,
     /.039/
C EXCITATION TO FIRST 4 S STATES
      DATA XEXC1/9.915,9.92,9.93,9.94,9.95,9.96,9.98,10.0,10.02,10.04,
     /10.06,10.08,10.09,10.1,10.11,10.12,10.13,10.14,10.15,10.16,
     /10.17,10.18,10.19,10.2,10.25,10.3,10.4,10.5,10.6,10.7,
     /10.8,10.9,11.0,11.3,11.6,11.8,12.0,12.5,13.0,13.5,
     /14.0,14.5,15.0,15.5,16.0,17.0,18.0,19.0,20.0,22.0,
     /24.0,27.0,30.0,33.0,36.0,40.0,44.0,50.0,54.0,60.0,
     /70.0,80.0,90.0,100.,120.,140.,170.,200.,240.,280.,
     /320.,360.,400.,450.,500.,600.,700.,800.,1000.,1400.,
     /2000.,2400.,3000.,4000.,5000.,6000.,8000.,10000.,20000.,40000.,
     /100000.,200000.,400000.,1000000.,1500000./
      DATA YEXC1/0.00,
     /.00033,.00103,.00173,.00242,.00310,.00445,.00578,.00709,.00856,
     /.0105,.0127,.0152,.0217,.0372,.0640,.0937,.108,.0971,.0697,
     /.0443,.0300,.0250,.0244,.0287,.0333,.0422,.0507,.0593,.0697,
     /.081,.092,.103,.132,.158,.173,.188,.219,.244,.265,
     /.282,.296,.308,.318,.326,.338,.347,.353,.357,.361,
     /.361,.357,.351,.343,.335,.324,.314,.299,.289,.276,
     /.256,.239,.225,.212,.190,.173,.153,.138,.122,.110,
     /.0998,.0918,.0850,.0780,.0722,.0630,.0561,.0506,.0426,.0327,
     /.0246,.0212,.0177,.0140,.0116,.0100,.0079,.0066,.0037,.0021,
     /.00109,.00072,.00054,.00046,.00046/
C EXCITATION TO NEXT GROUP OF P STATES
      DATA XEXC2/11.304,11.35,11.4,11.45,11.5,11.6,11.7,11.8,11.9,12.0,
     /12.1,12.2,12.3,12.4,12.5,12.6,12.7,12.8,12.9,13.0,
     /13.5,14.0,14.5,15.0,15.5,16.0,17.0,18.0,19.0,20.0,
     /22.0,24.0,27.0,30.0,33.0,36.0,40.0,44.0,50.0,54.0,
     /60.0,70.0,80.0,90.0,100.,120.,140.,170.,200.,240.,
     /280.,320.,360.,400.,450.,500.,600.,700.,800.,1000.,
     /1400.,2000.,2400.,3000.,4000.,5000.,6000.,8000.,10000.,20000.,
     /40000.,100000.,200000.,400000.,1000000.,1500000./
      DATA YEXC2/0.0,
     /.00073,.00151,.0026,.0059,.0141,.0225,.0304,.0381,.0454,
     /.0523,.0589,.0653,.0713,.0771,.0826,.0878,.0928,.0976,.102,
     /.122,.137,.150,.159,.166,.171,.177,.180,.179,.177,
     /.170,.161,.147,.134,.122,.112,.101,.0911,.0797,.0735,
     /.0659,.0563,.0492,.0439,.0397,.0335,.0291,.0245,.0214,.0183,
     /.0161,.0145,.0132,.0121,.0110,.0101,.0087,.0077,.0069,.0058,
     /.00443,.00332,.00286,.00238,.00188,.00156,.00135,.00106,.00088,
     /.00050,.00029,.000146,.000097,.000073,.000063,.000063/
C EXCITATION TO GROUP OF S  P AND D STATES ABOVE 12 EV
      DATA XEXC3/11.998,12.05,12.1,12.2,12.3,12.4,12.5,12.6,12.7,12.8,
     /12.9,13.0,13.2,13.4,13.6,13.8,14.0,14.5,15.0,15.5,
     /16.0,17.0,18.0,19.0,20.0,22.0,24.0,27.0,30.0,33.0,
     /36.0,40.0,44.0,50.0,54.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,170.,200.,240.,280.,320.,360.,400.,450.,
     /500.,600.,700.,800.,1000.,1400.,2000.,2400.,3000.,4000.,
     /5000.,6000.,8000.,10000.,20000.,40000.,100000.,200000.,400000.,
     /1000000.,1500000./
      DATA YEXC3/0.0,
     /.0014,.0027,.0170,.0308,.0441,.0570,.0696,.0818,.0937,
     /.105,.116,.138,.158,.177,.195,.212,.250,.282,.308,
     /.331,.365,.388,.403,.412,.416,.411,.394,.373,.352,
     /.331,.307,.285,.257,.242,.222,.195,.175,.159,.146,
     /.126,.111,.0955,.0841,.0729,.0647,.0583,.0532,.0490,.0448,
     /.0412,.0358,.0317,.0285,.0239,.0183,.0137,.0118,.00986,.00779,
     /.00648,.00558,.00440,.00365,.00207,.00119,.00061,.00040,.00030,
     /.00026,.00026/
C EXCIATION OF ALL STATES ABOVE 12.75 EV
      DATA XEXC4/12.75,12.8,12.9,13.0,13.2,13.4,13.6,13.8,14.0,14.5,
     /15.0,15.5,16.0,17.0,18.0,19.0,20.0,22.0,24.0,27.0,
     /30.0,33.0,36.0,40.0,44.0,50.0,54.0,60.0,70.0,80.0,
     /90.0,100.,120.,140.,170.,200.,240.,280.,320.,360.,
     /400.,450.,500.,600.,700.,800.,1000.,1400.,2000.,2400.,
     /3000.,4000.,5000.,6000.,8000.,10000.,20000.,40000.,100000.,
     /200000.,400000.,1000000.,1500000./
      DATA YEXC4/0.0,
     /.00005,.000455,.00124,.00388,.00780,.0129,.0189,.0259,.0465,
     /.0705,.097,.125,.184,.243,.300,.354,.453,.536,.637,
     /.712,.768,.809,.846,.868,.884,.887,.883,.864,.838,
     /.809,.780,.725,.676,.612,.560,.503,.458,.420,.389,
     /.362,.334,.311,.273,.244,.221,.187,.145,.110,.0948,
     /.0793,.0628,.0524,.0451,.0356,.0296,.0168,.00965,.00495,
     /.00329,.00248,.0021,.0021/
C
      NAME='Kr (2002)'
C
C --------------------------------------------------------------------
C  DATA ON KRYPTON NOT AS GOOD AS ARGON . FIT TO HUNTERS DRIFT VELOCITY
C  AND DIFFUSION OF KOZUMI .TOWNSEND COEFFICIENT
C   OF KRUITOFF,HEYLEN AND BHATTACHYRA CONSISENT SO AVERAGED AND GOOD
C   AGREEMENT OBTAINED WITH CALCULATED VALUES.
C --------------------------------------------------------------------
C
      NIN=4
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C USE ANISOTROPIC ELASTIC SCATTERING AND COPY (OFFSET) TO IONISATION
      KEL(2)=1
      KEL(3)=1
C
      NEL=95
      NDATA=83
      NION=71
      NEXC1=95
      NEXC2=76
      NEXC3=71
      NEXC4=63
      E(1)=0.0
      E(2)=2.0*EMASS/(83.80*AMU)
      E(3)=13.996
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=9.6
      IOFF=INT(0.5+E(3)/ESTEP)
      EIN(1)=9.915
      EIN(2)=11.304
      EIN(3)=11.998
      EIN(4)=12.75
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC (ANIS)  KRYPTON      '
      SCRPT(3)=' IONISATION    ELOSS= 13.996  '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC S-LEVELS  ELOSS=  9.915  '
      SCRPT(8)=' EXC P-LEVELS  ELOSS= 11.304  '
      SCRPT(9)=' EXC D+P-LVLS  ELOSS= 11.998  '
      SCRPT(10)=' EXC HIGHER    ELOSS= 12.75   '
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) QELA=37.8D-16
      IF(EN.EQ.0.0) QMOM=37.8D-16
      IF(EN.EQ.0.0) GO TO 200
      DO 110 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 120
  110 CONTINUE
      J=NEL
C USE LOG INTERPOLATION
  120 Y1=LOG(YEL(J-1))
      Y2=LOG(YEL(J))
      X1=LOG(XEL(J-1))
      X2=LOG(XEL(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      QELA=EXP((A*LOG(EN)+B))*1.0D-16
      DO 150 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 160
  150 CONTINUE
      J=NDATA
C USE LOG INTERPOLATION
  160 Y1=LOG(YXSEC(J-1))
      Y2=LOG(YXSEC(J))
      X1=LOG(XEN(J-1))
      X2=LOG(XEN(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      QMOM=EXP((A*LOG(EN)+B))*1.0D-16
  200 CONTINUE
      PEQEL(2,I)=0.5+(QELA-QMOM)/QELA
      Q(2,I)=QELA
C
      Q(3,I)=0.0D0
      PEQEL(3,I)=0.5D0
      IF(EN.LE.E(3)) GO TO 230
      DO 210 J=2,NION
      IF(EN.LE.XION(J)) GO TO 220
  210 CONTINUE
      J=NION
  220 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.0D-16
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 230
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C
  230 CONTINUE
      Q(4,I)=0.0D0
      Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C EXCITATION TO FIRST FOUR 5S-LEVELS
      QIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 370
      DO 350 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 360
  350 CONTINUE
      J=NEXC1
  360 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(1,I)=(A*EN+B)*1.0D-16
  370 CONTINUE
C  EXCITATION TO 5P-LEVELS
      QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 470
      DO 450 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 460
  450 CONTINUE
      J=NEXC2
  460 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(2,I)=(A*EN+B)*1.0D-16
  470 CONTINUE
C EXCITATION TO 5D + 4D + 5P' LEVELS (UP TO 12.5 EV)
      QIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 570
      DO 550 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 560
  550 CONTINUE
      J=NEXC3
  560 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(3,I)=(A*EN+B)*1.0D-16
  570 CONTINUE
C  EXCITATION TO ALL LEVELS ABOVE 12.75 EV.
      QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 670
      DO 650 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 660
  650 CONTINUE
      J=NEXC4
  660 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(4,I)=(A*EN+B)*1.0D-16
  670 CONTINUE
      Q(1,I)=Q(2,I)+Q(3,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LT.EIN(4)) NIN=3
      IF(EFINAL.LT.EIN(3)) NIN=2
      IF(EFINAL.LT.EIN(2)) NIN=1
      IF(EFINAL.LT.EIN(1)) NIN=0
      END
