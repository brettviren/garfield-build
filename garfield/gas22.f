CDECK  ID>, GAS22.
      SUBROUTINE GAS22(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
*-----------------------------------------------------------------------
*   MAGPAR - Interface parameters for gas mixing with Magboltz.
*   (Last changed on  2/ 3/08.)
*-----------------------------------------------------------------------
       INTEGER MXGNAM
       PARAMETER(MXGNAM=60)
       DOUBLE PRECISION FRAMIX
       LOGICAL LF0PLT,LCSPLT,LGKEEP,LBMCPR
       COMMON /MAGPAR/ FRAMIX(MXGNAM),LF0PLT,LCSPLT,LGKEEP,LBMCPR
       LOGICAL         LINPUT,LCELPR,LCELPL,LWRMRK,LISOCL,LCHGCH,
     -         LDRPLT,LDRPRT,LCLPRT,LCLPLT,LMAPCH,LCNTAM,
     -         LDEBUG,LIDENT,LKEYPL,LRNDMI,LPROPR,LPROF,LGSTOP,LGSIG,
     -         LSYNCH,LINPRD
       INTEGER LUNOUT,JFAIL,JEXMEM
       COMMON /PRTPLT/ LINPUT,LCELPR,LCELPL,LWRMRK,LISOCL,LCHGCH,
     -         LDRPLT,LDRPRT,LCLPRT,LCLPLT,LMAPCH,LCNTAM,
     -         LDEBUG,LIDENT,LKEYPL,LRNDMI,LPROPR,LPROF,LGSTOP,LGSIG,
     -         LSYNCH,LINPRD,LUNOUT,JFAIL,JEXMEM
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(53),YXSEC(53),XROT0(40),YROT0(40),XROT1(42),YROT1(42
     /),XROT2(31),YROT2(31),XROT3(31),YROT3(31),XROT4(31),YROT4(31),
     /XROT5(30),YROT5(30),XVIB1(35),YVIB1(35),XVIB2(35),YVIB2(35),
     /XVIB3(16),YVIB3(16),XVIB4(16),YVIB4(16),XEXC1(20),YEXC1(20),
     /XEXC2(23),YEXC2(23),XATT(18),YATT(18),XION(72),YION(72),PJ(7)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.01,0.02,0.03,0.04,.046,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.13,0.15,0.20,0.30,0.40,0.50,0.60,0.70,
     /0.90,1.00,1.10,1.40,1.50,1.60,1.80,2.00,2.50,3.00,
     /4.00,5.00,6.00,8.00,10.0,15.0,20.0,30.0,40.0,50.0,
     /60.0,80.0,100.,150.,200.,300.,400.,500.,600.,800.,
     /1000.,10000.,100000./
      DATA YXSEC/6.36,7.26,7.95,8.45,8.91,9.05,9.22,9.50,9.79,10.04,
     /10.24,10.44,10.93,11.33,11.93,12.92,13.82,14.61,15.51,16.20,
     /16.9,17.2,17.3,17.7,17.7,17.8,17.7,17.5,16.8,16.1,
     /14.2,13.5,13.2,12.3,11.2,7.30,4.30,1.60,0.77,0.50,
     /0.35,0.22,0.15,0.07,.043,.022,.014,.010,.006,.004,
     /.002,.0002,.00002/
C-----------------------------------------------------------------------
C ROTATION J=0-2
      DATA XROT0/.0226,.025,0.03,0.04,0.05,0.06,0.07,0.08,0.10,0.15,
     /0.20,0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.20,1.50,2.00,2.50,3.00,3.50,4.00,4.50,5.00,6.00,
     /7.00,8.00,9.00,10.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YROT0/0.00,.024,.042,.061,.067,.073,.078,.082,.091,.110,
     /.129,.144,.170,.215,.264,.323,.394,.469,.555,.636,
     /.796,1.036,1.370,1.585,1.704,1.755,1.758,1.732,1.689,1.579,
     /1.462,1.350,1.248,1.156,0.730,0.44,0.05,.0015,.00015,.000015/
C-----------------------------------------------------------------------
C ROTATION J=1-3
      DATA XROT1/.0377,0.04,0.05,0.06,0.07,0.08,0.10,0.15,0.20,0.25,
     /0.30,0.40,0.50,0.56,0.60,0.66,0.70,0.80,0.90,1.01,
     /1.20,1.40,1.60,1.80,2.00,2.50,3.00,3.50,4.00,4.50,
     /5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YROT1/0.00,0.01,.026,.032,.036,.040,.046,.058,.071,.082,
     /.094,.122,.152,.165,.178,.200,.214,.252,.292,.334,
     /.420,.510,.610,.700,.786,.937,1.01,1.05,1.05,1.04,
     /1.01,.946,.876,.809,.748,.694,.440,.265,0.03,.001,.0001,.00001/
C-----------------------------------------------------------------------
C ROTATION J=2-4
      DATA XROT2/.0528,0.07,0.10,0.15,0.20,0.30,0.40,0.50,0.60,0.70,
     /0.80,0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,4.50,
     /5.00,5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,10000.,100000./
      DATA YROT2/0.00,.022,.034,.046,.055,.075,.099,.115,.132,.162,
     /.193,.227,.266,.463,.619,.719,.774,.799,.802,.790,
     /.771,.748,.721,.669,.617,.529,0.20,0.02,.0007,.00007,.000007/
C-----------------------------------------------------------------------
C ROTATION J=3-5
      DATA XROT3/.0679,0.10,0.15,0.20,0.25,0.30,0.40,0.50,0.60,0.70,
     /0.80,0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,4.50,
     /5.00,5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,10000.,100000./
      DATA YROT3/0.00,0.02,0.04,0.05,0.06,0.07,.095,.110,.129,.160,
     /.194,.233,.271,.478,.637,.742,.799,.825,.828,.818,
     /.797,.774,.747,.692,.640,.548,0.18,0.02,.0007,.00007,.000007/
C-----------------------------------------------------------------------
C ROTATION J=4-6
      DATA XROT4/.0830,0.10,0.15,0.20,0.25,0.30,0.40,0.50,0.60,0.70,
     /0.80,0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,4.50,
     /5.00,5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,10000.,100000./
      DATA YROT4/0.00,.012,0.03,.038,.045,.053,.071,.083,.097,.120,
     /.146,.175,0.20,0.36,0.48,0.56,0.60,0.62,0.62,0.61,
     /0.60,0.58,0.56,0.52,0.48,0.41,0.13,.015,.0005,.00005,.000005/
C-----------------------------------------------------------------------
C ROTATION J=5-7
      DATA XROT5/.0981,0.15,0.20,0.25,0.30,0.40,0.50,0.60,0.70,0.80,
     /0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,4.50,5.00,
     /5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,10000.,100000./
      DATA YROT5/0.00,.015,.028,.034,0.04,.053,.062,.073,0.09,0.11,
     /0.13,0.15,0.27,0.36,0.42,0.45,0.46,0.46,0.46,0.45,
     /0.44,0.42,0.39,0.36,0.31,0.10,0.01,.0004,.00004,.000004/
C----------------------------------------------------------------------
C VIBRATION V=0-1 DELTAJ=0  ROTATIONALLY ELASTIC
      DATA XVIB1/0.371,0.50,0.60,0.65,0.75,0.85,1.00,1.15,1.25,1.50,
     /1.75,2.00,2.20,2.40,2.60,3.00,3.50,4.00,4.50,5.00,
     /6.00,7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,
     /20.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,.0045,.009,.011,.016,.020,.028,.037,.042,.064,
     /.084,.100,.110,.120,.128,.135,.140,.140,.135,.122,
     /.100,.077,.060,.046,.035,.027,.021,.017,.015,.013,
     /.0085,.0017,.00005,.000005,.0000005/
C-----------------------------------------------------------------------
C VIBRATION V=0-1 DELTAJ=2  ROTATIONALLY INELASTIC
      DATA XVIB2/0.391,0.50,0.60,0.65,0.75,0.85,1.00,1.15,1.25,1.50,
     /1.75,2.00,2.20,2.40,2.60,3.00,3.50,4.00,4.50,5.00,
     /6.00,7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,
     /20.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,.0025,.0055,.008,.012,.017,.026,.035,.040,.064,
     /.088,.115,.135,.150,.160,.176,.188,.188,.185,.172,
     /.142,.110,.082,.062,.045,.035,.026,.019,.014,.011,
     /.0074,.0015,.00004,.000004,.0000004/
C-----------------------------------------------------------------------
C  VIBRATION V=0-2
      DATA XVIB3/0.735,1.00,1.50,2.00,3.00,4.00,5.00,6.00,8.00,10.0,
     /15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,.0005,.003,.007,.017,.018,.017,.015,.011,.007,
     /.001,.0005,.00015,.000005,.0000005,.00000005/
C-----------------------------------------------------------------------
C  VIBRATION V=0-3
      DATA XVIB4/1.085,1.35,1.50,2.00,3.00,4.00,5.00,6.00,8.00,10.0,
     /15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,.00015,.0003,.0008,.0016,.0016,.0015,.0012,.001,
     /.0015,.0005,.0001,.000025,.0000008,.00000008,.000000008/
C-----------------------------------------------------------------------
C EXCITATION TO TRIPLET STATES (DISSOCIATION)
      DATA XEXC1/8.85,8.92,9.34,10.0,11.0,12.0,15.0,20.0,25.0,30.0,
     /40.0,50.0,60.0,80.0,100.,150.,200.,1000.,10000.,100000./
      DATA YEXC1/0.00,.008,0.04,0.08,.184,.336,0.51,0.46,0.28,0.18,
     /0.08,.041,.025,.010,.005,.0012,.0005,.00008,.000008,.0000008/
C  EXCITATION TO SINGLET STATES
      DATA XEXC2/12.0,12.13,13.4,15.0,17.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,80.0,100.,150.,200.,300.,400.,500.,600.,800.,
     /1000.,10000.,100000./
      DATA YEXC2/0.00,0.09,0.09,0.24,0.40,0.58,0.86,1.01,1.07,1.11,
     /1.13,1.05,0.99,0.79,0.70,0.58,0.50,0.42,0.38,0.31,
     /0.24,.024,.0024/
C-----------------------------------------------------------------------
      DATA XATT/7.40,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /17.0,18.0,30.0,60.0,100.,1000.,10000.,100000./
      DATA YATT/0.00,.000005,.000012,.000026,.000027,.00003,.000035,
     /.00010,.00008,.00009,.00010,.00011,.00006,.00001,.000001,
     /.0000001,.00000001,.000000001/
C-----------------------------------------------------------------------
      DATA XION/15.427,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,
     /20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,
     /25.5,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,105.,110.,115.,120.,125.,130.,135.,140.,145.,
     /150.,160.,180.,200.,250.,300.,350.,400.,450.,500.,
     /550.,600.,650.,700.,750.,800.,850.,900.,950.,1000.,
     /10000.,100000./
      DATA YION/0.00,.034,.069,.104,.138,.173,.207,.239,.272,.300,
     /.328,.355,.383,.406,.429,.454,.475,.498,.518,.537,
     /.556,.575,.641,.699,.744,.786,.821,.851,.876,.931,
     /.950,.968,.977,.981,.981,.980,.974,.968,.958,.948,
     /.939,.925,.913,.907,.889,.877,.866,.853,.839,.827,
     /.813,.792,.754,.716,.638,.576,.523,.482,.446,.414,
     /.387,.366,.344,.326,.310,.295,.282,.271,.257,.247,
     /.0247,.00247/
C----------------------------------------------------------------------
      NAME='D2 (1998)'
C --------------------------------------------------------------------
C  CALCULATE FRACTIONAL POPULATION DENSITY FOR ROTATIONAL STATES
      B0=0.00377272
      DO 111 K=1,7,2
 111  PJ(K)=3*(2*K+1)*EXP(-K*(K+1)*B0/AKT)
      DO 112 K=2,6,2
 112  PJ(K)=6*(2*K+1)*EXP(-K*(K+1)*B0/AKT)
      SUM=6.0
      DO 113 K=1,7
 113  SUM=SUM+PJ(K)
      FROT0=6.0/SUM
      FROT1=PJ(1)/SUM
      FROT2=PJ(2)/SUM
      FROT3=PJ(3)/SUM
      FROT4=PJ(4)/SUM
      FROT5=PJ(5)/SUM
      FROT6=PJ(6)/SUM
      FROT7=PJ(7)/SUM
C      IF(LBMCPR)WRITE(LUNOUT,88)
C    -      FROT0,FROT1,FROT2,FROT3,FROT4,FROT5,FROT6,FROT7
C  88 FORMAT(2X,' FROT0=',F9.5,' FROT1=',F9.5,' FROT2=',F9.5,' FROT3=',
C    /F9.5,' FROT4=',F9.5,' FROT5=',F9.5,' FROT6=',F9.5,' FROT7=',F9.5)
C-----------------------------------------------------------------------
      NIN=15
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=53
      NROT0=40
      NROT1=42
      NROT2=31
      NROT3=31
      NROT4=31
      NROT5=30
      NVIB1=35
      NVIB2=35
      NVIB3=16
      NVIB4=16
      NEXC1=20
      NEXC2=23
      NION=72
      NATT=18
      E(1)=0.0
      E(2)=2.0*EMASS/(4.028204*AMU)
      E(3)=15.427
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=8.30
      EIN(1)=-.0226
      EIN(2)=-.0377
      EIN(3)=-.0528
      EIN(4)=0.0226
      EIN(5)=0.0377
      EIN(6)=0.0528
      EIN(7)=0.0679
      EIN(8)=0.0830
      EIN(9)=0.0981
      EIN(10)=0.371
      EIN(11)=0.391
      EIN(12)=0.735
      EIN(13)=1.085
      EIN(14)=8.85
      EIN(15)=12.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DEUTERIUM      '
      SCRPT(3)=' IONISATION    ELOSS= 15.427  '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 2-0       ELOSS= -0.0226 '
      SCRPT(8)=' ROT 3-1       ELOSS= -0.0377 '
      SCRPT(9)=' ROT 4-2       ELOSS= -0.0528 '
      SCRPT(10)=' ROT 0-2       ELOSS=  0.0226 '
      SCRPT(11)=' ROT 1-3       ELOSS=  0.0377 '
      SCRPT(12)=' ROT 2-4       ELOSS=  0.0528 '
      SCRPT(13)=' ROT 3-5       ELOSS=  0.0679 '
      SCRPT(14)=' ROT 4-6 + 6-8 ELOSS=  0.0830 '
      SCRPT(15)=' ROT 5-7 + 7-9 ELOSS=  0.0981 '
      SCRPT(16)=' VIB V1 DJ=0   ELOSS=  0.371  '
      SCRPT(17)=' VIB V1 DJ=2   ELOSS=  0.391  '
      SCRPT(18)=' VIB 2V1       ELOSS=  0.735  '
      SCRPT(19)=' VIB 3V1       ELOSS=  1.085  '
      SCRPT(20)=' EXC TRPLT     ELOSS=  8.85   '
      SCRPT(21)=' EXC SNGLT     ELOSS= 12.0    '
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 CONTINUE
C
      Q(4,I)=0.0D0
      IF(EN.LT.XATT(1)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 CONTINUE
      Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C---------------------------------------------------------------------
C                    SUPERELASTIC 2-0
      QIN(1,I)=0.0D0
      IF(EN.LE.0.0) GO TO 1100
      DO 1010 J=2,NROT0
      IF((EN+EIN(4)).LE.XROT0(J)) GO TO 1020
 1010 CONTINUE
      J=NROT0
 1020 A=(YROT0(J)-YROT0(J-1))/(XROT0(J)-XROT0(J-1))
      B=(XROT0(J-1)*YROT0(J)-XROT0(J)*YROT0(J-1))/(XROT0(J-1)-XROT0(J))
      QIN(1,I)=FROT2*0.2*(EN+EIN(4))*(A*(EN+EIN(4))+B)*1.D-16/EN
 1100 CONTINUE
C                    SUPERELASTIC 3-1
      QIN(2,I)=0.0D0
      IF(EN.LE.0.0) GO TO 1101
      DO 1011 J=2,NROT1
      IF((EN+EIN(5)).LE.XROT1(J)) GO TO 1021
 1011 CONTINUE
      J=NROT1
 1021 A=(YROT1(J)-YROT1(J-1))/(XROT1(J)-XROT1(J-1))
      B=(XROT1(J-1)*YROT1(J)-XROT1(J)*YROT1(J-1))/(XROT1(J-1)-XROT1(J))
      QIN(2,I)=FROT3*(3.0/7.0)*(EN+EIN(5))*(A*(EN+EIN(5))+B)*1.D-16/EN
 1101 CONTINUE
C                    SUPERELASTIC 4-2
      QIN(3,I)=0.0D0
      IF(EN.LE.0.0) GO TO 1102
      DO 1012 J=2,NROT2
      IF((EN+EIN(6)).LE.XROT2(J)) GO TO 1022
 1012 CONTINUE
      J=NROT2
 1022 A=(YROT2(J)-YROT2(J-1))/(XROT2(J)-XROT2(J-1))
      B=(XROT2(J-1)*YROT2(J)-XROT2(J)*YROT2(J-1))/(XROT2(J-1)-XROT2(J))
      QIN(3,I)=FROT4*(5.0/9.0)*(EN+EIN(6))*(A*(EN+EIN(6))+B)*1.D-16/EN
 1102 CONTINUE
C                      ROTATION 0-2
      QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 1400
      DO 1310 J=2,NROT0
      IF(EN.LE.XROT0(J)) GO TO 1320
 1310 CONTINUE
      J=NROT0
 1320 A=(YROT0(J)-YROT0(J-1))/(XROT0(J)-XROT0(J-1))
      B=(XROT0(J-1)*YROT0(J)-XROT0(J)*YROT0(J-1))/(XROT0(J-1)-XROT0(J))
      QIN(4,I)=(A*EN+B)*1.D-16*FROT0
 1400 CONTINUE
C                        ROTATION 1-3
      QIN(5,I)=0.0D0
      IF(EN.LE.EIN(5)) GO TO 1401
      DO 1311 J=2,NROT1
      IF(EN.LE.XROT1(J)) GO TO 1321
 1311 CONTINUE
      J=NROT1
 1321 A=(YROT1(J)-YROT1(J-1))/(XROT1(J)-XROT1(J-1))
      B=(XROT1(J-1)*YROT1(J)-XROT1(J)*YROT1(J-1))/(XROT1(J-1)-XROT1(J))
      QIN(5,I)=(A*EN+B)*1.D-16*FROT1
 1401 CONTINUE
C                      ROTATION 2-4
      QIN(6,I)=0.0D0
      IF(EN.LE.EIN(6)) GO TO 1402
      DO 1312 J=2,NROT2
      IF(EN.LE.XROT2(J)) GO TO 1322
 1312 CONTINUE
      J=NROT2
 1322 A=(YROT2(J)-YROT2(J-1))/(XROT2(J)-XROT2(J-1))
      B=(XROT2(J-1)*YROT2(J)-XROT2(J)*YROT2(J-1))/(XROT2(J-1)-XROT2(J))
      QIN(6,I)=(A*EN+B)*1.D-16*FROT2
 1402 CONTINUE
C                        ROTATION 3-5
      QIN(7,I)=0.0D0
      IF(EN.LE.EIN(7)) GO TO 1403
      DO 1313 J=2,NROT3
      IF(EN.LE.XROT3(J)) GO TO 1323
 1313 CONTINUE
      J=NROT3
 1323 A=(YROT3(J)-YROT3(J-1))/(XROT3(J)-XROT3(J-1))
      B=(XROT3(J-1)*YROT3(J)-XROT3(J)*YROT3(J-1))/(XROT3(J-1)-XROT3(J))
      QIN(7,I)=(A*EN+B)*1.D-16*FROT3
 1403 CONTINUE
C                      ROTATION 4-6 + 6-8
      QIN(8,I)=0.0D0
      IF(EN.LE.EIN(8)) GO TO 1404
      DO 1314 J=2,NROT4
      IF(EN.LE.XROT4(J)) GO TO 1324
 1314 CONTINUE
      J=NROT4
 1324 A=(YROT4(J)-YROT4(J-1))/(XROT4(J)-XROT4(J-1))
      B=(XROT4(J-1)*YROT4(J)-XROT4(J)*YROT4(J-1))/(XROT4(J-1)-XROT4(J))
      QIN(8,I)=(A*EN+B)*1.D-16*(FROT4+FROT6)
 1404 CONTINUE
C                      ROTATION 5-7 + 7-9
      QIN(9,I)=0.0D0
      IF(EN.LE.EIN(9)) GO TO 1405
      DO 1315 J=2,NROT5
      IF(EN.LE.XROT5(J)) GO TO 1325
 1315 CONTINUE
      J=NROT5
 1325 A=(YROT5(J)-YROT5(J-1))/(XROT5(J)-XROT5(J-1))
      B=(XROT5(J-1)*YROT5(J)-XROT5(J)*YROT5(J-1))/(XROT5(J-1)-XROT5(J))
      QIN(9,I)=(A*EN+B)*1.D-16*(FROT5+FROT7)
 1405 CONTINUE
C-----------------------------------------------------------------------
      QIN(10,I)=0.0D0
      IF(EN.LE.EIN(10)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  400 CONTINUE
C
      QIN(11,I)=0.0D0
      IF(EN.LE.EIN(11)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(11,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(12,I)=0.0D0
      IF(EN.LE.EIN(12)) GO TO 501
      DO 411 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 421
  411 CONTINUE
      J=NVIB3
  421 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(12,I)=(A*EN+B)*1.D-16
  501 CONTINUE
C
      QIN(13,I)=0.0D0
      IF(EN.LE.EIN(13)) GO TO 502
      DO 412 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 422
  412 CONTINUE
      J=NVIB4
  422 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(13,I)=(A*EN+B)*1.D-16
  502 CONTINUE
C-----------------------------------------------------------------------
      QIN(14,I)=0.0D0
      IF(EN.LE.EIN(14)) GO TO 600
      DO 510 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 520
  510 CONTINUE
      J=NEXC1
  520 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(14,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(15,I)=0.0D0
      IF(EN.LE.EIN(15)) GO TO 700
      DO 610 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 620
  610 CONTINUE
      J=NEXC2
  620 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(15,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C---------------------------------------------------------------------
C NB. ROTATIONAL AND VIBRATIONAL STATES INCLUDED IN Q(2,I)
C -------------------------------------------------------------------
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(14,I)+QIN(15,I)
C GET CORRECT ELASTIC XSECTION
      IF(EN.LT.200.) THEN
      Q(2,I)=Q(2,I)-QIN(1,I)-QIN(2,I)-QIN(3,I)-QIN(4,I)-QIN(5,I)-QIN(6,I
     /)-QIN(7,I)-QIN(8,I)-QIN(9,I)-QIN(10,I)-QIN(11,I)-QIN(12,I)-QIN(13,
     /I)
      ENDIF
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(15)) NIN=14
      IF(EFINAL.LE.EIN(14)) NIN=13
      IF(EFINAL.LE.EIN(13)) NIN=12
      IF(EFINAL.LE.EIN(12)) NIN=11
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      END
