CDECK  ID>, GAS17.
      SUBROUTINE GAS17(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
*-----------------------------------------------------------------------
*   MAGPAR - Interface parameters for gas mixing with Magboltz.
*   (Last changed on  2/ 3/08.)
*-----------------------------------------------------------------------
       INTEGER MXGNAM
       PARAMETER(MXGNAM=60)
       DOUBLE PRECISION FRAMIX
       LOGICAL LF0PLT,LCSPLT,LGKEEP,LBMCPR
       COMMON /MAGPAR/ FRAMIX(MXGNAM),LF0PLT,LCSPLT,LGKEEP,LBMCPR
       LOGICAL         LINPUT,LCELPR,LCELPL,LWRMRK,LISOCL,LCHGCH,
     -         LDRPLT,LDRPRT,LCLPRT,LCLPLT,LMAPCH,LCNTAM,
     -         LDEBUG,LIDENT,LKEYPL,LRNDMI,LPROPR,LPROF,LGSTOP,LGSIG,
     -         LSYNCH,LINPRD
       INTEGER LUNOUT,JFAIL,JEXMEM
       COMMON /PRTPLT/ LINPUT,LCELPR,LCELPL,LWRMRK,LISOCL,LCHGCH,
     -         LDRPLT,LDRPRT,LCLPRT,LCLPLT,LMAPCH,LCNTAM,
     -         LDEBUG,LIDENT,LKEYPL,LRNDMI,LPROPR,LPROF,LGSTOP,LGSIG,
     -         LSYNCH,LINPRD,LUNOUT,JFAIL,JEXMEM
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(58),YXSEC(58),XION(48),YION(48),XATT(23),YATT(23),
     /XROT1(18),YROT1(18),XVIB1(24),YVIB1(24),XVIB2(23),YVIB2(23),
     /XEXC1(32),YEXC1(32),
     /XAT3(18),YAT3(18)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.005,.007,0.01,.012,.015,0.02,0.03,0.04,0.05,
     /0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.20,0.30,0.40,
     /0.50,0.60,0.70,0.80,0.90,1.00,1.20,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.00,8.00,9.00,10.0,12.0,15.0,20.0,
     /30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,
     /200.,300.,400.,500.,1000.,2000.,10000.,100000./
      DATA YXSEC/32.0,30.8,29.8,27.8,25.5,22.1,20.0,15.7,13.3,11.2,
     /10.0,9.25,8.63,8.34,8.24,8.00,6.73,6.00,6.00,6.14,
     /6.50,6.88,7.70,8.25,8.95,9.78,10.6,13.3,13.6,12.8,
     /10.2,9.78,8.45,7.10,6.10,5.20,4.75,4.10,2.85,1.85,
     /1.12,0.82,0.59,0.49,0.39,0.32,0.28,0.24,0.18,0.14,
     /0.09,0.05,.035,.025,0.01,.004,.0005,.0001/
      DATA XION/9.2644,9.50,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,
     /14.0,15.0,16.0,17.0,18.0,19.0,20.0,22.0,24.0,26.0,
     /28.0,32.0,36.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,
     /100.,120.,140.,160.,200.,300.,400.,500.,600.,700.,
     /800.,900.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YION/0.00,.011,.018,.031,.047,.064,.093,.131,.184,.244,
     /.305,.418,.503,.585,.663,.736,.813,.959,1.11,1.26,
     /1.40,1.65,1.87,2.08,2.30,2.48,2.74,2.91,3.04,3.11,
     /3.14,3.14,3.10,3.04,2.86,2.45,2.11,1.86,1.67,1.51,
     /1.39,1.27,1.21,0.80,0.45,0.23,0.14,.035/
      DATA XATT/6.50,6.80,7.00,7.20,7.40,7.60,7.80,8.00,8.60,8.80,
     /9.00,9.20,9.40,9.60,9.80,10.0,10.4,10.6,10.8,11.0,
     /11.5,13.0,14.0/
      DATA YATT/0.00,0.02,0.08,0.33,0.71,0.96,1.08,1.11,1.11,1.09,
     /1.04,0.95,0.83,0.65,0.51,0.38,0.18,0.11,0.08,0.06,
     /0.04,0.03,0.00/
      DATA XAT3/0.01,.012,.015,0.02,0.03,0.04,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.12,0.15,0.20,0.30,1.00,10.0/
      DATA YAT3/0.00,.085,0.24,0.14,0.07,.041,.029,.023,.019,.017,
     /.015,.014,.013,.012,.010,.0085,.0035,0.00/
      DATA XROT1/.100,0.12,0.15,0.20,0.30,0.40,0.50,0.60,0.70,0.80,
     /0.90,1.00,1.20,1.50,2.00,10.0,100.,100000./
      DATA YROT1/0.00,.037,.037,.033,.026,.018,.014,.011,.009,.006,
     /.005,.004,.003,.002,.001,.0001,.00001,.000001/
      DATA XVIB1/.2326,0.24,0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,
     /1.00,1.20,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,
     /10.0,20.0,100.,100000./
      DATA YVIB1/0.00,0.05,0.08,0.10,0.08,0.06,0.05,0.04,.032,.027,
     /.023,.018,.012,.008,.004,.002,.0015,.0012,.001,.0008,
     /.0005,.0001,.00002,.000001/
      DATA XVIB2/0.60,0.63,0.70,0.80,0.90,1.00,1.20,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.00,8.00,10.0,15.0,20.0,40.0,60.0,
     /100.,1000.,100000./
      DATA YVIB2/0.00,0.60,0.90,0.90,0.85,0.80,0.70,0.50,0.31,0.16,
     /0.11,.075,.055,.042,.035,.025,.012,.008,.002,.001,
     /.0005,.00005,.000005/
      DATA XEXC1/6.10,6.50,7.00,7.50,8.00,8.50,9.00,10.0,12.0,15.0,
     /20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,120.,
     /150.,200.,300.,400.,500.,1000.,2000.,4000.,10000.,20000.,
     /40000.,100000./
      DATA YEXC1/0.00,0.01,0.02,.085,0.20,0.55,0.70,1.00,1.65,2.21,
     /3.30,3.50,3.30,3.00,2.65,2.26,2.16,2.00,1.80,1.60,
     /1.40,1.03,0.85,0.65,0.52,0.25,0.13,0.06,.025,.012,
     /.0065,.0025/
      NAME='NO (1995)'
C ---------------------------------------------------------------------
C CALCULATE CORRECTION FACTOR FOR 3BODY ATTACHMENT CROSS-SECTION
      FAC=273.15*TORR/((TEMPC+273.15)*760.0)
C---------------------------------------------
C     IF(LBMCPR)WRITE(LUNOUT,100)
C 100 FORMAT(1H1)
C     IF(LBMCPR)WRITE(LUNOUT,100) FAC
C 101 FORMAT(' 3BODY ATTACHMENT INCLUDED DENSITY SCALING FACTOR =',F7.4)
      NIN=4
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=58
      NION=48
      NATT=23
      NAT3=18
      NROT1=18
      NVIB1=24
      NVIB2=23
      NEXC1=32
      E(1)=0.0
      E(2)=2.0*EMASS/(30.00614*AMU)
      E(3)=9.2644
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=13.6
      EIN(1)=0.100
      EIN(2)=0.2326
      EIN(3)=0.600
      EIN(4)=6.10
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       NITRIC OXIDE   '
      SCRPT(3)=' IONISATION    ELOSS=  9.2644 '
      SCRPT(4)=' ATTACHMENT 2+3 BODY          '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS=  0.100  '
      SCRPT(8)=' VIB V1        ELOSS=  0.2326 '
      SCRPT(9)=' VIB SUM       ELOSS=  0.600  '
      SCRPT(10)=' EXC           ELOSS=  6.10   '
      EN=-ESTEP/2.0D0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
      Q(3,I)=0.0D0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0D0
      SINGLE=0.0D0
      IF(EN.LT.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT)) GO TO 250
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      SINGLE=(A*EN+B)*1.D-18
  250 THREEB=0.0D0
      IF(EN.LT.XAT3(1)) GO TO 300
      IF(EN.GT.XAT3(NAT3)) GO TO 300
      DO 260 J=2,NAT3
      IF(EN.LE.XAT3(J)) GO TO 270
  260 CONTINUE
      J=NAT3
  270 A=(YAT3(J)-YAT3(J-1))/(XAT3(J)-XAT3(J-1))
      B=(XAT3(J-1)*YAT3(J)-XAT3(J)*YAT3(J-1))/(XAT3(J-1)-XAT3(J))
      THREEB=FAC*(A*EN+B)*1.D-16
      Q(4,I)=SINGLE+THREEB
  300 Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C
      QIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 400
      DO 310 J=2,NROT1
      IF(EN.LE.XROT1(J)) GO TO 320
  310 CONTINUE
      J=NROT1
  320 A=(YROT1(J)-YROT1(J-1))/(XROT1(J)-XROT1(J-1))
      B=(XROT1(J-1)*YROT1(J)-XROT1(J)*YROT1(J-1))/(XROT1(J-1)-XROT1(J))
      QIN(1,I)=(A*EN+B)*1.D-16
  400 CONTINUE
      QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 500
      DO 410 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 420
  410 CONTINUE
      J=NVIB1
  420 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)*1.D-16
  500 CONTINUE
      QIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 600
      DO 510 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 520
  510 CONTINUE
      J=NVIB2
  520 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  600 CONTINUE
      QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      END
