CDECK  ID>, GAS47.
      SUBROUTINE GAS47(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(44),YXSEC(44),XENI(76),YXENI(76),XIN(26),YXSIN(26),Y
     /XPIN(26),YXDIN(26),XEL(44),YEL(44)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC MOMENTUM TRANSFER
      DATA XEN/1.00,1.20,1.50,1.70,2.00,2.50,3.00,4.00,4.90,5.00,
     /6.00,6.67,7.00,8.00,8.71,9.00,10.0,11.0,12.0,13.0,
     /13.6,14.0,15.0,16.0,16.5,18.0,20.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,80.0,100.,150.,200.,400.,1000.,2000.,
     /4000.,10000.,20000.,100000./
      DATA YXSEC/1.3913,1.66,2.05,2.33,2.70,3.43,4.15,5.65,7.26,7.46,
     /9.32,10.6,11.3,13.1,14.1,14.4,15.4,15.8,15.8,15.4,
     /15.1,14.8,14.1,13.2,13.0,11.4,10.2,7.80,6.25,4.45,
     /3.50,2.80,2.20,2.00,1.45,0.90,0.63,0.28,0.18,0.10,
     /0.05,.0048,0.0018,.00009/
C ELASTIC
      DATA XEL/1.00,1.50,2.00,3.00,4.00,5.00,6.00,8.00,10.0,12.0,
     /14.0,16.0,18.0,20.0,25.0,30.0,40.0,50.0,60.0,70.0,
     /80.0,90.0,100.,125.,150.,200.,250.,300.,350.,400.,
     /500.,600.,700.,800.,1000.,1500.,2000.,3000.,4000.,5000.,
     /6000.,10000.,20000.,100000./
      DATA YEL/1.4945,2.25,3.20,5.10,7.20,8.95,11.1,15.8,20.3,23.2,
     /23.5,22.3,19.5,17.8,13.9,11.4,8.44,6.84,6.12,5.56,
     /5.09,4.72,4.42,3.81,3.41,2.94,2.61,2.44,2.29,2.07,
     /1.90,1.74,1.61,1.59,1.28,0.95,.767,.518,.448,.356,
     /.305,0.18,0.09,0.02/
      DATA XENI/15.7,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,
     /20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,
     /25.5,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,110.,120.,130.,140.,150.,160.,180.,200.,250.,
     /300.,350.,400.,450.,500.,600.,700.,800.,900.,1000.,
     /1200.,1400.,1600.,1800.,2000.,2500.,3000.,3500.,4000.,5000.,
     /6000.,8000.,10000.,14000.,20000.,100000./
      DATA YXENI/0.00,.031,.094,.163,.235,.310,.386,.465,.546,.627,
     /.713,.787,.858,.933,.994,1.06,1.12,1.18,1.24,1.30,
     /1.35,1.41,1.60,1.80,1.96,2.11,2.24,2.33,2.39,2.49,
     /2.53,2.60,2.66,2.73,2.77,2.82,2.84,2.85,2.86,2.86,
     /2.85,2.83,2.81,2.76,2.73,2.68,2.62,2.52,2.39,2.17,
     /1.98,1.81,1.68,1.55,1.46,1.30,1.16,1.06,.985,.915,
     /.780,.698,.647,.585,.533,.453,.390,.345,.306,.259,
     /.223,.175,.147,.112,.0838,.0167/
      DATA XIN/11.55,13.0,13.2,13.4,14.0,16.0,20.0,30.0,40.0,50.0,
     /60.0,80.0,100.,150.,200.,300.,500.,700.,1000.,1400.,
     /2000.,4000.,6000.,10000.,20000.,100000./
      DATA YXSIN/0.00,.069,.090,.087,.115,.205,0.22,0.25,0.29,0.34,
     /0.31,.265,0.24,0.18,0.15,.115,.080,.063,.047,.036,
     /.028,.016,.0115,.007,.0036,.00072/
      DATA YXPIN/0.00,0.00,.012,.036,.072,.205,0.42,0.54,0.53,0.50,
     /0.46,0.39,0.34,0.26,0.21,.165,0.11,.083,0.06,.046,
     /.035,.020,.0140,.009,.0042,.0009/
      DATA YXDIN/0.00,0.00,0.00,0.00,0.00,.067,0.15,0.29,0.35,0.39,
     /0.41,0.47,0.47,0.44,0.37,.285,0.19,0.15,0.11,.081,
     /.061,.035,.0245,.016,.008,.0016/
      NAME='Ar (2002 anis.)'
C ----------------------------------------------------------------
C  MULTI-TERM CROSS-SECTION.
C  FOR PURE ARGON:
C  ACCURACY OF DERIVED VELOCITY AND DIFFUSION COEFFICIENTS 0.5% BELOW
C  3000VOLTS . BELOW 20000VOLTS ACCURACY 1.0%. IONISATION COEFFICIENT
C  AND DRIFT VELOCITY ACCURACY BETTER THAN  5% BELOW 1,000,000 VOLTS
C  ANISOTROPIC ELASTIC SCATTERING VERSION
C
C-----------------------------------------------------------------
C
C  PARAMETERS OF PHASE SHIFT ANALYSIS.
C
      APOL=11.08
      LMAX=100
      AA=-1.459
      DD=68.93
      FF=-97.0
      A1=8.69
      API=ACOS(-1.0D0)
C
      NIN=3
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C USE ANISOTROPIC ELASTIC SCATTERING AND COPY (OFFSET) TO IONISATION
      KEL(2)=1
      KEL(3)=1
C
      NEL=44
      NDATA=44
      NIDATA=76
      NXDATA=26
      E(1)=0.0
      E(2)=2.0*EMASS/(39.948*AMU)
      E(3)=15.7
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.0
      IOFF=INT(0.5+E(3)/ESTEP)
      EIN(1)=11.55
      EIN(2)=13.0
      EIN(3)=14.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC (ANIS)  ARGON        '
      SCRPT(3)=' IONISATION    ELOSS= 15.7    '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC S-LEVELS  ELOSS= 11.55   '
      SCRPT(8)=' EXC P-LEVELS  ELOSS= 13.0    '
      SCRPT(9)=' EXC D-LEVELS  ELOSS= 14.0    '
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.GT.1.0) GO TO 100
      IF(EN.EQ.0.0) QELA=7.491D-16
      IF(EN.EQ.0.0) QMOM=7.491D-16
      IF(EN.EQ.0.0) GO TO 200
      AK=SQRT(EN/ARY)
      AK2=AK*AK
      AK3=AK2*AK
      AK4=AK3*AK
      AN0=-AA*AK*(1.0+(4.0*APOL/3.0)*AK2*LOG(AK))-(API*APOL/3.0)*AK2+
     /DD*AK3+FF*AK4
      AN1=(API/15.0)*APOL*AK2-A1*AK3
      AN2=API*APOL*AK2/105.0
      AN0=ATAN(AN0)
      AN1=ATAN(AN1)
      AN2=ATAN(AN2)
      ANHIGH=AN2
      SUM=(SIN(AN0-AN1))**2
      SUM=SUM+2.0*(SIN(AN1-AN2))**2
      SIGEL=(SIN(AN0))**2+3.0*(SIN(AN1))**2
      DO 10 J=2,LMAX-1
      ANLOW=ANHIGH
      SUMI=6.0/((2.0*J+5.0)*(2.0*J+3.0)*(2.0*J+1.0)*(2.0*J-1.0))
      SUM=SUM+(J+1.0)*(SIN(ATAN(API*APOL*AK2*SUMI)))**2
      ANHIGH=ATAN(API*APOL*AK2/((2.0*J+5.0)*(2.0*J+3.0)*(2.0*J+1.0)))
      SIGEL=SIGEL+(2.0*J+1.0)*(SIN(ANLOW))**2
   10 CONTINUE
      QELA=SIGEL*4.0*PIR2/AK2
      QMOM=SUM*4.0*PIR2/AK2
      GO TO 200
  100 CONTINUE
      DO 110 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 120
  110 CONTINUE
      J=NEL
  120 A=(YEL(J)-YEL(J-1))/(XEL(J)-XEL(J-1))
      B=(XEL(J-1)*YEL(J)-XEL(J)*YEL(J-1))/(XEL(J-1)-XEL(J))
      QELA=(A*EN+B)*1.0D-16
      DO 150 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 160
  150 CONTINUE
      J=NDATA
  160 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.0D-16
  200 CONTINUE
      PEQEL(2,I)=0.5+(QELA-QMOM)/QELA
      Q(2,I)=QELA
C
      Q(3,I)=0.0D0
      PEQEL(3,I)=0.5D0
      IF(EN.LE.E(3)) GO TO 230
      DO 210 J=2,NIDATA
      IF(EN.LE.XENI(J)) GO TO 220
  210 CONTINUE
      J=NIDATA
  220 A=(YXENI(J)-YXENI(J-1))/(XENI(J)-XENI(J-1))
      B=(XENI(J-1)*YXENI(J)-XENI(J)*YXENI(J-1))/(XENI(J-1)-XENI(J))
      Q(3,I)=(A*EN+B)*1.0D-16
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 230
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
  230 Q(4,I)=0.0D0
      Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C
      QIN(1,I)=0.0D0
      QIN(2,I)=0.0D0
      QIN(3,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 400
      DO 310 J=2,NXDATA
      IF(EN.LE.XIN(J)) GO TO 320
  310 CONTINUE
      J=NXDATA
  320 A=(YXSIN(J)-YXSIN(J-1))/(XIN(J)-XIN(J-1))
      B=(XIN(J-1)*YXSIN(J)-XIN(J)*YXSIN(J-1))/(XIN(J-1)-XIN(J))
      QIN(1,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.EIN(2)) GO TO 400
      A=(YXPIN(J)-YXPIN(J-1))/(XIN(J)-XIN(J-1))
      B=(XIN(J-1)*YXPIN(J)-XIN(J)*YXPIN(J-1))/(XIN(J-1)-XIN(J))
      QIN(2,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.EIN(3)) GO TO 400
      A=(YXDIN(J)-YXDIN(J-1))/(XIN(J)-XIN(J-1))
      B=(XIN(J-1)*YXDIN(J)-XIN(J)*YXDIN(J-1))/(XIN(J-1)-XIN(J))
      QIN(3,I)=(A*EN+B)*1.0D-16
  400 CONTINUE
      Q(1,I)=Q(2,I)+Q(3,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)
  900 CONTINUE
C SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      END
