CDECK  ID>, GAS46.
      SUBROUTINE GAS46(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
       DOUBLE PRECISION PIR2,ECHARG,EMASS,AMU,BOLTZ,BOLTZJ,
     -      AWB,ALOSCH,ABZERO,ATMOS
       PARAMETER(PIR2=8.79735534D-17)
       PARAMETER(ECHARG=1.602176462D-19)
       PARAMETER(EMASS=9.10938188D-31)
       PARAMETER(AMU=1.66053873D-27)
       PARAMETER(BOLTZ=8.617342D-5)
       PARAMETER(BOLTZJ=1.3806503D-23)
       PARAMETER(AWB=1.758820174D10)
       PARAMETER(ALOSCH=2.6867775D19)
       PARAMETER(ABZERO=273.15D0)
       PARAMETER(ATMOS=760.0D0)
       INTEGER NGAS,NSTEP,IDBG
       DOUBLE PRECISION EFINAL,ESTEP,AKT,ARY,TEMPC,TORR
       PARAMETER(ARY=13.60569172)
       COMMON/INPT/NGAS,NSTEP,EFINAL,ESTEP,AKT,TEMPC,TORR,IDBG
      DIMENSION PEQEL(6,2048),PEQIN(220,2048),KIN(220),KEL(6)
      DIMENSION Q(6,2048),QIN(220,2048),E(6),EIN(220)
      DIMENSION XEN(43),YXSEC(43),XION(68),YION(68),XEL(51),YEL(51)
      DIMENSION X1(48),Y1(48),X2(57),Y2(57),X3(48),Y3(48),X4(49),Y4(49)
      DIMENSION X5(48),Y5(48),X6(45),Y6(45),X7(45),Y7(45),X8(45),Y8(45)
      DIMENSION X9(45),Y9(45)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC MOMENTUM TRANSFER
      DATA XEN/1.00,1.20,1.50,1.80,2.00,2.50,3.00,4.00,5.00,6.00,
     /7.00,8.00,8.71,9.00,10.0,11.0,13.6,15.0,16.5,19.6,
     /20.0,30.0,40.0,50.0,60.0,70.0,77.0,100.,130.,150.,
     /170.,200.,300.,400.,600.,800.,1000.,2000.,4000.,10000.,
     /20000.,40000.,100000./
      DATA YXSEC/1.6178,1.69,1.75,1.79,1.82,1.86,1.91,1.98,2.07,2.14,
     /2.21,2.29,2.35,2.37,2.44,2.51,2.66,2.71,2.76,2.83,
     /2.84,2.84,2.78,2.58,2.30,2.12,2.03,1.53,1.21,1.03,
     /0.90,.756,0.48,0.31,0.17,0.11,.077,.025,.007,.0016,
     /.0005,.00014,.00003/
C ELASTIC TOTAL
      DATA XEL/1.00,1.20,1.50,1.80,2.00,2.50,3.00,4.00,5.00,6.00,
     /8.00,10.0,12.0,14.0,16.0,18.0,20.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,80.0,90.0,100.,125.,150.,200.,250.,
     /300.,350.,400.,500.,600.,700.,800.,900.,1000.,1200.,
     /1500.,2000.,2500.,3000.,4000.,5000.,6000.,10000.,20000.,40000.,
     /100000./
      DATA YEL/1.5667,1.68,1.82,1.94,2.01,2.16,2.30,2.55,2.80,2.98,
     /3.23,3.39,3.54,3.63,3.67,3.68,3.70,3.63,3.54,3.31,
     /3.12,2.93,2.75,2.56,2.42,2.26,1.98,1.76,1.41,1.26,
     /1.10,1.02,.921,.806,.703,.643,.577,.539,.486,.434,
     /.366,.292,.233,.195,.168,.131,.107,.073,.040,.023,
     /.011/
C IONISATION
      DATA XION/21.56,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,
     /27.0,28.0,29.0,30.0,32.0,34.0,36.0,40.0,45.0,50.0,
     /55.0,60.0,65.0,70.0,75.0,80.0,90.0,100.,110.,120.,
     /140.,150.,175.,200.,250.,300.,350.,400.,500.,600.,
     /700.,800.,900.,1000.,1200.,1400.,1600.,1800.,2000.,2500.,
     /3000.,3500.,4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,
     /10000.,12000.,14000.,16000.,18000.,20000.,50000.,100000./
      DATA YION/0.00,.0032,.0076,.0121,.0172,.022,.027,.032,.037,.042,
     /.054,.066,.078,.091,.116,.141,.166,.215,.266,.322,
     /.372,.416,.458,.495,.527,.557,.604,.643,.679,.699,
     /.730,.744,.754,.752,.730,.692,.657,.617,.560,.507,
     /.463,.425,.394,.368,.317,.287,.260,.236,.219,.186,
     /.160,.142,.127,.116,.108,.099,.0929,.0819,.0734,.0672,
     /.0618,.0536,.0471,.0423,.0387,.0355,.0174,.0104/
C EXCITATION
C 1S5
      DATA X1/16.618,16.70,16.80,16.9,17.0,17.1,17.2,17.3,17.4,17.6,
     /17.8,18.0,18.2,18.3,18.4,18.5,18.6,18.7,18.8,19.0,
     /19.5,20.0,21.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /44.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,200.,
     /250.,500.,1000.,2000.,5000.,10000.,20000.,100000./
      DATA Y1/0.0,.0009,.0022,.0042,.0072,.0054,.0046,.0050,.0053,.0060,
     /.0065,.0070,.0074,.0080,.0104,.0130,.0108,.0085,.0082,.0083,
     /.0086,.0087,.0086,.0083,.0073,.0070,.0067,.0062,.0045,.0031,
     /.0024,.0016,.0010,.0006,.0004,.00028,.0002,.00011,.00006,.00002,
     /1.1D-5,1.3D-6,1.5D-7,1.7D-8,9.6D-10,1.1D-10,1.4D-11,1.7D-13/
C 1S4
      DATA X2/16.670,16.70,16.80,16.9,17.0,17.2,
     /17.5,18.0,18.2,18.4,18.5,18.6,18.7,18.8,19.0,
     /19.5,20.0,21.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /44.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,200.,
     /250.,300.,400.,500.,600.,700.,800.,900.,1000.,1200.,
     /1500.,2000.,2400.,3000.,4000.,5000.,6000.,8000.,10000.,20000.,
     /40000.,100000./
      DATA Y2/0.,.00004,.0021,.0030,.0060,.0040,
     /.0053,.0057,.0058,.0070,.0100,.0080,.0060,.0058,.0057,
     /.0057,.0059,.0057,.0062,.0069,.0074,.0076,.0078,.0081,.0084,
     /.0086,.0086,.0083,.0080,.0078,.0075,.0073,.0069,.0062,.0052,
     /.0047,.0041,.0034,.0029,.0026,.0023,.0021,.0019,.0018,.0015,
     /.0012,.0010,.0009,.0007,.00059,.00050,.00043,.00034,.00028,.00016,
     /.000092,.000047/
C 1S3
      DATA X3/16.715,16.80,16.9,17.0,17.1,17.2,17.3,17.4,17.5,17.6,
     /17.8,18.0,18.2,18.3,18.4,18.5,18.6,18.7,18.8,19.0,
     /19.5,20.0,21.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /44.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,200.,
     /250.,500.,1000.,2000.,5000.,10000.,20000.,100000./
      DATA Y3/0.,.0003,.0009,.0016,.0011,.0009,.0010,.0011,.0011,.0011,
     /.0012,.0013,.0014,.0015,.0022,.0029,.0022,.0017,.0015,.0016,
     /.0016,.0017,.0017,.0016,.0015,.0015,.0015,.0014,.0010,.00079,
     /.00065,.0005,.00033,.00023,.00017,.00013,.0001,6.5D-5,4.D-5,2.D-5,
     /1.1D-5,2.0D-6,3.6D-7,6.4D-8,6.7D-9,1.2D-9,2.4D-10,7.0D-12/
C 1S2
      DATA X4/16.847,17.0,17.1,17.5,18.0,18.5,19.0,
     /19.5,20.0,21.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /44.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,200.,
     /250.,300.,400.,500.,600.,700.,800.,900.,1000.,1200.,
     /1500.,2000.,2400.,3000.,4000.,5000.,6000.,8000.,10000.,20000.,
     /40000.,100000./
      DATA Y4/0.,.0090,.0170,.0175,.0182,.0194,.0205,
     /.0215,.0225,.0245,.0266,.0310,.0430,.0580,.0700,.0870,.0960,
     /.1000,.1030,.1040,.1030,.1000,.0973,.0934,.0862,.0770,.0655,
     /.0571,.0509,.0420,.0360,.0316,.0282,.0256,.0235,.0217,.0189,
     /.0159,.0127,.0110,.0092,.0073,.0061,.0053,.0042,.0035,.0020,
     /.0011,.00059/
C SUM OF 2P(10-2)  = 2P10+2P9+2P8+2P7+2P6+2P5+2P4+2P3+2P2
      DATA X5/18.381,18.5,18.6,18.7,18.8,19.0,19.5,20.0,21.0,22.0,
     /24.0,26.0,28.0,30.0,35.0,40.0,44.0,50.0,60.0,70.0,
     /80.0,90.0,100.,120.,150.,200.,250.,300.,400.,500.,
     /600.,700.,800.,900.,1000.,1200.,1500.,2000.,2400.,3000.,
     /4000.,5000.,6000.,8000.,10000.,20000.,40000.,100000./
      DATA Y5/0.,.0005,.0050,.0210,.0110,.0098,.0118,.0140,.0191,.0225,
     /.0256,.0263,.0258,.0249,.0219,.0191,.0172,.0149,.0121,.0101,
     /.0087,.0076,.0067,.0055,.0043,.0031,.0025,.0020,.0015,.0012,
     /.00098,.00084,.00073,.00065,.00058,.00048,.00039,.00029,.00024,
     /.00019,.00014,.00012,.00010,.00007,.00006,.00003,.000016,.000007/
C 2P1
      DATA X6/18.965,19.2,20.0,20.5,21.0,22.0,23.0,24.0,26.0,28.0,
     /30.0,35.0,40.0,44.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,200.,250.,300.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2400.,3000.,4000.,5000.,6000.,
     /8000.,10000.,20000.,40000.,100000./
      DATA Y6/0.,.0014,.0023,.0029,.0035,.0048,.0062,.0075,.0105,.0135,
     /.0158,.0195,.0211,.0213,.0209,.0195,.0179,.0163,.0150,.0138,
     /.0118,.0097,.0074,.0060,.0051,.0038,.0031,.0026,.0022,.0019,
     /.0017,.0015,.0013,.0010,.0008,.00065,.00052,.00039,.00031,.00026,
     /.00020,.00016,.00008,.00004,.00002/
C SUM 2S5 + 2S4 + 2S3 + 2S2
      DATA X7/19.663,20.5,21.0,21.5,22.0,23.0,24.0,25.0,26.0,28.0,
     /30.0,35.0,40.0,44.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,200.,250.,300.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2400.,3000.,4000.,5000.,6000.,
     /8000.,10000.,20000.,40000.,100000./
      DATA Y7/0.,.0021,.0031,.0040,.0047,.0058,.0067,.0074,.0079,.0087,
     /.0093,.0102,.0109,.0112,.0116,.0119,.0120,.0120,.0118,.0117,
     /.0112,.0105,.0094,.0084,.0077,.0065,.0057,.0051,.0046,.0042,
     /.0039,.0036,.0032,.0027,.0022,.0019,.0016,.0013,.0011,.00092,
     /.00073,.00061,.00035,.00020,.000104/
C SUM HIGHER LEVELS 3D + 3S
      DATA X8/20.033,20.5,21.0,21.5,22.0,23.0,24.0,25.0,26.0,28.0,
     /30.0,35.0,40.0,44.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,200.,250.,300.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2400.,3000.,4000.,5000.,6000.,
     /8000.,10000.,20000.,40000.,100000./
      DATA Y8/0.,.0008,.0015,.0022,.0028,.0040,.0051,.0060,.0068,.0081,
     /.0090,.0101,.0104,.0104,.0101,.0095,.0089,.0084,.0079,.0074,
     /.0067,.0058,.0048,.0041,.0035,.0029,.0024,.0021,.0018,.0016,
     /.0015,.0014,.0012,.00096,.00075,.00064,.00053,.0004,.00034,.00029,
     /.00022,.00018,.00010,.000057,.000028/
C SUM 3P (3P1 T0 3P10)
      DATA X9/20.200,20.5,21.0,21.5,22.0,23.0,24.0,25.0,26.0,28.0,
     /30.0,35.0,40.0,44.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,200.,250.,300.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2400.,3000.,4000.,5000.,6000.,
     /8000.,10000.,20000.,40000.,100000./
      DATA Y9/0.,.0004,.0013,.0021,.0028,.0039,.0047,.0054,.0058,.0065,
     /.0068,.0070,.0068,.0066,.0062,.0055,.0050,.0045,.0041,.0037,
     /.0032,.0026,.0020,.0016,.0014,.00103,.00083,.00070,.00060,.00052,
     /.00047,.00042,.00035,.00028,.00021,.00018,.00014,.00011,.000086,
     /.000072,.000054,.000043,.000022,.000012,.0000055/
C ---------------------------------------------------------------------
C
      NAME='Ne (2003 anis.)'
C ---------------------------------------------------------------------
C UPDATE OF 2002 FILE USES MORE DETAILED EXCITATION X-SECTIONS FOR USE
C IN PENNING CALCULATIONS.
C SHAPE 0F EXCITATION FUNCTIONS CLOSE TO THRESHOLD GUIDED BY
C ZEMAN AND BARTSCHAT J.PHYS. B 30(1997)4609
C ALL X-SECTIONS CONSISTENT WITH PUBLISHED ELECTRON SCATTERING DATA UP
C TO 2003
C FIT TO RATE COEFICIENTS OF :
C  TACHIBANA AN PHELPS : PHYS REV.A36(1987)999
C  TACHIBANA AND HARIMA J.PHYS.B 17(1984)879
C GOOD FIT TO DRIFT DIFFUSION DATA OF ROBERTSON AND ALSO DATA OF
C  LUCAS AND SAELEE . CLOSE FIT TO TOWNSEND DATA OF CHANIN AND RORK
C ---------------------------------------------------------------------
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C USE ANISOTROPIC ELASTIC SCATTERING AND COPY (OFFSET) TO IONISATION
      KEL(2)=1
      KEL(3)=1
C
      NEL=51
      NDATA=43
      NION=68
      NEXC1=48
      NEXC2=57
      NEXC3=48
      NEXC4=49
      NEXC5=48
      NEXC6=45
      NEXC7=45
      NEXC8=45
      NEXC9=45
      E(1)=0.0
      E(2)=2.0*EMASS/(20.179*AMU)
      E(3)=21.56
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=24.2
      IOFF=INT(0.5+E(3)/ESTEP)
      EIN(1)=16.618
      EIN(2)=16.670
      EIN(3)=16.715
      EIN(4)=16.857
      EIN(5)=18.381
      EIN(6)=18.965
      EIN(7)=19.663
      EIN(8)=20.033
      EIN(9)=20.200
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ANISOTROPIC  NEON   '
      SCRPT(3)=' IONISATION    ELOSS= 21.56   '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC 1S5       ELOSS= 16.618  '
      SCRPT(8)=' EXC 1S4       ELOSS= 16.670  '
      SCRPT(9)=' EXC 1S3       ELOSS= 16.715  '
      SCRPT(10)=' EXC 1S2       ELOSS= 16.857  '
      SCRPT(11)=' EXCSUM 2P10-2 ELOSS= 18.381  '
      SCRPT(12)=' EXC 2P1     ) ELOSS= 18.965  '
      SCRPT(13)=' EXC SUM 2S    ELOSS= 19.663  '
      SCRPT(14)=' EXC 3D+3S     ELOSS= 20.033  '
      SCRPT(15)=' EXC 3P        ELOSS= 20.200  '
C PARAMETERS OF PHASE SHIFT ANALYSIS
      APOL=2.672
      LMAX=100
      AA=0.2135
      DD=3.86
      FF=-2.656
      A1=1.846
      B1=3.29
      A2=-0.037
      API=ACOS(-1.0D0)
C
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.GT.1.0) GO TO 100
      IF(EN.EQ.0.0) QELA=0.161D-16
      IF(EN.EQ.0.0) QMOM=0.161D-16
      IF(EN.EQ.0.0) GO TO 200
      AK=SQRT(EN/ARY)
      AK2=AK*AK
      AK3=AK2*AK
      AK4=AK3*AK
      AK5=AK4*AK
      AN0=-AA*AK*(1.0+(4.0*APOL/3.0)*AK2*LOG(AK))-(API*APOL/3.0)*AK2+
     /DD*AK3+FF*AK4
      AN1=((API/15.0)*APOL*AK2-A1*AK3)/(1.0+B1*AK2)
      AN2=API*APOL*AK2/105.0-A2*AK5
      ANHIGH=AN2
      SUM=(SIN(AN0-AN1))**2
      SUM=SUM+2.0*(SIN(AN1-AN2))**2
      SIGEL=(SIN(AN0))**2+3.0*(SIN(AN1))**2
      DO 10 J=2,LMAX-1
      ANLOW=ANHIGH
      ANHIGH=API*APOL*AK2/((2.*J+5.0)*(2.*J+3.0)*(2.*J+1.0))
      SUMI=6.0/((2.0*J+5.0)*(2.0*J+3.0)*(2.0*J+1.0)*(2.0*J-1.0))
      SUM=SUM+(J+1.0)*(SIN(API*APOL*AK2*SUMI))**2
      SIGEL=SIGEL+(2.0*J+1.0)*(SIN(ANLOW))**2
   10 CONTINUE
      QELA=SIGEL*4.0*PIR2/AK2
      QMOM=SUM*4.0*PIR2/AK2
      GO TO 200
  100 CONTINUE
      DO 110 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 120
  110 CONTINUE
      J=NEL
  120 A=(YEL(J)-YEL(J-1))/(XEL(J)-XEL(J-1))
      B=(XEL(J-1)*YEL(J)-XEL(J)*YEL(J-1))/(XEL(J-1)-XEL(J))
      QELA=(A*EN+B)*1.0D-16
      DO 150 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 160
  150 CONTINUE
      J=NDATA
  160 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.0D-16
  200 CONTINUE
      PEQEL(2,I)=0.5+(QELA-QMOM)/QELA
      Q(2,I)=QELA
C
      Q(3,I)=0.0D0
      PEQEL(3,I)=0.5D0
      IF(EN.LE.E(3)) GO TO 230
      DO 210 J=2,NION
      IF(EN.LE.XION(J)) GO TO 220
  210 CONTINUE
      J=NION
  220 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.0D-16
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFF SET BY
C THE IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 230
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C
  230 Q(4,I)=0.0D0
      Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C
      QIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 360
      DO 340 J=2,NEXC1
      IF(EN.LE.X1(J)) GO TO 350
  340 CONTINUE
      J=NEXC1
  350 A=(Y1(J)-Y1(J-1))/(X1(J)-X1(J-1))
      B=(X1(J-1)*Y1(J)-X1(J)*Y1(J-1))/(X1(J-1)-X1(J))
      QIN(1,I)=(A*EN+B)*1.0D-16
  360 CONTINUE
C
      QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 430
      DO 410 J=2,NEXC2
      IF(EN.LE.X2(J)) GO TO 420
  410 CONTINUE
      J=NEXC2
  420 A=(Y2(J)-Y2(J-1))/(X2(J)-X2(J-1))
      B=(X2(J-1)*Y2(J)-X2(J)*Y2(J-1))/(X2(J-1)-X2(J))
      QIN(2,I)=(A*EN+B)*1.0D-16
  430 CONTINUE
C
      QIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 460
      DO 440 J=2,NEXC3
      IF(EN.LE.X3(J)) GO TO 450
  440 CONTINUE
      J=NEXC3
  450 A=(Y3(J)-Y3(J-1))/(X3(J)-X3(J-1))
      B=(X3(J-1)*Y3(J)-X3(J)*Y3(J-1))/(X3(J-1)-X3(J))
      QIN(3,I)=(A*EN+B)*1.0D-16
  460 CONTINUE
C
      QIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 530
      DO 510 J=2,NEXC4
      IF(EN.LE.X4(J)) GO TO 520
  510 CONTINUE
      J=NEXC4
  520 A=(Y4(J)-Y4(J-1))/(X4(J)-X4(J-1))
      B=(X4(J-1)*Y4(J)-X4(J)*Y4(J-1))/(X4(J-1)-X4(J))
      QIN(4,I)=(A*EN+B)*1.0D-16
  530 CONTINUE

      QIN(5,I)=0.0D0
      IF(EN.LE.EIN(5)) GO TO 560
      DO 540 J=2,NEXC5
      IF(EN.LE.X5(J)) GO TO 550
  540 CONTINUE
      J=NEXC5
  550 A=(Y5(J)-Y5(J-1))/(X5(J)-X5(J-1))
      B=(X5(J-1)*Y5(J)-X5(J)*Y5(J-1))/(X5(J-1)-X5(J))
      QIN(5,I)=(A*EN+B)*1.0D-16
  560 CONTINUE
C
      QIN(6,I)=0.0D0
      IF(EN.LE.EIN(6)) GO TO 630
      DO 610 J=2,NEXC6
      IF(EN.LE.X6(J)) GO TO 620
  610 CONTINUE
      J=NEXC6
  620 A=(Y6(J)-Y6(J-1))/(X6(J)-X6(J-1))
      B=(X6(J-1)*Y6(J)-X6(J)*Y6(J-1))/(X6(J-1)-X6(J))
      QIN(6,I)=(A*EN+B)*1.0D-16
  630 CONTINUE
C
      QIN(7,I)=0.0D0
      IF(EN.LE.EIN(7)) GO TO 660
      DO 640 J=2,NEXC7
      IF(EN.LE.X7(J)) GO TO 650
  640 CONTINUE
      J=NEXC7
  650 A=(Y7(J)-Y7(J-1))/(X7(J)-X7(J-1))
      B=(X7(J-1)*Y7(J)-X7(J)*Y7(J-1))/(X7(J-1)-X7(J))
      QIN(7,I)=(A*EN+B)*1.0D-16
  660 CONTINUE
C
      QIN(8,I)=0.0D0
      IF(EN.LE.EIN(8)) GO TO 730
      DO 710 J=2,NEXC8
      IF(EN.LE.X8(J)) GO TO 720
  710 CONTINUE
      J=NEXC8
  720 A=(Y8(J)-Y8(J-1))/(X8(J)-X8(J-1))
      B=(X8(J-1)*Y8(J)-X8(J)*Y8(J-1))/(X8(J-1)-X8(J))
      QIN(8,I)=(A*EN+B)*1.0D-16
  730 CONTINUE
C
      QIN(9,I)=0.0D0
      IF(EN.LE.EIN(9)) GO TO 760
      DO 740 J=2,NEXC1
      IF(EN.LE.X9(J)) GO TO 750
  740 CONTINUE
      J=NEXC9
  750 A=(Y9(J)-Y9(J-1))/(X9(J)-X9(J-1))
      B=(X9(J-1)*Y9(J)-X9(J)*Y9(J-1))/(X9(J-1)-X9(J))
      QIN(9,I)=(A*EN+B)*1.0D-16
  760 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+QIN(5,I)+
     /QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
  900 CONTINUE
C  SAVE COMPUTING TIME
      IF(EFINAL.LT.EIN(9)) NIN=8
      IF(EFINAL.LT.EIN(8)) NIN=7
      IF(EFINAL.LT.EIN(7)) NIN=6
      IF(EFINAL.LT.EIN(6)) NIN=5
      IF(EFINAL.LT.EIN(5)) NIN=4
      IF(EFINAL.LT.EIN(4)) NIN=3
      IF(EFINAL.LT.EIN(3)) NIN=2
      IF(EFINAL.LT.EIN(2)) NIN=1
      IF(EFINAL.LT.EIN(1)) NIN=0
      END
